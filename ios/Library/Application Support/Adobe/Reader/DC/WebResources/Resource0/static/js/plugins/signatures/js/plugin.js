/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2013 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by all applicable intellectual property laws,
* including trade secret and or copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2014 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by all applicable intellectual property laws,
* including trade secret and or copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2014 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and may be covered by U.S. and Foreign Patents,
* patents in process, and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2012 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and may be covered by U.S. and Foreign Patents,
* patents in process, and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2015 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by all applicable intellectual property laws,
* including trade secret and or copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2018 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by all applicable intellectual property laws,
* including trade secret and or copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2018 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and may be covered by U.S. and Foreign Patents,
* patents in process, and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2014 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by all applicable intellectual property
* laws, including trade secret and copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
 *
 * ADOBE CONFIDENTIAL
 * ___________________
 *
 *  Copyright 2013 Adobe Systems Incorporated
 *  All Rights Reserved.
 *
 * NOTICE:  All information contained herein is, and remains
 * the property of Adobe Systems Incorporated and its suppliers,
 * if any.  The intellectual and technical concepts contained
 * herein are proprietary to Adobe Systems Incorporated and its
 * suppliers and may be covered by U.S. and Foreign Patents,
 * patents in process, and are protected by trade secret or copyright law.
 * Dissemination of this information or reproduction of this material
 * is strictly forbidden unless prior written permission is obtained
 * from Adobe Systems Incorporated.
 **************************************************************************/

/*************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2013 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and may be covered by U.S. and Foreign Patents,
* patents in process, and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/

/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
* Copyright [2020] Adobe
* All Rights Reserved.
*
* NOTICE: All information contained herein is, and remains
* the property of Adobe and its suppliers, if any. The intellectual
* and technical concepts contained herein are proprietary to Adobe
* and its suppliers and are protected by all applicable intellectual
* property laws, including trade secret and copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe.
**************************************************************************/

/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
* Copyright [2022] Adobe
* All Rights Reserved.
*
* NOTICE: All information contained herein is, and remains
* the property of Adobe and its suppliers, if any. The intellectual
* and technical concepts contained herein are proprietary to Adobe
* and its suppliers and are protected by all applicable intellectual
* property laws, including trade secret and copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe.
**************************************************************************/

define("acplugins/signatures/js/ac-signature",["plugins-common/ac-plugins"],function(e){e.Signatures||(e.Signatures={});var i=e.Signatures.Home;return i||(i=e.Signatures.Home={}),i.PLUGIN_ID||(i.PLUGIN_ID="signatures"),i}),define("pdmplugins/esign/js/ac-esign",["plugins-common/ac-plugins"],function(e){var i=e.EchoSign;return i||(i=e.EchoSign={}),i}),define("pdmplugins/esign/js/models/es-limits-model",["pdmplugins/esign/js/ac-esign","aicx/ac-aicx","aicx/models/aicx-model"],function(e,i){return e.EchoSignLimitsModel=i.AicxModel.extend({url:function(){return i.baseAicUrisModel.get("users")+"users/me/limits/esign"}}),e.EchoSignLimitsModel}),define("pdmplugins/esign/js/models/model-factory",["core/ac-core","pdmplugins/esign/js/ac-esign","core/models/model","pdmplugins/esign/js/models/es-limits-model"],function(e,i){return i.ModelFactory=e.Model.extend({create:function(e,t,s){var n=i[e];return n?new n(t,s):void LOG(0,"AcEchoSign.ModelFactory.create: Unrecognized class: "+e)}}),i.ModelFactory}),define("pdmplugins/esign/js/models/ui/es-auth-ui-model",["core/ac-core","pdmplugins/esign/js/ac-esign","core/models/ui/ui-model"],function(e,i){return i.EchoSignAuthUiModel=e.UiModel.extend({recognized:{access_token:{type:"string",optional:!0},expiration_time:{type:"number",optional:!0},expiration_check_time:{type:"number",optional:!0},auth_status:{type:"string",optional:!0},api_access_point:{type:"string",optional:!0},web_access_point:{type:"string",optional:!0},signin_profile_id:{type:"string",optional:!0},signin_profile_name:{type:"string",optional:!0},loggedin_profile_name:{type:"string",optional:!0}},defaults:{expiration_check_time:12e4,expiration_time:0,auth_status:"",access_token:"",api_access_point:"",web_access_point:"",signin_profile_id:"",signin_profile_name:"",loggedin_profile_name:""},clearLastAuthState:function(){this.set("auth_status","",{silent:!0})},resetToDefaults:function(){this.set(this.defaults,{silent:!0})}}),i.EchoSignAuthUiModel}),define("pdmplugins/esign/js/models/ui/es-doc-upload-progress-ui-model",["core/ac-core","pdmplugins/esign/js/ac-esign","core/models/ui/ui-model"],function(e,i){return i.ESDocUploadProgressUiModel=e.UiModel.extend({recognized:{upload_response:{type:"object",optional:!0},progress_status:{type:"string",optional:!0},progress_obj:{type:"object",optional:!0},bytes_uploaded:{type:"number",optional:!0},bytes_total:{type:"number",optional:!0}},defaults:{upload_response:void 0,progress_status:"",progress_obj:void 0,bytes_uploaded:0,bytes_total:0}}),i.ESDocUploadProgressUiModel}),define("pdmplugins/esign/js/models/ui/es-offline-ui-model",["core/ac-core","pdmplugins/esign/js/ac-esign","core/models/ui/ui-model"],function(e,i){return i.EchoSignOfflineUiModel=e.UiModel.extend({recognized:{is_visible:{type:"boolean",optional:!0},user_action:{type:"string",optional:!0}},defaults:{is_visible:!1,user_action:""},resetToDefaults:function(){this.set(this.defaults,{silent:!0})}}),i.EchoSignOfflineUiModel}),define("pdmplugins/esign/js/models/ui/ui-model-factory",["core/ac-core","pdmplugins/esign/js/ac-esign","core/models/model","pdmplugins/esign/js/models/ui/es-auth-ui-model","pdmplugins/esign/js/models/ui/es-doc-upload-progress-ui-model","pdmplugins/esign/js/models/ui/es-offline-ui-model"],function(e,i){return i.UiModelFactory=e.Model.extend({create:function(e,t,s){var n=i[e];return n?new n(t,s):void LOG(0,"AcEchoSign.UiModelFactory.create: Unrecognized class: "+e)}}),i.UiModelFactory}),define("pdmplugins/esign/js/ops/fetch-existing-es-auth-session-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.FetchExistingESAuthSessionOp=i.Op.extend({run:function(){var e=(this.options,$.Deferred());return this.options.appApi.rnaApi.done(_.bind(function(i){i.esApi.invokeMethod({methodName:"fetchESAuthSession"}).then(function(i){e.resolve(i)},function(){e.reject()})},this)),e}}),e.FetchExistingESAuthSessionOp}),define("pdmplugins/esign/js/ops/creating-new-es-auth-session-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/utils/http-util","core/ops/op"],function(e,i,t){var s="";return s+="{",s+='"ims_client_id":"<%= imsClientId %>",',s+='"ims_access_token":"<%= imsAccessToken %>",',s+='"es_client_id":"<%= esClientId %>",',s+='"es_client_secret":"<%= esClientSecret %>"',s+="}",e.CreatingNewESAuthSessionOp=i.Op.extend({run:function(){var e=this.options,i=$.Deferred();return e.appApi.rnaApi.done(_.bind(function(t){e.appApi.sessionApi.ensureSignedIn().then(_.bind(function(){this.createNewSession(t,i)},this),_.bind(function(e){e&&"NoAccessToPdfServices"===e.errorString?this.createNewSession(t,i):i.reject()},this))},this)),i},createNewSession:function(e,i){var n,o,a,r,l,c,d,p,h,u=this.options;if(o=e.esApi.getEchoSignServiceParams(),a=o.baseURL,r=o.esClientId,l=o.esClientSecret,c=u.appApi.options.sessionUiModel.get("primary_token"),d=o.imsClientId,_.isEmpty(a)||_.isEmpty(r)||_.isEmpty(l)||_.isEmpty(c)||_.isEmpty(d))return void i.reject();var g=t.getClientIdQueryParam(),E=g.lastIndexOf("=");n=a+"/api/rest/v6/baseUris",p=_.template(s,{imsAccessToken:c,imsClientId:d,esClientId:r,esClientSecret:l}),h={Authorization:"Bearer "+c,"x-api-client-id":g.substr(E+1)},$.ajax({url:n,modal:!1,global:!1,headers:h,contentType:"application/json",type:"GET",dataType:"json",success:function(e){i.resolve(e)},error:_.bind(function(e){var t=e.responseJSON||{};"INVALID_IMS_PROFILE"===t.code&&void 0!==t.details&&t.details.signProfile.authenticatingAccount===t.details.loggedInProfile.authenticatingAccount?(u.signProfileID=t.details.signProfile.profileId,u.signProfileName=t.details.signProfile.profileName,u.loggedInProfileName=t.details.loggedInProfile.profileName,u.appApi.rnaApi.done(_.bind(function(e){e.esApi.invokeMethod({methodName:"GetEchoSignAccessTokenFromCluster",methodArgs:[t.details.signProfile.profileId,t.details.signProfile.profileName,t.details.loggedInProfile.profileName]}).then(_.bind(function(e){u.accessToken=e.accessToken;var t=(new Date).getTime()/1e3;u.expiresIn=e.expiryTime/1e3-t,h={Authorization:"Bearer "+e.accessToken,"x-api-client-id":g.substr(E+1)},$.ajax({url:n,modal:!1,global:!1,headers:h,contentType:"application/json",type:"GET",dataType:"json",success:_.bind(function(e){e.sign_profile_id=u.signProfileID,e.sign_profile_name=u.signProfileName,e.loggedin_profile_name=u.loggedInProfileName,e.access_token=u.accessToken,e.expires_in=u.expiresIn,i.resolve(e)},this),error:function(){i.reject()}})},this),function(){i.reject(t)})},this))):i.reject()},this)})}}),e.CreatingNewESAuthSessionOp}),define("pdmplugins/esign/js/ops/storing-es-auth-session-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.StoringESAuthSessionOp=i.Op.extend({run:function(){var e=this.options,i=$.Deferred(),t=e.esAuthUiModel.get("access_token"),s=e.esAuthUiModel.get("expiration_time"),n=e.esAuthUiModel.get("refresh_token"),o=e.esAuthUiModel.get("api_access_point"),a=e.esAuthUiModel.get("web_access_point"),r=e.esAuthUiModel.get("signin_profile_id"),l=e.esAuthUiModel.get("signin_profile_name"),c=e.esAuthUiModel.get("loggedin_profile_name");return this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.setEchoSignApiURL(o),e.esApi.setEchoSignWebURL(a),e.esApi.invokeMethod({methodName:"storeESAuthSession",methodArgs:[n,t,s.toString(),o,a,r,l,c]}).then(function(){i.resolve()},function(){i.reject()})},this)),i}}),e.StoringESAuthSessionOp}),define("pdmplugins/esign/js/ops/upload-document-to-echosign-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.UploadDocumentToEchoSignOp=i.Op.extend({UPLOAD_STATES:{STARTED:0,FINISHED:1,QUEUED:2},run:function(){var e,i=this.options,t=$.Deferred();if(_.isEmpty(i.esAccessToken)||_.isEmpty(i.esUploadEndpoint))return this._getRejectedPromise();var s="false";if("true"==i.UploadFssSign)s=i.UploadFssSign;else if(_.isEmpty(i.docToUpload)||_.isEmpty(i.mimeType))return this._getRejectedPromise();var n="";return i.apiVersion&&(n=i.apiVersion),e={file:i.docToUpload._proxy,accessToken:i.esAccessToken,uploadEndpoint:i.esUploadEndpoint,mimeType:i.mimeType,fssSignUpload:s,ApiVersion:n},this.options.appApi.rnaApi.done(_.bind(function(i){i.esApi.invokeMethod({methodName:"uploadDocument",methodArgs:e}).then(function(e){t.resolve(e)},function(e){t.reject(e)})},this)),t}}),e.UploadDocumentToEchoSignOp}),define("pdmplugins/esign/js/ops/listening-for-es-doc-upload-progress-events-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){var t=e.UploadDocumentToEchoSignOp.prototype.UPLOAD_STATES;return e.ListeningForESDocUploadProgressEventsOp=i.Op.extend({run:function(){var e=this.options,i=e.esDocUploadProgressUiModel,s=i.get("upload_response"),n=i.get("progress_obj");return n?(n._addEventListener("custom:uploadProgress",function(e,n){n.params?(s.status=t.RUNNING,i.set("bytes_uploaded",n.params.bytesWritten),i.set("bytes_total",n.params.bytesTotal),i.set("progress_status","ongoing")):(s.errorSet=!0,s.status=t.FINISHED,i.set("progress_status","finished"))}),n._addEventListener("custom:uploadFinished",function(e,n){n.params?_.isUndefined(n.params.errorCode)||0===n.params.errorCode?(s.respStatusCode=n.params.httpRespCode,_.isEmpty(n.params.respBody)||201!==s.respStatusCode||(s.respBody=JSON.parse(n.params.respBody),void 0!=n.params.clusterTokenFetched&&(s.clusterTokenFetched=JSON.parse(n.params.clusterTokenFetched)))):(s.errorSet=!0,s.errorCode=n.params.errorCode,s.respBody=n.params.respBody,s.respStatusCode=n.params.httpRespCode):s.errorSet=!0,s.status=t.FINISHED,i.set("progress_status","finished")}),this._getResolvedPromise()):(s.errorSet=!0,s.status=t.FINISHED,void i.set("progress_status","finished"))}}),e.ListeningForESDocUploadProgressEventsOp}),define("pdmplugins/esign/js/ops/fetch-es-user-subscription-info-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.FetchESUserSubscriptionInfoOp=i.Op.extend({run:function(){var e=(this.options,$.Deferred());return this.options.appApi.sessionApi.ensureSignedIn().then(_.bind(function(){this.fetchESUserSubscriptionInfo(e)},this),_.bind(function(i){i&&"NoAccessToPdfServices"===i.errorString?this.fetchESUserSubscriptionInfo(e):e.reject(!1)},this)),e},fetchESUserSubscriptionInfo:function(i){var t,s,n,o=this.options,a=e.opFactory,r=o.esLimitsModel,l=["pro","global","enterprise","team"];s=a.create("GettingESLimitsOp",o),s.run().then(function(){n=r.get("esign_access").toLowerCase(),t=$.inArray(n,l)>-1,i.resolve(t)},function(){i.reject()})}}),e.FetchESUserSubscriptionInfoOp}),define("pdmplugins/esign/js/ops/refreshing-es-auth-session-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.RefreshingESAuthSessionOp=i.Op.extend({run:function(){var e=this.options,i=$.Deferred(),t={};return 0!==e.esAuthUiModel.get("signin_profile_id").length&&0!==e.esAuthUiModel.get("signin_profile_name").length&&0!==e.esAuthUiModel.get("loggedin_profile_name").length?(t.access_token=e.esAuthUiModel.get("access_token"),t.expires_in=e.esAuthUiModel.get("expiration_time")/1e3):(t.access_token=e.appApi.options.sessionUiModel.get("primary_token"),t.expires_in=e.appApi.options.sessionUiModel.get("expiration_time")),t.token_type="Bearer",i.resolve(t),i}}),e.RefreshingESAuthSessionOp}),define("pdmplugins/esign/js/ops/getting-es-limits-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.GettingESLimitsOp=i.Op.extend({run:function(){return this.options.esLimitsModel.fetch({modal:!1,global:!1})}}),e.GettingESLimitsOp}),define("pdmplugins/esign/js/api/es-auth-api",["core/ac-core","pdmplugins/esign/js/ac-esign","core/apis/api"],function(e,i){return i.EchoSignAuthApi=e.Api.extend({initialize:function(){e.Api.prototype.initialize.call(this),this._authSessionClients=[],this._initStateMachine(),this._initializeOperationMap()},createAuthSession:function(e){var i=_.extend({},e),t=$.Deferred(),s={promise:t};return this._authSessionClients.push(s),this._fsm.handleEvent("CreateESAuthSession",i),t},clearESAuthSession:function(){this._fsm.handleEvent("ClearESAuthSession",_.extend({},this.options))},evaluateAuthStatus:function(e){var i=_.extend({},e),t=$.Deferred(),s={promise:t};return this._authSessionClients.push(s),this._fsm.handleEvent("CheckESAuthStatus",i),t},isLoggedIn:function(){var e=this.options.esAuthUiModel,i=e.get("access_token"),t=e.get("expiration_time");return this._isESAccessTokenValid(i,t)},handleSessionSignOut:function(){this._fsm.handleEvent("IMSUserLoggedOut",_.extend({},this.options))},handleSessionSignedIn:function(){this._fsm.handleEvent("IMSUserLoggedIn",_.extend({},this.options))},handleNetworkDisconnectedEvent:function(){this._fsm.handleEvent("NetworkDisconnectedEvent",_.extend({},this.options))},_initStateMachine:function(){var e=_.extend({controller:this},this.options);this._fsm=i.fsmFactory.create("EchoSignAuthFSM",e)},_initializeOperationMap:function(){this._opMap=this._opMap||{},this._opMap.FetchESAuthSessionOp=this._fetchESAuthSession,this._opMap.CreateNewESAuthSessionOp=this._createNewESAuthSession,this._opMap.ConvertExpiryTimeToAbsoluteTimeOp=this._convertExpiryTimeToAbsoluteTime,this._opMap.CheckESAuthSessionNeedsRefreshOp=this._checkESAuthSessionNeedsRefresh,this._opMap.RefreshESAuthSessionOp=this._refreshESAuthSession,this._opMap.StoreESAuthSessionOp=this._storeESAuthSession,this._opMap.MarkESAuthSessionInProgressOp=this._markESAuthSessionInProgress,this._opMap.MarkESUserAuthenticatedOp=this._markESUserAuthenticated,this._opMap.MarkESUserNotAuthenticatedOp=this._markESUserNotAuthenticated,this._opMap.NotifyESAuthSuccessToClientsOp=this._notifyESAuthSuccessToClients,this._opMap.NotifyESAuthFailureToClientsOp=this._notifyESAuthFailureToClients,this._opMap.ClearESAuthSessionOp=this._clearESAuthSession},_invokeOperation:function(e){var i=e.opName;if(this._opMap){var t=this._opMap[i];t.call(this,e)}},_fetchESAuthSession:function(e){i.opFactory.create("FetchExistingESAuthSessionOp",this.options).run().then(_.bind(function(i){this.options.appApi.rnaApi.done(_.bind(function(t){this.options.appApi.rnaApi.accessToken=i.accessToken,e.es_access_token=i.accessToken,e.es_refresh_token=i.refreshToken,e.es_token_expiry_time=i.expiryTime,e.es_api_access_point=i.signApiUrl,e.es_web_access_point=i.signWebUrl,e.es_t2e_signIn_profile_id=i.signProfileID,e.es_t2e_signIn_profile_name=i.signProfileName,e.es_t2e_loggedin_profile_name=i.loggedinProfileName,t.esApi.setEchoSignApiURL(i.signApiUrl),t.esApi.setEchoSignWebURL(i.signWebUrl),_.isEmpty(e.es_access_token)||_.isEmpty(e.es_api_access_point)?this._fsm.handleEvent("ESAuthSessionDoesNotExists",e):this._fsm.handleEvent("ESAuthSessionExists",e)},this))},this),_.bind(function(){this._fsm.handleEvent("ESAuthSessionDoesNotExists",e)},this))},_createNewESAuthSession:function(e){i.opFactory.create("CreatingNewESAuthSessionOp",this.options).run().then(_.bind(function(i){"undefined"!=typeof i.sign_profile_id&&0!==i.sign_profile_id.length&&"undefined"!=typeof i.sign_profile_name&&0!==i.sign_profile_name.length&&"undefined"!=typeof i.loggedin_profile_name&&0!==i.loggedin_profile_name.length?(e.es_access_token=i.access_token,e.es_refresh_token="",e.es_token_expiry_time=i.expires_in,e.es_t2e_signIn_profile_id=i.sign_profile_id,e.es_t2e_signIn_profile_name=i.sign_profile_name,e.es_t2e_loggedin_profile_name=i.loggedin_profile_name):(e.es_access_token=e.appApi.options.sessionUiModel.get("primary_token"),e.es_refresh_token="",e.es_token_expiry_time=e.appApi.options.sessionUiModel.get("expiration_time"),e.es_t2e_signIn_profile_id="",e.es_t2e_signIn_profile_name="",e.es_t2e_loggedin_profile_name=""),e.es_token_type="Bearer";var t=i.apiAccessPoint,s=i.webAccessPoint;"/"==t.charAt(t.length-1)&&(t=t.slice(0,-1)),"/"==s.charAt(s.length-1)&&(s=s.slice(0,-1)),e.es_api_access_point=t,e.es_web_access_point=s,this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.setEchoSignApiURL(t),e.esApi.setEchoSignWebURL(s)},this)),e.es_error_code=i.error_code,e.es_error_msg=i.error_msg,this._fsm.handleEvent("ESAuthSessionCreateSuccess",e)},this),_.bind(function(){this._fsm.handleEvent("ESAuthSessionCreateFailure",e)},this))},_convertExpiryTimeToAbsoluteTime:function(e){var i=e.es_token_expiry_time,t=new Date;t.setTime(t.getTime()+1e3*i),e.es_token_expiry_time=t.getTime()},_checkESAuthSessionNeedsRefresh:function(e){var i=e.es_token_expiry_time;this._shouldRefreshESAccessToken(i)?this._fsm.handleEvent("ESAuthSessionNeedsRefresh",e):this._fsm.handleEvent("ESAuthSessionNeedsNoRefresh",e)},_refreshESAuthSession:function(e){var t=_.extend({},this.options,{es_refresh_token:e.es_refresh_token});i.opFactory.create("RefreshingESAuthSessionOp",t).run().then(_.bind(function(i){e.es_access_token=i.access_token,e.es_token_expiry_time=i.expires_in,e.es_token_type=i.token_type,this._fsm.handleEvent("ESAuthSessionRefreshSuccess",e)},this),_.bind(function(){this._fsm.handleEvent("ESAuthSessionRefreshFailure",e)},this))},_storeESAuthSession:function(){i.opFactory.create("StoringESAuthSessionOp",this.options).run()},_markESAuthSessionInProgress:function(){var e=this.options.esAuthUiModel;e.clearLastAuthState(),e.set("auth_status","in_progress")},_markESUserAuthenticated:function(e){var i=this.options.esAuthUiModel;i.clearLastAuthState(),i.set("access_token",e.es_access_token),i.set("expiration_time",e.es_token_expiry_time),i.set("refresh_token",e.es_refresh_token),i.set("signin_profile_id",e.es_t2e_signIn_profile_id),i.set("signin_profile_name",e.es_t2e_signIn_profile_name),i.set("loggedin_profile_name",e.es_t2e_loggedin_profile_name),i.set("api_access_point",e.es_api_access_point),i.set("web_access_point",e.es_web_access_point),i.set("auth_status","success")},_markESUserNotAuthenticated:function(){var e=this.options.esAuthUiModel;e.clearLastAuthState(),e.set("access_token",""),e.set("signin_profile_id",""),e.set("signin_profile_name",""),e.set("loggedin_profile_name",""),e.set("expiration_time",Number.NaN),e.set("auth_status","failure")},_notifyESAuthSuccessToClients:function(){_.each(this._authSessionClients,function(e){e.promise.resolve()})},_notifyESAuthFailureToClients:function(){_.each(this._authSessionClients,function(e){e.promise.reject()})},_clearESAuthSession:function(){this.options.esAuthUiModel.resetToDefaults(),this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.invokeMethod({methodName:"clearESAuthSession"})},this))},_isESAccessTokenValid:function(e,i){return _.isEmpty(e)?!1:this._getTimeDiffInESAccessTokenAndCurrentTime(i)>0},_shouldRefreshESAccessToken:function(e){var i=this._getTimeDiffInESAccessTokenAndCurrentTime(e);if(i>0){var t=this.options.esAuthUiModel,s=t.get("expiration_check_time");i-=s}return 0>=i},_getTimeDiffInESAccessTokenAndCurrentTime:function(e){var i=0,t=new Date;return 0>=e?i:i=e-t.getTime()}}),i.EchoSignAuthApi}),define("pdmplugins/esign/js/api/es-api",["core/ac-core","pdmplugins/esign/js/ac-esign","core/apis/api","pdmplugins/esign/js/api/es-auth-api"],function(e,i){return i.EchoSignApi=e.Api.extend({initialize:function(){var t=this.options;e.Api.prototype.initialize.call(this),this.authApi=new i.EchoSignAuthApi(t)}}),i.EchoSignApi}),define("pdmplugins/esign/js/ops/initializing-op",["pdmplugins/esign/js/ac-esign","core/ac-core","pdmplugins/esign/js/api/es-api","core/ops/op"],function(e,i){return e.InitializingOp=i.Op.extend({run:function(){var i=this.options,t=e.modelFactory,s=e.uiModelFactory;_.extend(i,{esLimitsModel:t.create("EchoSignLimitsModel"),esAuthUiModel:s.create("EchoSignAuthUiModel"),esOfflineUiModel:s.create("EchoSignOfflineUiModel")}),e.esApi=new e.EchoSignApi(i)}}),e.InitializingOp}),define("pdmplugins/esign/js/ops/logout-es-web-session-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.LogOutESWebSessionOp=i.Op.extend({run:function(){var e,i,t,s=$.Deferred();return this.options.appApi.rnaApi.done(_.bind(function(n){return e=n.esApi.getEchoSignServiceParams(),i=e.webURL,console.log(i),_.isEmpty(i)?void s.reject():(t=i+"/public/logout",$("body").append("<div><iframe class='es-logout-frame' src='"+t+"'></iframe></div>"),void $(".es-logout-frame").load(_.bind(function(){n.esApi.invokeMethod({methodName:"unloadESLogoutWebFrame"})},this)))},this)),s}}),e.LogOutESWebSessionOp}),define("pdmplugins/esign/js/ops/cancel-upload-to-echosign-op",["pdmplugins/esign/js/ac-esign","core/ac-core","core/ops/op"],function(e,i){return e.CancelUploadToEchoSignOp=i.Op.extend({run:function(){var e=$.Deferred();return this.options.appApi.rnaApi.done(_.bind(function(i){i.esApi.invokeMethod({methodName:"cancelAllUploadWorkflows"}).then(function(){e.resolve()},function(){e.reject()})},this)),e}}),e.CancelUploadToEchoSignOp}),define("pdmplugins/esign/js/ops/op-factory",["core/ac-core","pdmplugins/esign/js/ac-esign","pdmplugins/esign/js/ops/fetch-existing-es-auth-session-op","pdmplugins/esign/js/ops/creating-new-es-auth-session-op","pdmplugins/esign/js/ops/storing-es-auth-session-op","pdmplugins/esign/js/ops/upload-document-to-echosign-op","pdmplugins/esign/js/ops/listening-for-es-doc-upload-progress-events-op","pdmplugins/esign/js/ops/fetch-es-user-subscription-info-op","pdmplugins/esign/js/ops/refreshing-es-auth-session-op","pdmplugins/esign/js/ops/getting-es-limits-op","pdmplugins/esign/js/ops/initializing-op","pdmplugins/esign/js/ops/logout-es-web-session-op","pdmplugins/esign/js/ops/cancel-upload-to-echosign-op"],function(e,i){return i.OpFactory=e.Op.extend({create:function(e,t){var s=i[e];return s?new s(t):void LOG(0,"AcEchoSign.OpFactory.create: Unrecognized class: "+e)}}),i.OpFactory}),define("pdmplugins/esign/js/fsm/fsm",["core/ac-core"],function(e){return e.FSM=Backbone.View.extend({SPECIAL_FSM_STATE:"*",initialize:function(){Backbone.View.prototype.initialize.call(this),this.cid=_.uniqueId("op"),delete this.options.viewId,delete this.$el,delete this.el,_.bindAll(this),this._stateEventTransitionTable=[],this._supportedStates=[],this._currentState=void 0,this._previousState=void 0,this._initFSM()},handleEvent:function(e,i){var t=this._getCurrentState(),s=!1;if(this._isSupportedState(t)){var n=this._getEventHandlerForState(t,e);return n?(n=_.bind(n,this),s=n(i)):s}},_initFSM:function(){},_getController:function(){return this.options.controller},_getSupportedStates:function(){return this._supportedStates},_setSupportedStates:function(e){this._supportedStates=e},_isSupportedState:function(e){var i=this._getSupportedStates(),t=_.contains(i,e);return t},_setPreviousState:function(e){this._previousState=e},_getPreviousState:function(){return this._previousState},_getCurrentState:function(){return this._currentState},_setCurrentState:function(e){this._isSupportedState(e)&&(this._setPreviousState(this._currentState),this._currentState=e)},_defineTransition:function(e,i,t){var s={state:e,eventName:i,eventHandler:t};this._stateEventTransitionTable.push(s)},_getEventHandlerForState:function(e,i){var t=_.find(this._stateEventTransitionTable,_.bind(function(t){return t.state===e&&t.eventName===i},this));return _.isEmpty(t)&&(t=_.find(this._stateEventTransitionTable,_.bind(function(e){return e.state===this.SPECIAL_FSM_STATE&&e.eventName===i},this))),t?t.eventHandler:void 0},_invokeController:function(e,i){i=i||{};var t=this._getController();if(t){var s=_.extend(i,{opName:e});t._invokeOperation(s)}}}),e.FSM}),define("pdmplugins/esign/js/fsm/es-auth-fsm",["core/ac-core","pdmplugins/esign/js/fsm/fsm","pdmplugins/esign/js/ac-esign"],function(e,i,t){var s={IDLE:0,FETCHING_EXISTING_ES_AUTH_SESSION_STATUS:1,WAITING_FOR_NEW_ES_AUTH_SESSION_TO_CREATE:2,CHECKING_ES_AUTH_SESSION_NEED_TO_REFRESH:3,WAITING_FOR_ES_AUTH_SESSION_TO_REFRESH:4};return t.EchoSignAuthFSM=i.extend({_initFSM:function(){this._setSupportedStates(_.values(s)),this._setCurrentState(s.IDLE),this._defineEventTransitions()},_defineEventTransitions:function(){this._defineTransition(s.IDLE,"CreateESAuthSession",function(e){e.creatingESAuthSession=!0,this._setCurrentState(s.FETCHING_EXISTING_ES_AUTH_SESSION_STATUS),this._invokeController("FetchESAuthSessionOp",e)}),this._defineTransition(s.IDLE,"CheckESAuthStatus",function(e){e.checkingESAuthSession=!0,this._setCurrentState(s.FETCHING_EXISTING_ES_AUTH_SESSION_STATUS),this._invokeController("FetchESAuthSessionOp",e)}),this._defineTransition(s.FETCHING_EXISTING_ES_AUTH_SESSION_STATUS,"ESAuthSessionExists",function(e){this._setCurrentState(s.CHECKING_ES_AUTH_SESSION_NEED_TO_REFRESH),this._invokeController("CheckESAuthSessionNeedsRefreshOp",e)}),this._defineTransition(s.FETCHING_EXISTING_ES_AUTH_SESSION_STATUS,"ESAuthSessionDoesNotExists",function(e){e.creatingESAuthSession?(this._setCurrentState(s.WAITING_FOR_NEW_ES_AUTH_SESSION_TO_CREATE),this._invokeController("MarkESAuthSessionInProgressOp",e),this._invokeController("CreateNewESAuthSessionOp",e)):e.checkingESAuthSession&&(this._setCurrentState(s.IDLE),this._invokeController("MarkESUserNotAuthenticatedOp",e),this._invokeController("NotifyESAuthFailureToClientsOp",e))}),this._defineTransition(s.CHECKING_ES_AUTH_SESSION_NEED_TO_REFRESH,"ESAuthSessionNeedsRefresh",function(e){e.creatingESAuthSession?(this._setCurrentState(s.WAITING_FOR_ES_AUTH_SESSION_TO_REFRESH),this._invokeController("RefreshESAuthSessionOp",e)):e.checkingESAuthSession&&(this._setCurrentState(s.IDLE),this._invokeController("MarkESUserNotAuthenticatedOp",e),this._invokeController("NotifyESAuthFailureToClientsOp",e))}),this._defineTransition(s.CHECKING_ES_AUTH_SESSION_NEED_TO_REFRESH,"ESAuthSessionNeedsNoRefresh",function(e){this._setCurrentState(s.IDLE),this._invokeController("MarkESUserAuthenticatedOp",e),this._invokeController("NotifyESAuthSuccessToClientsOp",e)}),this._defineTransition(s.WAITING_FOR_NEW_ES_AUTH_SESSION_TO_CREATE,"ESAuthSessionCreateSuccess",function(e){this._setCurrentState(s.IDLE),this._invokeController("ConvertExpiryTimeToAbsoluteTimeOp",e),this._invokeController("MarkESUserAuthenticatedOp",e),this._invokeController("StoreESAuthSessionOp",e),this._invokeController("NotifyESAuthSuccessToClientsOp",e)}),this._defineTransition(s.WAITING_FOR_NEW_ES_AUTH_SESSION_TO_CREATE,"ESAuthSessionCreateFailure",function(e){this._setCurrentState(s.IDLE),this._invokeController("MarkESUserNotAuthenticatedOp",e),this._invokeController("NotifyESAuthFailureToClientsOp",e),this._invokeController("ClearESAuthSessionOp",e)}),this._defineTransition(s.WAITING_FOR_ES_AUTH_SESSION_TO_REFRESH,"ESAuthSessionRefreshSuccess",function(e){this._setCurrentState(s.IDLE),this._invokeController("ConvertExpiryTimeToAbsoluteTimeOp",e),this._invokeController("MarkESUserAuthenticatedOp",e),this._invokeController("StoreESAuthSessionOp",e),this._invokeController("NotifyESAuthSuccessToClientsOp",e)}),this._defineTransition(s.WAITING_FOR_ES_AUTH_SESSION_TO_REFRESH,"ESAuthSessionRefreshFailure",function(e){this._setCurrentState(s.IDLE),this._invokeController("MarkESUserNotAuthenticatedOp",e),this._invokeController("NotifyESAuthFailureToClientsOp",e),this._invokeController("ClearESAuthSessionOp",e)}),this._defineTransition(s.IDLE,"ClearESAuthSession",function(e){this._setCurrentState(s.IDLE),this._invokeController("ClearESAuthSessionOp",e)}),this._defineTransition(this.SPECIAL_FSM_STATE,"SessionSignOut",function(){this._setCurrentState(s.IDLE)}),this._defineTransition(this.SPECIAL_FSM_STATE,"NetworkDisconnectedEvent",function(){this._setCurrentState(s.IDLE)})}}),t.EchoSignAuthFSM}),define("pdmplugins/esign/js/fsm/fsm-factory",["core/ac-core","pdmplugins/esign/js/ac-esign","pdmplugins/esign/js/fsm/fsm","pdmplugins/esign/js/fsm/es-auth-fsm"],function(e,i,t){return i.FSMFactory=t.extend({create:function(e,t){var s=i[e];return s?new s(t):void LOG(0,"AcEchoSign.OpFactory.create: Unrecognized class: "+e)}}),i.FSMFactory}),define("pdmplugins/esign/js/ac-esign-init",["pdmplugins/esign/js/ac-esign","pdmplugins/esign/js/models/model-factory","pdmplugins/esign/js/models/ui/ui-model-factory","pdmplugins/esign/js/ops/op-factory","pdmplugins/esign/js/fsm/fsm-factory"],function(e){return _.extend(e,{modelFactory:new e.ModelFactory,uiModelFactory:new e.UiModelFactory,opFactory:new e.OpFactory,fsmFactory:new e.FSMFactory}),e}),define("acplugins/signatures/js/models/ui/collections-ui-model",["core/ac-core","acplugins/signatures/js/ac-signature","core/models/workflow-status-strings","core/models/ui/ui-model"],function(e,i){var t="list",s="thumbnail";return i.CollectionsUiModel=e.UiModel.extend({recognized:{checkbox:{type:"boolean",optional:!1},data_render_delay:{type:"number",optional:!1},scroll_duration:{type:"number",optional:!1},scroll_id_into_view:{type:"string",optional:!0},scroll_render_delay:{type:"number",optional:!1},scroll_listen_delay:{type:"number",optional:!1},view:{type:"string",optional:!1,choices:[t,s]},folders_only:{type:"boolean",optional:!1},filter_by_extension:{type:"array",optional:!1},mode:{type:"string",optional:!1,choices:["desktop","web"]},itemClickAction:{type:"string",optional:!1,choices:["open","select"]},itemDblClickAction:{type:"string",optional:!1,choices:["preview","open"]},show_empty:{type:"boolean",optional:!1},index_last_selected:{type:"number",optional:!1},sort_key:{type:"string",optional:!1},sort_order:{type:"string",optional:!1}},defaults:{checkbox:!0,data_render_delay:10,scroll_duration:250,scroll_render_delay:250,scroll_listen_delay:250,view:t,folders_only:!1,filter_by_extension:[],mode:"web",itemClickAction:"select",itemDblClickAction:"open",show_empty:!1,index_last_selected:-1,sort_key:"",sort_order:""},initializeFromCohorts:function(e){e&&e["ts-a12-ui"]&&this.set({mode:"enabled"===e["ts-a12-ui"]?"desktop":"web"})},isListView:function(){return this.get("view")===t},isThumbnailView:function(){return this.get("view")===s}},{VIEW_LIST:t,VIEW_THUMBNAIL:s}),i.CollectionsUiModel}),define("acplugins/signatures/js/ops/plugin/listening-for-parcel-updates-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op","core/views/view-events"],function(e,i){i.ListeningForParcelUpdatesOp=e.Op.extend({initialize:function(){e.Op.prototype.initialize.call(this)},run:function(){return this.options.appApi.notificationApi.addFolderNotificationCallback(this._getFolder(),_.bind(function(e){e.fetch()},this,this.options.parcelCollection)),this._getResolvedPromise()},_getFolder:function(){return this.options.parcelCollection.folder}})}),define("acplugins/signatures/js/ops/plugin/starting-plugin-op",["core/ac-core","files/ac-files","acplugins/signatures/js/ac-signature","pdmplugins/esign/js/ac-esign","acplugins/signatures/js/models/ui/collections-ui-model","core/collections/parcel-collection","acplugins/signatures/js/ops/plugin/listening-for-parcel-updates-op","core/ops/op"],function(e,i,t){var s;t.StartingPluginOp=e.Op.extend({run:function(){void 0===s&&(s=!0);{var i,n,o,a,r,l=this.options;e.modelFactory,e.uiModelFactory}return i=t.opFactory,this.options.esInitialized||i.create("InitializeEchoSignOp",l).run(),o=i.create("GettingParcelsOp",l),r=i.create("ListeningForParcelUpdatesOp",l),s===!0&&(s=!1,a=t.opFactory.create("ListeningForViewEventsOp",l),$.when(a.run())),n=i.create("ShowingSignInOp",l),n.run().then(function(){return o.run()},function(){})}})}),define("acplugins/signatures/js/views/view-events",["acplugins/signatures/js/ac-signature"],function(e){e.ViewEvents={DELETE:"ts:delete",DOWNLOAD_PARCEL_ASSETS:"ts:download",UNSHARE:"ts:unshare",TRACK:"ts:track",OPENBROWSER:"ts:openbrowser",SHOW_SINGLE_ASSET:"ts:show_single_asset",FORWARD:"ts:forward",SAVEAS_SINGLE_ASSET:"ts:saveas_single_asset",GET_RHP_PREVIEW_METADATA:"ts:get_rhp_preview_metadata"}}),define("acplugins/signatures/js/ops/plugin/listening-for-view-events-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op","acplugins/signatures/js/views/view-events","core/views/view-events"],function(e,i){i.ListeningForViewEventsOp=e.Op.extend({initialize:function(){e.Op.prototype.initialize.call(this),this._initEventMap()},run:function(){return this.options.rootView.on("all",this._onViewEvent),this._deferred=$.Deferred(),this._deferred.promise()
},_onViewEvent:function(e,i){var t,s,n,o;t=this._eventMap[e],t&&(s=t[0].create(t[1],i)),s&&(n=s.options,n&&(o=n.parentDeferred),s.run().then(function(){o&&o.resolve()},function(){o&&o.reject()}))},_mapEvent:function(e,i,t,s,n){e[i]=[t,s,n]},_initEventMap:function(){var t,s,n,o,a,r;t=this._eventMap={},s=this._mapEvent,n=e.opFactory,o=i.opFactory,a=e.ViewEvents,r=i.ViewEvents,s(t,a.SELECT_ITEM,o,"SelectingCollectionItemOp"),s(t,a.CLEAR_SELECTION,n,"ClearingSelectionOp"),s(t,r.DELETE,o,"DeletingParcelIfConfirmedOp"),s(t,r.DOWNLOAD_PARCEL_ASSETS,o,"DownloadingParcelAssetsOp"),s(t,a.DOWNLOAD,n,"DownloadingAssetIfExistsOp"),s(t,r.UNSHARE,o,"UnsharingParcelIfConfirmedOp"),s(t,r.TRACK,o,"ShowingParcelPreviewOp"),s(t,r.OPENBROWSER,o,"DesktopShowInBrowserOp"),s(t,r.SHOW_SINGLE_ASSET,o,"ShowingSingleAssetOp"),s(t,r.FORWARD,o,"ForwardingParcelOp"),s(t,r.SAVEAS_SINGLE_ASSET,o,"SaveAsSingleAssetOp"),s(t,r.GET_RHP_PREVIEW_METADATA,o,"GettingRhpPreviewMetadataOp")}})}),define("acplugins/signatures/js/ops/getting/getting-parcels-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/collections/parcel-collection","core/ops/op"],function(e,i){i.GettingParcelsOp=e.Op.extend({run:function(){var e,i,t=this.options;return e=t.parcelCollection,e&&(i=e.fetch()),i}})}),define("acplugins/signatures/js/ops/getting/getting-rhp-preview-metadata-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i){return i.GettingRhpPreviewMetadataOp=e.Op.extend({run:function(){function i(){var e=c.get("item_model");return e?e.getSingleFileId():void 0}function t(){return o===i()}function s(e){return l.getConnectorsUiHelpers(l.getConnectorName(e))}function n(e){return d.create("GettingFolderPathOp",r).run(e).then(function(e){t()&&(a=e.path,c.set("file_path",a),c.set("connector_info",s(a[0].id)))})}var o,a,r=this.options,l=r.appApi.connectorsApi,c=r.rhpPreviewUiModel,d=e.opFactory;return o=i(),o?d.create("GettingAssetMetadataOp",r).run(o).then(function(e){return t()?(c.set({item_info:e,page_count:e.page_count}),n(e.parent_id)):void 0},function(e){404===e.status&&c.set("item_not_found",!0)}):this._getRejectedPromise()}}),i.GettingRhpPreviewMetadataOp}),define("acplugins/signatures/js/nls/ui-strings",{root:!0,"xx-xx":!0,"de-de":!0,"en-gb":!0,"es-es":!0,"fr-fr":!0,"it-it":!0,"ja-jp":!0,"da-dk":!0,"fi-fi":!0,"nb-no":!0,"nl-nl":!0,"pt-br":!0,"sv-se":!0,"zh-cn":!0,"zh-tw":!0,"ko-kr":!0,"cs-cz":!0,"hu-hu":!0,"pl-pl":!0,"ru-ru":!0,"uk-ua":!0,"tr-tr":!0,"sk-sk":!0,"sl-si":!0,"bg-bg":!0}),define("acplugins/signatures/js/nls/root/ui-strings",{SELECTOR_LABEL:"For Signature",SELECTOR_LABEL_WEB:"Sent",TOOL_LABEL:"Send",SEND_TRACK_LABEL:"Send & Track",SIGN_HEADER:"Shared For Signature",TYPE:"Type",ADDED_DATE:"Added",MODIFIED_DATE:"Modified",PAGES:"Pages",SIZE:"Size",SENDER_NAME:"Sent By",SENT_DATE:"Date Sent",REPORT_ABUSE:"Report Abuse",UNKNOWN:"Unknown",EXTENSION:"(.<%- ext %>)",DOWNLOAD:"Download",DOWNLOAD_ALL:"Download All",REPLY:"Reply",FORWARD:"Forward",NOTIFY_ME_WHEN_VIEWED:"Notify when recipients viewed",UNSHARE:"Unshare",VIEWED_BY:"Viewed By",VIEW_FULL_ACTIVITY:"View Full Activity",EMAIL_REPLY_FORMAT:"Re: <%= emailSubject %>",OPEN:"Open",SAVEAS:"Save As",TRACK:"Track Online",OPEN_LINK:"(Open Link)",MESSAGE_HEADING:"Message",REMOVE:"Remove",FILE_NAME:"NAME",MODIFIED:"SENT / RECEIVED",COMPANY:"COMPANY",PEOPLE:"PEOPLE",PARCEL_PUBLIC_SHARING:"Anonymous",EXPAND:"Expand",COLLAPSE:"Collapse",SELECT_ALL:"Select All",STATUS:"STATUS",NUMBER_OF_VIEWS:"Number of Views",SIGNED:"Signed",GO_TO_ADOBE_SEND_WEBSITE:"Go To Adobe Send Website",GO_TO_ADOBE_S_T_WEBSITE:"Manage Documents Sent for Signature",DATE_VIEWED:"Date Viewed",CONFIRM_UNSHARE_TITLE:"Unshare",CONFIRM_UNSHARE_MSG_ONE_ITEM:"Your files will not longer be viewable to your recipients. Are you sure you want to unshare?",CONFIRM_UNSHARE_MSG_N_ITEMS:"Your files will not longer be viewable to your recipients. Are you sure you want to unshare?",CONFIRM_REMOVE_TITLE:"Remove",CONFIRM_REMOVE_MSG_ONE_ITEM:"Are you sure you want to remove these files from the sent list? By removing the files, they will be unshared and removed from this list, but will not be deleted from your library.",CONFIRM_REMOVE_MSG_N_ITEMS:"Are you sure you want to remove these files from the sent list? By removing the files, they will be unshared and removed from this list, but will not be deleted from your library.",NO_FILES_TITLE:"No Files",NO_FILES_MESSAGE:"There are no files available to download. The files may have been deleted.",SHARE_TITLE:"Send Files",SHARE_WELCOME:"Send and track large files online.",SHARE_WELCOME_DESKTOP:"The fast, easy way to share and monitor files.",SHARE_SELECT_FILES:"Select Files to Send",SHARE_VIEW_SHARED_FILES:"View All Sent Files",READER_FILESELECT_WINDOW_TITLE:"Select Files",READER_FILESELECT_CONTINUE_BUTTON:"Continue",ALL_SUPPORTED_FILES:"All supported files",CHOOSE_FILES:"Choose Files",ALL_SUPPORTED_FILES:"All supported files",FILE:"file",FILES:"files",UPLOADING_TO_SEND:"Uploading to Adobe Document Cloud...",SELECTED_FILES:"Selected Files",ADD_MORE_FILES:"Add Files",SHARE_WITH_HEADING:"Send To",SHARE_ADDRESS_BOOK:"Address Book",SHARE_CHOICE_WORLD:"Create Anonymous Link",SHARE_CHIOCE_WORLD_EXPLAIN:"(with basic usage information)",SHARE_CHOICE_INDIVIDUAL:"Send Personalized Invitations",SHARE_CHOICE_INDIVIDUAL_EXPLAIN:"(with detailed tracking)",SHARE_CHOICE_ALLOW_COMMENTS:"Allow Comments",SHARE_CHOICE_CUSTOMIZE_RECIPIENT_PAGE:"Add Your Logo & Color",SHARE_CHOICE_CUSTOMIZE_RECIPIENT_PAGE_EDIT:"Edit",SHARE_ADDRESS_HEADING:"Recipient Email Addresses",SHARE_ADDRESS_PROMPT:"Enter recipient email addresses",SHARE_SUBJECT_MSG_HEADING:"Subject & Message",SHARE_INITIAL_SUBJECT:"Shared Files",SHARE_AV_ERROR:"Audio/video files are not supported for sending, and have been omitted from your selection.",SHARE_AV_UPGRADE_MESSAGE:" Upgrade to be able to send audio/video files.",SHARE_FORMS_ERROR:"Form files are not currently supported for sending. Go to Fill & Sign to find and download the form.",SHARE_FORMS_ERROR_DESKTOP:"This file type is currently not supported and has been omitted from your selection.",SHARE_AV_FORMS_ERROR:"Audio/video and form files are not supported for sending, and have been omitted from your selection.",SHARE_OVER_LIMIT_APPEND_ERROR:"<br/><br/>Additionally, you selected more than <%- limit %> files. Files beyond that limit have been omitted.",SHARE_OVER_LIMIT_ERROR:"You selected more than <%- limit %> files. Files beyond that limit have been omitted.",SHARE_OVER_LIMIT_TITLE:"Too many files.",SHARE_NON_NATIVE_APPEND_ERROR:"<br/><br/>Additionally, your selection included files stored in one or more unsupported storage locations, and have been omitted.",SHARE_NON_NATIVE_ERROR:"Send & Track is currently not supported for files stored in <%= connectorLabel %>. To send files from <%= connectorLabel %>, save them to your computer first.",SHARE_NON_NATIVE_ERROR_DEFAULT:"Your selection included files stored in one or more unsupported storage locations, and have been omitted.",SHARE_NON_NATIVE_ERROR_HEADING:"Unsupported File Storage",SHARE_MESSAGE_HEADING:"Message",SHARE_MESSAGE_PROMPT:"I have shared some files with you. Please click on the link to view and download them.",SHARE_BUTTON:"Send",SHARE_BUTTON_LINK:"Create Link",SHARE_CANCEL:"Cancel",SHARE_EMAIL_INVALID_PLURAL:"The following email addresses are invalid:",SHARE_EMAIL_INVALID_SINGULAR:"The following email address is invalid:",SHARE_ERROR_SEND_LIMIT_EXCEEDED_TITLE:"Not sent",SHARE_ERROR_SEND_LIMIT_EXCEEDED:"The number of recipients you have selected exceeds your recent limit. Reduce the number of recipients, or wait until later to try again.",SHARE_ERROR_UNSUPPORTED_SHARING_MIME_TYPE:"Audio/video files aren't supported.",SHARE_ERROR_RECIPIENTS_NOT_ALLOWED:"Please upgrade to send to individuals.",SHARE_ERROR_CANNOT_CONVERT_FORM:"Files could not be sent because the form file could not be converted to pdf.",SHARE_ERROR_CANNOT_CONVERT_FORM_RESTRICTION:"Files could not be sent because the form file could not be converted to pdf.",SHARE_ERROR_CANNOT_CONVERT_FORM_TIMEOUT:"Files could not be sent because the form file conversion to PDF timed out.",SHARE_INDIVIDUAL_HELP_WEB:"Note: Personalized links are unique to each recipient, but anyone the recipient shares those links with can access the documents.",SHARE_INDIVIDUAL_HELP:"Note: Personalized invitations are unique to each recipient, but anyone the recipient shares those invitations with can access the documents.",SHARE_UPLOAD_ERROR_TITLE:"Error uploading files",SHARE_UPLOAD_ERROR_MSG:"One or more files could not be uploaded. Please try again.",SHARE_NO_FILES_SELECTED:"There are currently no files selected.",SHARE_CLICK_TO_ADD_FILES:"Click the Add Files button to get started.",SHARE_RECIPIENT_PAGE_HEADLINE:"Recipient Page",SHARE_CHOICE_INCLUDE_MESSAGE:"Include Message Text",SHARE_CHOICE_RESPOND_BACK:"Include Reply-To",SHARE_REMOVE:"Remove",ADD_FILES_REJECTED_TITLE:"Invalid Filename Format",ADD_FILES_REJECTED_MESSAGE:"Files must have a file name extension or be a known file type to be sent. Please ensure that your filename includes a valid file extension.",SHARE_PUBLIC_LINK_HEADING_DESKTOP:"Distribute the anonymous link by:",SHARE_COPY_LINK_BUTTON:"Copy Link",SHARE_SUCCESS_SENT_LINK:"Go to Sent Files",SHARE_SUCCESS_SENT_LINK_FOOTER:"to view all previously sent files",READER_GO_URL:"http://www.adobe.com/go/sendpluginrdr_12_0_0",ACROBAT_GO_URL:"http://www.adobe.com/go/sendpluginacro_12_0_0",SEND_UPSELL_HEADLINE:"Upgrade To",SEND_UPSELL_HEADLINE_OLD:"Upgrade to:",SEND_UPSELL_POINT_1:"• Send large files, including documents and videos",SEND_UPSELL_POINT_2:"• Receive an email when files are viewed",SEND_UPSELL_POINT_3:"• Track downloads using an online dashboard",SEND_UPSELL_LATER:"Later",SEND_UPSELL_NOW:"Upgrade Now",SEND_UPSELL_LEARN_MORE:"Learn More",SEND_UPSELL_UPGRADE_REQUIRED:"Unsupported Files",SHARE_TOO_MANY_DLG_TITLE:"Too many email addresses",SHARE_TOO_MANU_DLG_MESSAGE:"You've entered <%=numRecipients%> email addresses, but you can only send to <%=maxRecipients%> at a time. Delete some addresses and try again.",SHARE_SUCCESS_DLG_TITLE:"Files Shared",SHARE_PUBLIC_LINK_HEADING:"Anonymous Link Generated",SHARE_EMAIL_LINK_BUTTON:"Email Link",SHARE_PUBLIC_LINK_MESSAGE:"Anyone with the link will access the files anonymously.",SHARE_PUBLIC_LINK_NO_COPY_OR_EMAIL_WARNING:"You have not yet copied or emailed the link. Are you sure you want to continue?",SHARE_PUBLIC_LINK_INSTRUCTIONS:"Copy the link below to email or share it with others. Anyone who uses the link will be able to access the files.",SHARE_INVITATIONS_HEADING:"Invitations Sent",SHARE_INVITATIONS_MESSAGE:"Each recipient will receive a link by email, and you will be notified when they follow the link.",SHARE_SUCCESS_CLOSE:"Close",SHARE_SUCCESS_CONTINUE:"Continue",SHARE_FILE_EMAIL_BODY:"I'm using Adobe Send. You can view my file by clicking on the link below:",SHARE_FILES_EMAIL_BODY:"I'm using Adobe Send. You can view my files by clicking on the link below:",S_T_FILE_EMAIL_BODY:"I'm using Adobe Send & Track. You can view my file in Adobe Document Cloud by clicking on the link below:",S_T_FILES_EMAIL_BODY:"I'm using Adobe Send & Track. You can view my files in Adobe Document Cloud by clicking on the link below:",SHARE_CLIPBOARD_MESSAGE:"Tip: Use Ctrl + C to copy",SHARE_CLIPBOARD_MESSAGE_MAC:"Tip: Use Cmd + C to copy",SHARE_CLIPBOARD_COPIED:"link is copied to clipboard",PARCEL_ACTIVITY_DOWNLOADED:"downloaded",PARCEL_ACTIVITY_PREVIEWED:"previewed",PARCEL_ACTIVITY_PUBLIC_VISITOR:"public link visitor",PARCEL_ACTIVITY_ALL_FILES:"All Files",PARCEL_ACTIVITY_ALL_FILES_PREVIEW:"All Files Preview Page",PARCEL_ACTIVITY_HEADING:"Activity for “<%= emailSubject %>”",PARCEL_ACTIVITY_RECIPIENT:"Recipient",PARCEL_ACTIVITY_ACTIVITY:"Activity",PARCEL_ACTIVITY_ITEM:"Item",PARCEL_ACTIVITY_DATE_VIEWED:"Date Viewed",PARCEL_ACTIVITY_CLOSE:"Close",CURRENTLY_SHARED_IN:"Sent To",SHARE_THIS_FILE:"Send this File",SHARE_THIS_FILE_AGAIN:"Send this File Again",SENT_FILES_HEADER_SEARCH_CONTROLS:"Search Controls",SENT_FILES_HEADER_REFRESH:"Refresh",SENT_FILES_NUM_FILES:"<%= numFiles %> files",NO_PARCELS_SIGN_PROMPT:"There aren't any documents here yet.",NO_PARCELS_SIGN_SUBPROMPT:"Documents you've sent or received for signature will appear here.",NO_PARCELS_SIGN_BTN:"Send a document for signature",NO_PARCELS_SEND_SUBPROMPT:"Go to <%= sendBtn %> to deliver files to others",NO_PARCELS_SEND_BTN:"Adobe Send",NO_PARCELS_S_T_BTN:"Send & Track",ON_SIGN_OUT_PROMPT:"Sign in to access shared files.",ON_SIGN_OUT_SUBPROMPT:"See and manage documents you've sent or received for signature.",SIGN_IN_BUTTON:"Sign In",COULD_NOT_SEND:"Could not send",ENTERPRISE_USERS_ACCESS_ERROR:"You do not have access to this service. Please contact your IT Administrator to gain access, or try to sign in with an Adobe ID.",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_NOT_AVAILABLE:"Continue at Adobe Document Cloud",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_USE_WEB_MSG:'Edits to your Color and Logo are currently only available online at the Adobe Send web site. Click "<%= buttonName %>" to go there now.',S_T_CUSTOMIZE_RECIPIENT_PAGE_DIALOG_USE_WEB_MSG:'Edits to your logo and color are currently only available at Adobe Document Cloud. Click "<%= buttonName %>" to go there now.',CUSTOMIZE_RECIPIENT_PAGE_DIALOG_USE_WEB_OK:"Continue",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_TITLE:"Add Your Logo & Color",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_DESCRIPTION:"Add your logo and choose a color to display on emails and recipient page.",CUSTOMIZE_RECIPIENT_PAGE_ADD_LOGO:"Add Logo",CUSTOMIZE_RECIPIENT_PAGE_REMOVE_LOGO:"Remove Logo",CUSTOMIZE_RECIPIENT_PAGE_CHOOSE_COLOR:"Choose Color",CUSTOMIZE_RECIPIENT_PAGE_SAVE:"Save",CUSTOMIZE_RECIPIENT_PAGE_CLOSE:"Cancel",CUSTOMIZE_RECIPIENT_PAGE_FILE_FILTERING_LABEL:"File Type is an image",CUSTOMIZE_RECIPIENT_PAGE_UNSUPPORTED_LOGO_TITLE:"Error",CUSTOMIZE_RECIPIENT_PAGE_UNSUPPORTED_LOGO_FORMAT:"The file you have chosen cannot be used as a logo. Please select another file. ",CUSTOMIZE_RECIPIENT_PAGE_UNSUPPORTED_COLOR_FORMAT:"The color you have entered is invalid. Please enter a hex value like #FFFFFF or #FFF.",SURVEY_TITLE:"We are interested in your Feedback",SURVEY_LINK:"Tell Us What You Think",SURVEY_QUESTION_ONE:"Why are you using Send & Track today?",SURVEY_QUESTION_TWO:"Does it work well for you?",SURVEY_QUESTION_THREE:"Is it missing something you wanted?",SURVEY_SEND:"Send",SURVEY_CLOSE:"No Thanks",SURVEY_TEXTAREA_LIMITATION_LABEL:"characters remaining",INVALID_PARAMETER_SURVEY_MESSAGE:"Answer type not allowed",INVALID_PARAMETER_SURVEY_TITLE:"Invalid Parameter",SEND_RHP_TITLE:"Sent To",GENERIC_ARIA_LABEL_STRING:"<%= prefix %>. <%= suffix %>",ENTERPRISE_RESTRICTIONS_ENFORCED:"Enterprise Sharing Restrictions Enabled",ENTERPRISE_USERS_SHARING_ACCESS:"This feature isn't enabled because your organization has enabled sharing restrictions. ",DRAFTS:"Drafts",TEMPLATES:"Templates",ALL:"All",WAITING_FOR_YOU:"Waiting for you",SIGNED:"Signed",COMPLETED:"Completed",WAITING:"Waiting",CANCELED:"Canceled",EXPIRED:"Expired",APPROVED:"Approved",DELIVERED:"Delivered",ACCEPTED:"Accepted",DELEGATED:"Delegated",FORM_FILLED:"Form Filled",CANCELLED_DECLINED:"Canceled/Declined",IN_PROGRESS:"In progress",DRAFT:"Draft",REQUEST_ESIGN:"Request e-signatures",CREATE_ESIGN_TEMPLATE:"Create e-sign template",EMPTY_STATE_ALL_PROMPT:"No agreements yet",EMPTY_STATE_ALL_SUBPROMPT:"Agreements sent or received by you will appear here.",EMPTY_STATE_COMPLETED_PROMPT:"No completed agreements",EMPTY_STATE_COMPLETED_SUBPROMPT:"Once all recipients sign or approve an agreement, it'll appear here.",EMPTY_STATE_IN_PROGRESS_PROMPT:"No agreements in progress",EMPTY_STATE_IN_PROGRESS_SUBPROMPT:"After sending an agreement for signing, it'll appear here.",EMPTY_STATE_WAITING_FOR_YOU_PROMPT:"No agreements waiting for you",EMPTY_STATE_WAITING_FOR_YOU_SUBPROMPT:"Agreements waiting for your signature or approval will appear here.",EMPTY_STATE_DRAFT_PROMPT:"No draft agreements",EMPTY_STATE_DRAFT_SUBPROMPT:"New agreements that you're still creating will appear here until you send them for signing.",EMPTY_STATE_CANCELED_PROMPT:"No canceled agreements",EMPTY_STATE_CANCELED_SUBPROMPT:"If you cancel an agreement, it'll appear here.",EMPTY_STATE_EXPIRED_PROMPT:"No expired agreements",EMPTY_STATE_EXPIRED_SUBPROMPT:"If an agreement expires, it'll appear here.",EMPTY_STATE_TEMPLATES_PROMPT:"Create reusable templates",EMPTY_STATE_TEMPLATES_SUBPROMPT:"Store frequently used documents as reusable templates. To create a template, start by sending an agreement.",INITIATOR:"INITIATOR",REPLACE:"Replace",SIGNATURES:"Signatures",ANY_TIME:"Any time",ANY_STATUS:"Any status",SIGN:"Sign",APRROVE:"Approve",DELEGATE:"Delegate",ACKNOWLEDGE:"Acknowledge",ACCEPT:"Accept",FILL_FORM:"Fill Form",WAITING_FOR_OTHERS:"Waiting for others",COMPLETE:"Complete",SENDER:"SENDER",PARTIAL_COMPLETE:"<%= done %> of <%= total %> Completed",ASCENDING:"Ascending",DESCENDING:"Descending",AGREEMENT_HEADER:"All agreements",ESIGN_TEMPLATE:"E-sign templates",REDIRECT_TO_WEB_TITLE:"Manage agreements in Acrobat Sign.",REDIRECT_TO_WEB_BODY:"Go to Adobe Acrobat Sign to manage your agreements online.",OPEN_ADOBE_SIGN:"Open Acrobat Sign",GET_SHAREABLE_LINK:"Get a shareable link",SEND_A_COPY:"Send a copy",SAVE_A_LOCAL_COPY:"Save a local copy",LIBRARY_TEMPLATE:"Templates",ACTIVE:"Active"}),define("acplugins/signatures/js/ops/downloading/downloading-parcel-assets-op",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!core/nls/ui-strings","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){return i.DownloadingParcelAssetsOp=e.Op.extend({run:function(){var e,i,o,a,r,l,c,d,p,h=this.options,u=$.Deferred(),g=h.appApi.baseFilesUrisApi.getDownloadUri(),E=h.appApi.dialogApi;return e=h.selectionUiModel,i=e.getSingleSelectedItemModel(),a=e.get("selected_item_ui_models"),i&&(r=i.id,o=a[r],d="GET",l=n.getRequestHeaders(d),o.set("masked",!0),p=i.url()+"/assets",$.ajax(p,{type:d,headers:l,dataType:"JSON"}).then(function(e){var i=e.assets,n=_.pluck(i,"id").join(";");n?h.appApi.downloadApi.getDownloadTicket(n).done(function(e){p=g+"archive/zip/"+n+"?dlticket="+e.download_ticket,c=h.iframe,c?c.attr("src",p):window.open(p,"_self"),o.set("masked",!1)}):E.displayTextAlert(E.SEVERITY_ERROR,s.NO_FILES_TITLE,s.NO_FILES_MESSAGE,t.CLOSE)},function(){o.set("masked",!1)})),u.promise()}}),i.DownloadingParcelAssetsOp}),define("acplugins/signatures/js/ops/downloading/saveas-single-asset-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/models/rna/rna-notification-model","i18n!acplugins/signatures/js/nls/ui-strings","i18n!core/nls/ui-strings","core/ops/op"],function(e,i,t,s,n){var o="binder.zip";i.SaveAsSingleAssetOp=e.Op.extend({run:function(){var i,n,a,r=this.options,l=e.opFactory,c=r.idToSaveAs,d=r.nameToSaveAs,p={notificationHeading:s.SHARED_FILES};return c&&d||(i=r.selectionUiModel,n=i.getSingleSelectedItemModel(),n&&(a=n.get("files"),a&&1===a.length&&(c=a[0].id,d=a[0].name))),p.fileName=o,p.fileExtn=e.Util.getExtension(o),p.showDownloadAll=!1,l.create("GettingAssetMetadataOp",r).run(c).done(_.bind(function(){this.options.appApi.rnaApi.done(_.bind(function(e){e.notificationAPI.createNotification({operationType:t.NOTIFICATION_OPERATIONS.PROCESS,state:t.NOTIFICATION_STATES.IN_PROGRESS,userData:JSON.stringify(p),progress:0,description:"sent"}).done(_.bind(function(i){e.rnaServicesAPI.showServicesProgressWidget(!0,!0,"busy",!0),this._downloadSingleFileAsZip(c,i).then(_.bind(function(e){this._onDownloadCompletion(i,e)},this),_.bind(function(e){this._onDownloadFailed(i,e)},this))},this))},this))},this)),this._getResolvedPromise()},_downloadSingleFileAsZip:function(i,t){var s=this.options,n=e.opFactory;return n.create("DownloadingZipStartOp",_.extend({},s,{id_list:i,numForms:0,fileName:o,notificationObj:t})).run()},_onDownloadCompletion:function(e,i){var s=e.get("userData"),n={};try{n=JSON.parse(s)}catch(o){}i.downloadedFileSys&&(n.downloadedFileSys=i.downloadedFileSys),i.downloadedFilePath&&(n.downloadedFilePath=i.downloadedFilePath),e.invoke("setProperty",{operationType:"",userData:JSON.stringify(n),state:t.NOTIFICATION_STATES.DOWNLOADED})},_onDownloadFailed:function(e,i){if(7!==i){var s={errorTitle:n.NOTIFICATION_DOWNLOAD_ERROR,errorBody:"",downloadError:!0,showRetry:!1};e.invoke("setProperty",{operationType:"",state:t.NOTIFICATION_STATES.FAILED,error:JSON.stringify(s)})}}})}),define("acplugins/signatures/js/ops/manipulation/deleting-parcel-if-confirmed-op",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!core/nls/ui-strings","i18n!acplugins/signatures/js/nls/ui-strings","core/ops/op"],function(e,i,t,s){i.DeletingParcelIfConfirmedOp=e.Op.extend({run:function(){var e,n,o,a,r=this.options,l=r.appApi.dialogApi;e=r.selectionUiModel;var c=r.searchUiModel;return n=e.getNumSelectedItems(),o=1===n?s.CONFIRM_REMOVE_MSG_ONE_ITEM:s.CONFIRM_REMOVE_MSG_N_ITEMS,a=s.CONFIRM_REMOVE_TITLE,l.displayTextAlert(l.SEVERITY_WARNING,a,o,s.REMOVE,t.CANCEL).then(function(){return i.opFactory.create("DeletingParcelOp",r).run().done(function(){e.clearSelection(),c.invalidate()})})}})}),define("acplugins/signatures/js/ops/manipulation/deleting-parcel-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i){i.DeletingParcelOp=e.Op.extend({run:function(){var e,i,t,s=this.options,n=[];return e=s.selectionUiModel,i=e.get("selected_item_models"),t=e.get("selected_item_ui_models"),_.each(i,function(i){var s,o=i.id,a=t[o];a.set("masked",!0),s=i.destroy({wait:!0}).then(function(){e.deselectItem(o,!0)},function(){a.set("masked",!1)}),n.push(s)}),$.when.apply($,n)}})}),define("acplugins/signatures/js/ops/manipulation/forwarding-parcel-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i){i.ForwardingParcelOp=e.Op.extend({run:function(){var i,t,s,n=this.options,o={};return i=n.selectionUiModel,t=i.getSingleSelectedItemModel(),s="/send/parcel/"+t.id,e.Util.isCEF()?this.options.appApi.rnaApi.done(_.bind(function(e){o.selectedParcelId=t.id,o.selectedAssetIds=[],o.selectedModels=[],e.stApi.launchSendTrackApp(o)},this)):(n.appApi.routerApi.navigate(s,{trigger:!0}),i.clearSelection()),this._getResolvedPromise()}})}),define("acplugins/signatures/js/ops/manipulation/setting-delivery-receipts-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/utils/http-util","core/ops/op"],function(e,i,t){i.SettingDeliveryReceiptsOp=e.Op.extend({run:function(){var e,i,s,n,o,a=this.options,r=this.options.parcelModel;return e=r.url(),i=e+"/delivery_receipts",s="PUT",n={value:a.deliveryReceipts},o=t.getRequestHeaders(s),o["Content-Type"]="application/json",$.ajax(i,{type:s,headers:o,data:JSON.stringify(n),dataType:"json"}).then(function(){a.parcelModel.set({delivery_receipts:a.deliveryReceipts})})}})}),define("acplugins/signatures/js/ops/manipulation/unsharing-parcel-if-confirmed-op",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!acplugins/signatures/js/nls/ui-strings","i18n!core/nls/ui-strings","core/ops/op"],function(e,i,t,s){i.UnsharingParcelIfConfirmedOp=e.Op.extend({run:function(){var e,n,o,a,r=this.options,l=r.appApi.dialogApi;return e=r.selectionUiModel,n=e.getNumSelectedItems(),o=1===n?t.CONFIRM_UNSHARE_MSG_ONE_ITEM:_.template(t.CONFIRM_UNSHARE_MSG_N_ITEMS,{numItems:n}),a=t.CONFIRM_UNSHARE_TITLE,l.displayTextAlert(l.SEVERITY_WARNING,a,o,t.UNSHARE,s.CANCEL).then(function(){return i.opFactory.create("UnsharingParcelOp",r).run().done(function(){e.clearSelection()})})}})}),define("acplugins/signatures/js/ops/manipulation/unshare-one-parcel-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/utils/http-util","core/ops/op"],function(e,i,t){return i.UnshareOneParcelOp=e.Op.extend({run:function(){var e,i,s,n,o,a=this.options,r="PUT";return e=a.itemModel,i=e.url()+"/is_active",s=JSON.stringify({value:!1}),n=t.getRequestHeaders(r),n["Content-Type"]="application/json",o=$.ajax(i,{type:r,headers:n,data:s,dataType:"json"}).then(function(){e.set({is_active:!1})})}}),i.UnshareParcelOp}),define("acplugins/signatures/js/ops/manipulation/unsharing-parcel-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op","acplugins/signatures/js/ops/manipulation/unshare-one-parcel-op"],function(e,i){i.UnsharingParcelOp=e.Op.extend({run:function(){var e,t,s,n=this.options,o=[];return e=n.selectionUiModel,t=e.get("selected_item_models"),s=e.get("selected_item_ui_models"),_.each(t,function(t){var n,a,r=t.id,l=s[r];l.set("masked",!0),a=new i.UnshareOneParcelOp({itemModel:t}),n=a.run().then(function(){e.clearSelection(),t.set({is_active:!1}),l.set("masked",!1)},function(){l.set("masked",!1)}),o.push(n)}),$.when.apply($,o)}})}),define("acplugins/signatures/js/constants/sign-constants",{API_SUBPATH_V6:"/api/rest/v6",API_VERSION_V6:"v6",API_SUBPATH_GATEWAY:"/api/gateway"}),define("acplugins/signatures/js/ops/manipulation/remind-participant-sendAPI-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){return i.PostReminderAndGetResponseOp=e.Op.extend({run:function(e){var i=this.options,o=i.esApi.authApi.createAuthSession(i),a=$.Deferred();return o.then(_.bind(function(){var o=i.esAuthUiModel.get("access_token"),r=i.appApi.rnaApiObj.esApi.getEchoSignApiURL();i.esAuthSessionExists=!0;var l=r+t.API_SUBPATH_V6+"/agreements/"+e.agreementID,c=_.extend({Accept:"application/json",Authorization:"Bearer "+o},n.getSignRequestHeaders()),d=[];d.reminderfrequency="",d.remindernote=e.reminderNote;var p={};p.status="ACTIVE",p.note=e.reminderNote,this.options.appApi.rnaApi.done(_.bind(function(i){i.rnaSignWorkflowServicesAPI.isSignV10Enabled()?p.recipientParticipantIds=e.participantIDs:(p.frequency="",l+="/participantSets/"+e.participantID),l+="/reminders",$.ajax({url:l,data:JSON.stringify(p),type:"POST",headers:c,modal:!1,contentType:"application/json",dataType:"json",success:_.bind(function(e){a.resolve(e)},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),a.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this))},this)),a}}),i.PostReminderAndGetResponseOp}),define("acplugins/signatures/js/ops/manipulation/cancel-agreement-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){return i.CancelAgreementOp=e.Op.extend({run:function(e){var i=this.options,o=i.esApi.authApi.createAuthSession(i),a=$.Deferred();return o.then(_.bind(function(){var o=i.esAuthUiModel.get("access_token"),r=i.appApi.rnaApiObj.esApi.getEchoSignApiURL(),l=r+t.API_SUBPATH_V6+"/agreements/"+e.agreementID,c=_.extend({Accept:"application/json",Authorization:"Bearer "+o,"If-Match":e.eTag},n.getSignRequestHeaders()),d={};i.appApi.rnaApi.done(_.bind(function(i){i.rnaSignWorkflowServicesAPI.isSignV10Enabled()?(l+="/state",d.state="CANCELLED",d.agreementCancellationInfo={},d.agreementCancellationInfo.comment=JSON.stringify(e.notifyText),d.agreementCancellationInfo.notifyOthers=e.shouldNotifySigners):(l+="/status",d.status="CANCELLED",d.comment=JSON.stringify(e.notifyText),d.notifySigner=e.shouldNotifySigners),$.ajax({url:l,type:"PUT",headers:c,data:JSON.stringify(d),contentType:"application/json",dataType:"json",modal:!1,success:_.bind(function(e){a.resolve(e)},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),a.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this))},this)),a}}),i.CancelAgreementOp}),define("acplugins/signatures/js/ops/selection/selecting-collection-item-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i){return i.SelectingCollectionItemOp=e.Op.extend({run:function(){var i,t=this.options,s=t.itemView,n=this._multipleSelection();switch(this.options.selectType){case e.SelectionUiModel.SELECT_ALL:i=this._selectAll(!0);break;case e.SelectionUiModel.SELECT_NONE:i=this._selectAll(!1);break;case e.SelectionUiModel.SELECT_DESELECT:i=this._selectItem(s,!1);break;case e.SelectionUiModel.SELECT_EXTEND:i=this._extendSelectItem(s);break;case e.SelectionUiModel.SELECT_SELECT:i=this._selectItem(s);break;case e.SelectionUiModel.SELECT_TOGGLE:i=this._toggleSelectItem(s);break;case e.SelectionUiModel.SELECT_NEXT:i=this._selectNext();break;case e.SelectionUiModel.SELECT_PREVIOUS:i=this._selectPrevious();break;case e.SelectionUiModel.EXTEND_SELECT_NEXT:i=this._selectNext(n);break;case e.SelectionUiModel.EXTEND_SELECT_PREVIOUS:i=this._selectPrevious(n)}return i&&t.selectionUiModel.triggerSelectionChange(),this._getResolvedPromise()},_selectItemView:function(e,i){var t,s=this.options,n=e.model;return t=s.noFolderSelection&&n.isFolder(),s.selectionUiModel.selectItem(n,e.options.itemUiModel,t?!1:i)},_selectAll:function(i){var t,s=this.options.collectionItemsView.getChildViews();if(!(i&&s.length>1)||this._multipleSelection())return i?(_.each(s,_.bind(function(e){this._selectItemView(e,i)&&(t=!0)},this)),t):(e.opFactory.create("ClearingSelectionOp",this.options).run(),t=!0)},_deselectAll:function(){return this.options.selectionUiModel.getNumSelectedItems()>0?(this._selectAll(!1),!0):!1},_selectNext:function(e){var i=this._getSelectionEnd(),t=this._getNextSelectable(i,!1);if(e||this._deselectAll())return t>=0&&(i=t),this._selectChildAt(i)},_selectPrevious:function(e){var i=this._getSelectionStart(),t=this._getNextSelectable(i,!0);if(e||this._deselectAll())return t>=0&&(i=t),this._selectChildAt(i)},_extendSelectItem:function(e){var i,t,s,n;return this._multipleSelection()||this._selectAll(!1)&&(n=!0),this._selectItemView(e,!0)&&(n=!0),i=this._getTargetIndex(),t=this._getClosestSelectedIndex(i,!1),t>0?(this._selectRange(!0,i,t)&&(n=!0),this._selectRange(!1,0,i-1)&&(n=!0)):(s=this._getClosestSelectedIndex(i,!0),s>=0?this._selectRange(!0,s,i)&&(n=!0):this._selectItem(e)&&(n=!0)),n},_selectItem:function(e){var i;return this._selectAll(!1)&&(i=!0),this._selectItemView(e,!0)&&(i=!0),i},_toggleSelectItem:function(e){var i,t=e.options.itemUiModel.get("selected");return this._multipleSelection()||this._selectAll(!1)&&(i=!0),this._selectItemView(e,!t)&&(i=!0),i},_multipleSelection:function(){return this.options.selectionUiModel.get("multiple_selection")},_getSelectionIndex:function(e){function i(e){return s=t.eq(e),l.isItemSelected(s.data("id"))}var t,s,n,o,a,r=this.options,l=r.selectionUiModel;if(t=this._getChildren(),n=t.length,a=-1,e){for(o=0;n>o;o+=1)if(i(o)){a=o;break}}else for(o=n-1;o>=0;o-=1)if(i(o)){a=o;break}return a},_getSelectionStart:function(){return this._getSelectionIndex(!0)},_getSelectionEnd:function(){return this._getSelectionIndex(!1)},_getTargetId:function(){var e,i,t=this.options.itemView;return t&&(e=t.model,e&&(i=e.id)),i},_getTargetIndex:function(){var e,i,t;return i=this._getTargetId(),t=this.options.collectionItemsView.$el.children(),t.each(function(t,s){return $(s).data("id")===i?(e=t,!1):void 0}),e},_getClosestSelectedIndex:function(e,i){var t,s,n,o,a,r;if(t=this.options.collectionItemsView,s=t.$el.children(),n=s.length,o=-1,r=_.bind(function(e){var i=this._getItemUiModelAt(t,s,e);return i.get("selected")},this),i){for(a=e-1;a>=0;a-=1)if(r(a)){o=a;break}}else for(a=e+1;n>a;a+=1)if(r(a)){o=a;break}return o},_selectRange:function(e,i,t){var s,n,o,a,r;for(s=this.options.collectionItemsView,o=s.$el.children(),a=i;t>=a;a+=1)n=this._getItemViewAt(s,o,a),this._selectItemView(n,e)&&(r=!0);return r},_isChildAtSelectable:function(e){return this._isChildSelectable(this._getChildAt(e))},_isChildSelectable:function(e){var i=e.data("model");return!this.options.noFolderSelection||!i.isFolder()},_selectChild:function(e,i,t){var s,n,o,a=this.options,r=!1;
if(e)return e=$(e),o=this.options.collectionItemsView.getChildViewById(e.data("id")),s=o.model,n=o.options.itemUiModel,t&&(r=t.scrollIntoView),r&&this._scrollItemIntoView(e),a.selectionUiModel.selectItem(s,n,this._isChildSelectable(e)?i:!1,!0)},_selectChildAndScroll:function(e,i){return this._selectChild(e,i,{scrollIntoView:!0})},_selectChildAt:function(e,i,t){return _.isUndefined(i)&&(i=!0),this._selectChildAndScroll(this._getChildAt(e),i,t)},_getItemViewAt:function(e,i,t){var s=i.eq(t),n=$(s).data("id");return e.getChildViewById(n)},_getChildren:function(){return this.options.collectionItemsView.$el.children()},_getChildCount:function(){return this._getChildren().length},_getChildAt:function(e){var i=this._getChildren();return 0>e||e>=i.length?void 0:i.eq(e)},_getNextSelectable:function(e,i){return i?Math.max(e-1,0):Math.min(this._getChildCount()-1,e+1)},_scrollItemIntoView:function(e){var i=e.position().top,t=e.height(),s=$(this.options.collectionItemsView.el).height();if(0>i||i+t>s){var n=$(this.options.collectionItemsView.el).scrollTop(),o=i-(s-t)/2;$(this.options.collectionItemsView.el).scrollTop(Math.max(n+o,0))}},_getItemUiModelAt:function(e,i,t){var s=this._getItemViewAt(e,i,t);return s.options.itemUiModel}}),i.SelectingCollectionItemOp}),define("acplugins/signatures/js/ops/showing/showing-parcel-preview-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i){i.ShowingParcelPreviewOp=e.Op.extend({run:function(){var e,i,t,s,n=this.options;return e=n.appApi,t=n.parcelModel,t||(i=n.selectionUiModel,t=i.getSingleSelectedItemModel()),t&&(s=t.id),s&&e.routerApi.navigate("/sentfiles/"+s,{trigger:!0}),this._getResolvedPromise()}})}),define("acplugins/signatures/js/ops/showing/showing-sign-in-op",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!acplugins/signatures/js/nls/ui-strings","i18n!core/nls/ui-strings","core/ops/op"],function(e,i){i.ShowingSignInOp=e.Op.extend({run:function(){return this._getResolvedPromise()}})}),define("acplugins/signatures/js/ops/showing/showing-single-asset-op",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!acplugins/signatures/js/nls/ui-strings","i18n!core/nls/ui-strings","core/ops/op"],function(e,i){i.ShowingSingleAssetOp=e.Op.extend({run:function(){var i,t,s,n=this.options,o=n.idToShow,a=[];return o||(i=n.selectionUiModel,t=i.getSingleSelectedItemModel(),t&&(s=t.get("files"),s&&1===s.length&&(o=s[0].id))),e.Util.isCEF()?e.opFactory.create("GettingAssetMetadataOp",n).run(o).done(_.bind(function(e){this.options.appApi.rnaApi.done(function(i){a.push(e.parent_id),i.assetApi({methodName:"openFile",methodArgs:[o,a]})})},this)):o&&n.appApi.routerApi.navigate("/file/"+o,{trigger:!0}),this._getResolvedPromise()}})}),define("acplugins/signatures/js/ops/showing/desktop-show-in-browser-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i){i.DesktopShowInBrowserOp=e.Op.extend({run:function(){var t=i.opFactory;if("trackObject"===this.options.eventName)var s=e.getBaseCloudUrl(),n="sentfiles/",o=this.options.selectionUiModel.getSingleSelectedItemModel().id,a=s+n+o;else if("adobeSendWebsite"===this.options.eventName)var a="/send";var r={url:a},l=t.create("JumpToBrowserApiCallOp",this.options),c=l.run(r).done(_.bind(function(){this.options.appApi.rnaApi.done(_.bind(function(e){e.ipmApi({methodName:"executeURI",methodArgs:JSON.parse(c.responseText).uri})},this))},this));return c.promise()}})}),define("acplugins/signatures/js/ops/showing/jump-to-browser-api-call-op",["core/ac-core","core/utils/http-util","acplugins/signatures/js/ac-signature","core/ops/op"],function(e,i,t){var s="reader/jump_to_browser_url";t.JumpToBrowserApiCallOp=e.Op.extend({run:function(e){var t,n,o=this.options,a=Ac.baseFilesUrisModel.getSendApiUri();return _.isEmpty(a)?this._getRejectedPromise():(t="POST",n=_.extend({},i.getRequestHeaders(t,o,!1),{"Content-Type":"application/json"}),a+=s,o.appApi.networkApi.throttledAjax(a,{type:t,headers:n,data:JSON.stringify(e),dataType:"json",global:!1}))}})}),define("acplugins/signatures/js/ops/getting/get-sign-files-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","core/ops/op","pdmplugins/esign/js/ac-esign"],function(e,i,t){var s=["WAITING_FOR_MY_SIGNATURE","WAITING_FOR_MY_APPROVAL","WAITING_FOR_MY_DELEGATION","WAITING_FOR_MY_ACKNOWLEDGEMENT","WAITING_FOR_MY_ACCEPTANCE","WAITING_FOR_MY_FORM_FILLING","OUT_FOR_SIGNATURE","OUT_FOR_APPROVAL","OUT_FOR_DELIVERY","OUT_FOR_ACCEPTANCE","OUT_FOR_FORM_FILLING","SIGNED","APPROVED","DELIVERED","ACCEPTED","FORM_FILLED","EXPIRED","CANCELLED","ARCHIVED","LIBRARY_TEMPLATE"];i.GetSignaturesFilesListOp=e.Op.extend({run:function(e){var i=this.options,t=i.esApi.authApi.createAuthSession(i);t.then(_.bind(function(){this._getFileListInternal(e)},this))},_getFileListInternal:function(i){var t=this.options,n=t.esAuthUiModel.get("access_token"),o=t.appApi.rnaApiObj.esApi.getEchoSignApiURL();t.esAuthSessionExists=!0,this._getAgreementsAPICall(o,n).then(_.bind(function(n){this.promises=[],this.finalResponse={},this.finalResponse.response=n.data,this.finalResponse.request=i,this.finalResponsePromise=$.Deferred(),void 0!==this.finalResponse.response.userAgreementList?(this.finalResponse.response.agreementSpecificDetails={},this.finalResponse.response.userAgreementList.slice().reverse().forEach(_.bind(function(e,i,t){s.includes(e.status)||this.finalResponse.response.userAgreementList.splice(t.length-1-i,1)},this)),this.finalResponse.response.userAgreementList.forEach(_.bind(function(e){var i=this.options,t=i.esAuthUiModel.get("access_token"),s=i.appApi.rnaApiObj.esApi.getEchoSignApiURL();e.displayDate=this._formatDate(new Date(Date.parse(e.displayDate))),this.promises.push(this._getAgreementDetailsAPICall(e.id,s,t)),this.promises.push(this._getAgreementParticipantDetailsAPICall(e.id,s,t))},this)),Promise.all(this.promises).then(_.bind(function(e){for(var i=this.finalResponse.response.agreementSpecificDetails,t=0;t<e.length;t+=2){var s=Object.assign({},e[t].data,e[t+1].data);void 0!==s.createdDate&&(s.createdDate=this._formatDate(new Date(Date.parse(s.createdDate)))),void 0!==s.expirationTime&&(s.expirationTime=this._formatDate(new Date(Date.parse(s.expirationTime)))),s.eTag=e[t].xhr.getResponseHeader("ETag");var n=s.id;void 0===n&&(n=this.finalResponse.response.userAgreementList[parseInt(t/2)].id),i[n]=s}this.finalResponsePromise.resolve()},this))):this.finalResponsePromise.resolve(),this.finalResponsePromise.done(_.bind(function(){t.appApi.rnaApi.done(_.bind(function(){var i=e.opFactory.create("SendChunkDataToNative",t);i.run(JSON.stringify(finalResponse),"SignAgreementListing")},this))},this))},this))},_getAgreementsAPICall:function(e,i){var s=e+t.API_SUBPATH_V6+"/agreements",n=$.Deferred(),o={Accept:"application/json",Authorization:"Bearer "+i};return $.ajax({url:s,headers:o,type:"GET",dataType:"json",global:!1,success:_.bind(function(e,i,t){n.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){n.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),n},_getAgreementDetailsAPICall:function(e,i,s){var n=i+t.API_SUBPATH_V6+"/agreements/"+e,o=$.Deferred(),a={Accept:"application/json",Authorization:"Bearer "+s};return $.ajax({url:n,headers:a,type:"GET",dataType:"json",global:!1,success:_.bind(function(e,i,t){o.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){o.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),o},_getAgreementParticipantDetailsAPICall:function(e,i,s){var n=i+t.API_SUBPATH_V6+"/agreements/"+e+"/participantSets",o=$.Deferred(),a={Accept:"application/json",Authorization:"Bearer "+s};return $.ajax({url:n,headers:a,type:"GET",dataType:"json",global:!1,success:_.bind(function(e,i,t){o.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){o.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),o},_pad:function(e,i,t){return t=t||"0",e+="",e.length>=i?e:new Array(i-e.length+1).join(t)+e},_formatDate:function(e){return e instanceof Date?""+e.getUTCFullYear()+this._pad(e.getUTCMonth()+1,2)+this._pad(e.getUTCDate(),2)+this._pad(e.getUTCHours(),2)+this._pad(e.getUTCMinutes(),2)+this._pad(e.getUTCSeconds(),2)+"Z":""}})}),define("acplugins/signatures/js/ops/getting/get-sign-audit-trail-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op","pdmplugins/esign/js/ac-esign"],function(e,i){return i.GetSignaturesAuditTrailOp=e.Op.extend({run:function(e){var i,t,s,n,o=this.options,a=o.appApi,r=o.esApi.authApi.createAuthSession(o),l={};r.then(_.bind(function(){o.esAuthSessionExists=!0,n=a.rnaApiObj.esApi.getEchoSignApiURL(),i=o.esAuthUiModel.get("access_token"),s=e.get("id"),t=n+"/api/rest/v6/agreements/"+s+"/auditTrail",a.rnaApi.done(function(e){l.auditUrl=t,l.accessToken=i,l.agreementID=s,e.rnaSignWorkflowServicesAPI.getAuditTrail(l)})},this))}}),i.GetSignaturesAuditTrailOp}),define("acplugins/signatures/js/ops/getting/get-sign-activity-op",["core/ac-core","acplugins/signatures/js/ac-signature","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s){return i.GetSignaturesActivityListOp=e.Op.extend({run:function(e){var i=this.options,n=i.esApi.authApi.createAuthSession(i),o=$.Deferred();return n.then(_.bind(function(){var n,a,r,l,c=i.esAuthUiModel.get("access_token"),d=i.appApi.rnaApiObj.esApi.getEchoSignApiURL(),p={},h=[];i.esAuthSessionExists=!0;var u=_.extend({Authorization:"Bearer "+c},s.getSignRequestHeaders());n=d+"/api/rest/v6/agreements/"+e.agreementID+"/events",$.ajax({url:n,data:p,type:"GET",modal:!1,headers:u,contentType:"application/json",dataType:"json",success:_.bind(function(e){a=e.events,a.forEach(function(e){r=e.description+" <br>",l=new Date(Date.parse(e.date)),l=moment(l).format("MMM DD, hh:mm A"),r+=l,h.unshift(r)}),o.resolve(h)},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&t.esApi.authApi.clearESAuthSession(),o.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this)),o}}),i.GetSignaturesActivityListOp}),define("acplugins/signatures/js/ops/downloading/open-sign-agreement-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/utils/sc-analytics","pdmplugins/esign/js/ac-esign","core/ops/op"],function(e,i,t){return i.OpenSignAgreementOp=e.Op.extend({run:function(e){var i=this.options,s=i.appApi,n=i.esApi.authApi.createAuthSession(i),o=$.Deferred();if("DRAFT"==e.model.attributes.signature_info.state){const a=[e.model.attributes.signature_info.state,e.model.attributes.signature_info.wf_rsdraft_filesys,e.model.attributes.signature_info.wf_rsdraft_filepath];this.options.appApi.rnaApi.then(_.bind(function(i){var t=e.model;i.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"openSignDraftFile",methodArgs:a}).then(_.bind(function(e){if(e&&e.delete&&1==e.delete){var i="fullItem-"+t.id,s="#"+i;$(s).hide()}}))}))}else if("LIBRARY_TEMPLATE"==e.model.attributes.signature_info.state){const a=[];a.push(e.model.attributes.signature_info.state),a.push(e.model.attributes.resources[0].id),a.push(e.model.attributes.resources[0].invitationUrn),this.options.appApi.rnaApi.then(_.bind(function(i){e.model;i.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"openSignTemplateFile",methodArgs:a})}))}else n.then(_.bind(function(){var n=i.esAuthUiModel.get("access_token"),o=s.rnaApiObj.esApi.getEchoSignApiURL(),a={},r=e.model,l="",c=r.attributes.signature_info.state,d=r.attributes.resources[0].name,p=r.attributes.resources[0].id;i.esAuthSessionExists=!0,c.startsWith("WAITING_FOR_MY_")?this.options.appApi.siteCatalystApi.logScEvent([t.SIGN_DOC_OPEN_FOR_SIGN,t.CLICKED]):(this.options.appApi.siteCatalystApi.logScEvent([t.SIGN_DOC_OPEN,t.CLICKED]),l=o+"/api/rest/v6/agreements/"+p+"/combinedDocument"),s.rnaApi.done(_.bind(function(e){a.agreementURL=l,a.agreementID=p,a.agreementName=d,a.accessToken=n,a.agreementState=c;var i=e.signServiceAuthAPI.ensureValidSignSession();i.done(_.bind(function(){this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaSignWorkflowServicesAPI.openSignFile(a)}))},this))},this))},this));return o}}),i.OpenSignAgreementOp}),define("acplugins/signatures/js/ops/getting/get-next-participant-list-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){return i.GetNextParticipantOp=e.Op.extend({run:function(e){var i=this.options,o=i.esApi.authApi.createAuthSession(i),a=$.Deferred();return o.then(_.bind(function(){var o=i.esAuthUiModel.get("access_token"),r=i.appApi.rnaApiObj.esApi.getEchoSignApiURL();i.esAuthSessionExists=!0,i.appApi.rnaApi.done(_.bind(function(i){var l="";l=i.rnaSignWorkflowServicesAPI.isSignV10Enabled()?"/members":"/participantSets";var c="?includeNextParticipantSet=true",d=_.isUndefined(e)?this.options.agreementID:e,p=r+t.API_SUBPATH_V6+"/agreements/"+d+l+c,h=_.extend({Accept:"application/json",Authorization:"Bearer "+o},n.getSignRequestHeaders());$.ajax({url:p,type:"GET",headers:h,contentType:"application/json",dataType:"json",modal:!1,success:_.bind(function(e){a.resolve(e)},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),a.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this))},this)),a}}),i.GetNextParticipantOp}),define("acplugins/signatures/js/ops/getting/get-sign-agreement-etag-op",["core/ac-core","acplugins/signatures/js/ac-signature","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s){return i.GetAgreementIDEtagOp=e.Op.extend({run:function(e){var i=this.options,n=(i.appApi,i.esApi.authApi.createAuthSession(i)),o=$.Deferred();return n.then(_.bind(function(){var n,a=i.esAuthUiModel.get("access_token"),r=i.appApi.rnaApiObj.esApi.getEchoSignApiURL(),l={};i.esAuthSessionExists=!0;var c=_.extend({Authorization:"Bearer "+a},s.getSignRequestHeaders());n=r+"/api/rest/v6/agreements/"+e.agreementID,$.ajax({url:n,type:"GET",modal:!1,headers:c,contentType:"application/json",dataType:"json",success:_.bind(function(e,i,t){l.eTag=t.getResponseHeader("ETag"),o.resolve(l)},this),error:_.bind(function(e){console.log("Error in fetching Agreement Id"),403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&t.esApi.authApi.clearESAuthSession(),o.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this)),o}}),i.GetAgreementIDEtagOp}),define("acplugins/signatures/js/ops/getting/get-sign-agreement-data-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op","pdmplugins/esign/js/ac-esign"],function(e,i){i.GetSignatureAgreementDataOp=e.Op.extend({run:function(e){var i=this.options,t=i.esApi.authApi.createAuthSession(i);i.params=e,t.then(_.bind(function(){var e=i.esAuthUiModel.get("access_token"),t=i.appApi.rnaApiObj.esApi.getEchoSignApiURL(),s=i.params.agreementId,n=[];n.push(this._getAgreementsAPICall(t,e)),n.push(this._getAgreementDetailsAPICall(s,t,e)),n.push(this._getAgreementParticipantDetailsAPICall(s,t,e)),Promise.all(n).then(_.bind(function(e){var t=Object.assign({},e[1].data,e[2].data);void 0!==t.createdDate&&(t.createdDate=this._formatDate(new Date(Date.parse(t.createdDate)))),void 0!==t.expirationTime&&(t.expirationTime=this._formatDate(new Date(Date.parse(t.expirationTime)))),t.eTag=e[1].xhr.getResponseHeader("ETag"),e[0].data.userAgreementList.forEach(function(e){e.id===s&&(t.status=e.status)}),i.appApi.rnaApi.done(_.bind(function(e){e.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"updateDataModelForAgreement",methodArgs:t})},t))},this))},this))},_getAgreementsAPICall:function(e,i){var t=e+"/api/rest/v6/agreements",s=$.Deferred(),n={Accept:"application/json",Authorization:"Bearer "+i};return $.ajax({url:t,headers:n,type:"GET",dataType:"json",global:!1,success:_.bind(function(e,i,t){s.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){s.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),s},_getAgreementDetailsAPICall:function(e,i,t){var s=i+"/api/rest/v6/agreements/"+e,n=$.Deferred(),o={Accept:"application/json",Authorization:"Bearer "+t};return $.ajax({url:s,headers:o,type:"GET",dataType:"json",global:!1,success:_.bind(function(e,i,t){n.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){n.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),n},_getAgreementParticipantDetailsAPICall:function(e,i,t){var s=i+"/api/rest/v6/agreements/"+e+"/participantSets",n=$.Deferred(),o={Accept:"application/json",Authorization:"Bearer "+t};return $.ajax({url:s,headers:o,type:"GET",dataType:"json",global:!1,success:_.bind(function(e,i,t){n.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){n.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),n},_pad:function(e,i,t){return t=t||"0",e+="",e.length>=i?e:new Array(i-e.length+1).join(t)+e},_formatDate:function(e){return e instanceof Date?""+e.getUTCFullYear()+this._pad(e.getUTCMonth()+1,2)+this._pad(e.getUTCDate(),2)+this._pad(e.getUTCHours(),2)+this._pad(e.getUTCMinutes(),2)+this._pad(e.getUTCSeconds(),2)+"Z":""}})}),define("acplugins/signatures/js/ops/getting/get-sign-agreement-thumbnail-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){return i.GetSignAgreementThumbnailOp=e.Op.extend({run:function(e,i,t,s){var n=this.options,o=n.appApi,a=n.esApi.authApi.createAuthSession(n),r=$.Deferred();return a.then(_.bind(function(){var a=n.esAuthUiModel.get("access_token"),l=o.rnaApiObj.esApi.getEchoSignApiURL();void 0===i&&(i="FIXED_WIDTH_50px,FIXED_WIDTH_250px"),this._getThumbnailAPICall(e,l,a,i).then(_.bind(function(e){if(e.data.hasOwnProperty("originalDocumentsImageUrlsInfo")){var i=e.data.originalDocumentsImageUrlsInfo;if(Array.isArray(i)&&i.length>0){var n=i[0];if(n.hasOwnProperty("documentImageUrlsList")&&Array.isArray(n.documentImageUrlsList)){var o={};return n.documentImageUrlsList.forEach(function(e){e.hasOwnProperty("imagesAvailable")&&e.imagesAvailable===!0&&(o[e.imageSize]=e.imageURLs[0].url)}),void r.resolve(t===!0?{ImageURL:o,ItemID:s}:o)}}}r.reject()},this),_.bind(function(e){r.reject(e)},this))},this)),r},_getThumbnailAPICall:function(e,i,o,a){var r=i+t.API_SUBPATH_V6+"/agreements/",l=$.Deferred(),c=_.extend({Accept:"application/json",Authorization:"Bearer "+o,"If-None-Match":""},n.getSignRequestHeaders());return r+=e,r+="/documents/imageUrls",$.ajax({url:r,headers:c,type:"GET",dataType:"json",data:{imageSizes:a},global:!1,success:_.bind(function(e,i,t){l.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),l.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)}),l}}),i.GetSignaturesAuditTrailOp}),define("acplugins/signatures/js/ops/getting/get-sign-files-using-search-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){var o=["WAITING_FOR_MY_SIGNATURE","WAITING_FOR_MY_APPROVAL","WAITING_FOR_MY_DELEGATION","WAITING_FOR_MY_ACKNOWLEDGEMENT","WAITING_FOR_MY_ACCEPTANCE","WAITING_FOR_MY_FORM_FILLING","OUT_FOR_SIGNATURE","OUT_FOR_APPROVAL","OUT_FOR_DELIVERY","OUT_FOR_ACCEPTANCE","OUT_FOR_FORM_FILLING","SIGNED","APPROVED","DELIVERED","ACCEPTED","FORM_FILLED","EXPIRED","RECALLED","ARCHIVED","LIBRARY_TEMPLATE"];i.GetSignFilesListUsingSearchOp=e.Op.extend({run:function(e){var i=this.options,t=i.esApi.authApi.createAuthSession(i);t.then(_.bind(function(){this._getFileListInternal(e)},this))},_getFileListInternal:function(t){var s=this.options,n=s.esAuthUiModel.get("access_token"),a=s.appApi.rnaApiObj.esApi.getEchoSignApiURL(),r={};r.scope=[],r.scope.push("sign"),r.fetch_fields={},r.fetch_fields.includes=[],r.fetch_fields.includes.push("messages"),r.fetch_fields.includes.push("participant_list"),r.limit=100,r.state=o,this._signSearchAPICall(a,n,r).then(_.bind(function(o){var l={};l.response={},l.response.result_set=[],l.status_code=o.xhr.status,l.request=t,l.response.total_hits=o.data.metrics.total_hits,o.data.result_sets.forEach(function(e){"sign"===e.name&&l.response.result_set.push.apply(l.response.result_set,e.items)});var c=[];if(o.data.metrics.total_hits>100)for(var d=100;1e3>d&&d<o.data.metrics.total_hits;d+=100){var p=_.extend(r,{start_index:d}),h=this._signSearchAPICall(a,n,p);c.push(h)}Promise.all(c).then(_.bind(function(t){t.forEach(function(e){e.data.result_sets.forEach(function(e){"sign"===e.name&&l.response.result_set.push.apply(l.response.result_set,e.items)})});var n=[];l.response.result_set.forEach(_.bind(function(e){e.create_date=this._formatDate(new Date(Date.parse(e.create_date))),e.modify_date=this._formatDate(new Date(Date.parse(e.modify_date))),null!==e.expire_date&&(e.expire_date=this._formatDate(new Date(Date.parse(e.expire_date)))),!_.isUndefined(e.roles)&&e.roles.length>1&&e.roles.indexOf("ORIGINATOR")>=0&&n.push(i.opFactory.create("GetNextParticipantOp",this.options).run(e.agreement_id))},this)),Promise.all(n).then(_.bind(function(i){var t=0;l.response.result_set.forEach(_.bind(function(e){if(!_.isUndefined(e.roles)&&e.roles.length>1&&e.roles.indexOf("ORIGINATOR")>=0&&t<i.length){var s=i[t],n={};s.participantSets.forEach(function(i){for(var t=0;t<i.memberInfos.length;t++)i.memberInfos[t].id===s.senderInfo.participantId&&(n.address=i.memberInfos[t].email,n.roles=e.roles,n.label=i.memberInfos[t].name,n.state=i.status,n.id=i.memberInfos[t].id)}),e.participant_list||(e.participant_list=[]),e.participant_list.push(n),t++}},this)),s.appApi.rnaApi.done(_.bind(function(){var i=e.opFactory.create("SendChunkDataToNative",s);i.run(JSON.stringify(l),"SignAgreementListing")},this))},this))},this))},this),_.bind(function(i){s.appApi.rnaApi.done(_.bind(function(){var t=e.opFactory.create("SendChunkDataToNative",s);t.run(JSON.stringify(i),"SignAgreementListing")},this))},this))},_signSearchAPICall:function(e,i,o){var a=e+t.API_SUBPATH_GATEWAY+"/search",r=$.Deferred(),l=_.extend({"Content-Type":"application/json",Authorization:"Bearer "+i},n.getSignRequestHeaders());if(_.isUndefined(i)){var c={code:"INVALID_ACCESS_TOKEN",message:"Access token provided is invalid or has expired",status_code:401};r.reject(c)}else $.ajax({url:a,headers:l,type:"POST",dataType:"json",data:JSON.stringify(o),global:!1,success:_.bind(function(e,i,t){r.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){var i=e.responseJSON||{};i.status_code=e.status||400,"INVALID_IMS_PROFILE"===i.code&&void 0!==i.details&&i.details.signProfile.authenticatingAccount===i.details.loggedInProfile.authenticatingAccount?(this.options.signProfileID=i.details.signProfile.profileId,this.options.signProfileName=i.details.signProfile.profileName,this.options.loggedInProfileName=i.details.loggedInProfile.profileName,this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.invokeMethod({methodName:"GetEchoSignAccessTokenFromCluster",methodArgs:[i.details.signProfile.profileId,i.details.signProfile.profileName,i.details.loggedInProfile.profileName]}).then(_.bind(function(e){this.options.accessToken=e.accessToken;var i=(new Date).getTime()/1e3;this.options.expiresIn=e.expiryTime/1e3-i;var t=this.options.esAuthUiModel;this.options.appApi.rnaApi.accessToken=this.options.accessToken,t.set("access_token",this.options.accessToken),t.set("expiration_time",this.options.expiresIn),t.set("refresh_token",""),t.set("signin_profile_id",this.options.signProfileID),t.set("signin_profile_name",this.options.signProfileName),t.set("loggedin_profile_name",this.options.loggedInProfileName),l=_.extend({"Content-Type":"application/json",Authorization:"Bearer "+e.accessToken},n.getSignRequestHeaders()),$.ajax({url:a,headers:l,type:"POST",dataType:"json",data:JSON.stringify(o),global:!1,success:_.bind(function(e,i,t){r.resolve({data:e,status:i,xhr:t})},this),error:function(e){var i=e.responseJSON||{};i.status_code=e.status||400,403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),r.reject(i)}})},this),function(){r.reject(i)})},this))):403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code?(s.esApi.authApi.clearESAuthSession(),r.reject(i)):r.reject(i)},this)});return r},_pad:function(e,i,t){return t=t||"0",e+="",e.length>=i?e:new Array(i-e.length+1).join(t)+e},_formatDate:function(e){return e instanceof Date?""+e.getUTCFullYear()+this._pad(e.getUTCMonth()+1,2)+this._pad(e.getUTCDate(),2)+this._pad(e.getUTCHours(),2)+this._pad(e.getUTCMinutes(),2)+this._pad(e.getUTCSeconds(),2)+"Z":""}})}),define("acplugins/signatures/js/ops/getting/get-sign-agreement-data-using-search-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){i.GetSignatureAgreementDataUsingSearchOp=e.Op.extend({run:function(e){var i=this.options,t=i.esApi.authApi.createAuthSession(i),s=$.Deferred();return t.then(_.bind(function(){var t=i.esAuthUiModel.get("access_token"),n=i.appApi.rnaApiObj.esApi.getEchoSignApiURL(),o=e.agreementId,a={};a.scope=[],a.scope.push("sign"),a.fetch_fields={},a.fetch_fields.includes=[],a.fetch_fields.includes.push("messages"),a.fetch_fields.includes.push("participant_list"),a.agreement_id=[],a.agreement_id.push(o),this._signSearchAPICall(n,t,a).then(_.bind(function(i){var t={};t.response={},t.request=JSON.stringify(e),i.data.result_sets.forEach(function(e){"sign"===e.name&&(t.response.result_set=e.items)}),t.response.result_set.forEach(_.bind(function(e){e.create_date=this._formatDate(new Date(Date.parse(e.create_date))),e.modify_date=this._formatDate(new Date(Date.parse(e.modify_date))),null!==e.expire_date&&(e.expire_date=this._formatDate(new Date(Date.parse(e.expire_date))))},this)),s.resolve(t)},this))},this)),s},_signSearchAPICall:function(e,i,o){var a=e+t.API_SUBPATH_GATEWAY,r=$.Deferred(),l=_.extend({"Content-Type":"application/json",Authorization:"Bearer "+i},n.getSignRequestHeaders());return this.options.appApi.rnaApi.done(_.bind(function(e){if(a+=e.rnaSignWorkflowServicesAPI.isSignV10Enabled()?"/search":"/agreementsearch",_.isUndefined(i)){var t={code:"INVALID_ACCESS_TOKEN",message:"Access token provided is invalid or has expired",status_code:401};r.reject(t)}else _.delay(_.bind(function(){$.ajax({url:a,headers:l,type:"POST",dataType:"json",data:JSON.stringify(o),global:!1,success:_.bind(function(e,i,t){r.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),r.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this),1e3)},this)),r},_pad:function(e,i,t){return t=t||"0",e+="",e.length>=i?e:new Array(i-e.length+1).join(t)+e},_formatDate:function(e){return e instanceof Date?""+e.getUTCFullYear()+this._pad(e.getUTCMonth()+1,2)+this._pad(e.getUTCDate(),2)+this._pad(e.getUTCHours(),2)+this._pad(e.getUTCMinutes(),2)+this._pad(e.getUTCSeconds(),2)+"Z":""}})}),define("acplugins/signatures/js/ops/getting/get-sign-agreement-data-batch-using-search-op",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/constants/sign-constants","pdmplugins/esign/js/ac-esign","core/utils/http-util","core/ops/op"],function(e,i,t,s,n){i.GetSignatureAgreementDataBatchUsingSearchOp=e.Op.extend({run:function(e){var i=this.options,t=i.esApi.authApi.createAuthSession(i),s=$.Deferred();return t.then(_.bind(function(){var t=i.esAuthUiModel.get("access_token"),n=i.appApi.rnaApiObj.esApi.getEchoSignApiURL(),o=e.agreementIds,a={};a.scope=[],a.scope.push("sign"),a.fetch_fields={},a.fetch_fields.includes=[],a.fetch_fields.includes.push("messages"),a.fetch_fields.includes.push("participant_list"),a.agreement_id=o,this._signSearchAPICall(n,t,a).then(_.bind(function(i){var t={};t.response={},t.request=JSON.stringify(e),i.data.result_sets.forEach(function(e){"sign"===e.name&&(t.response.result_set=e.items)}),t.response.result_set.forEach(_.bind(function(e){e.create_date=this._formatDate(new Date(Date.parse(e.create_date))),e.modify_date=this._formatDate(new Date(Date.parse(e.modify_date))),null!==e.expire_date&&(e.expire_date=this._formatDate(new Date(Date.parse(e.expire_date))))},this)),s.resolve(t)},this))},this)),s},_signSearchAPICall:function(e,i,o){var a=e+t.API_SUBPATH_GATEWAY,r=$.Deferred(),l=_.extend({"Content-Type":"application/json",Authorization:"Bearer "+i},n.getSignRequestHeaders());return this.options.appApi.rnaApi.done(_.bind(function(e){if(a+=e.rnaSignWorkflowServicesAPI.isSignV10Enabled()?"/search":"/agreementsearch",_.isUndefined(i)){var t={code:"INVALID_ACCESS_TOKEN",message:"Access token provided is invalid or has expired",status_code:401};r.reject(t)}else $.ajax({url:a,headers:l,type:"POST",dataType:"json",data:JSON.stringify(o),global:!1,success:_.bind(function(e,i,t){r.resolve({data:e,status:i,xhr:t})},this),error:_.bind(function(e){403==e.status&&"INVALID_API_ACCESS_POINT"==e.responseJSON.code&&s.esApi.authApi.clearESAuthSession(),r.reject({httpRespCode:e.status,httpRespBody:e.responseText})},this)})},this)),r},_pad:function(e,i,t){return t=t||"0",e+="",e.length>=i?e:new Array(i-e.length+1).join(t)+e},_formatDate:function(e){return e instanceof Date?""+e.getUTCFullYear()+this._pad(e.getUTCMonth()+1,2)+this._pad(e.getUTCDate(),2)+this._pad(e.getUTCHours(),2)+this._pad(e.getUTCMinutes(),2)+this._pad(e.getUTCSeconds(),2)+"Z":""}})}),define("acplugins/signatures/js/ops/plugin/inititalize-echosign-op",["core/ac-core","acplugins/signatures/js/ac-signature","pdmplugins/esign/js/ac-esign","core/ops/op"],function(e,i,t){i.InitializeEchoSignOp=e.Op.extend({run:function(){var e=this.options;t.opFactory.create("InitializingOp",e).run(),e.esApi=t.esApi,e.esInitialized=!0}})}),define("acplugins/signatures/js/ops/op-factory",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/selection/clearing-selection-op","core/ops/selection/selecting-collection-item-op","acplugins/signatures/js/ops/plugin/starting-plugin-op","acplugins/signatures/js/ops/plugin/listening-for-view-events-op","acplugins/signatures/js/ops/getting/getting-parcels-op","acplugins/signatures/js/ops/getting/getting-rhp-preview-metadata-op","acplugins/signatures/js/ops/downloading/downloading-parcel-assets-op","acplugins/signatures/js/ops/downloading/saveas-single-asset-op","acplugins/signatures/js/ops/manipulation/deleting-parcel-if-confirmed-op","acplugins/signatures/js/ops/manipulation/deleting-parcel-op","acplugins/signatures/js/ops/manipulation/forwarding-parcel-op","acplugins/signatures/js/ops/manipulation/setting-delivery-receipts-op","acplugins/signatures/js/ops/manipulation/unsharing-parcel-if-confirmed-op","acplugins/signatures/js/ops/manipulation/unsharing-parcel-op","acplugins/signatures/js/ops/manipulation/remind-participant-sendAPI-op","acplugins/signatures/js/ops/manipulation/cancel-agreement-op","acplugins/signatures/js/ops/selection/selecting-collection-item-op","acplugins/signatures/js/ops/showing/showing-parcel-preview-op","acplugins/signatures/js/ops/showing/showing-sign-in-op","acplugins/signatures/js/ops/showing/showing-single-asset-op","acplugins/signatures/js/ops/showing/desktop-show-in-browser-op","acplugins/signatures/js/ops/showing/jump-to-browser-api-call-op","acplugins/signatures/js/ops/getting/get-sign-files-op","acplugins/signatures/js/ops/getting/get-sign-audit-trail-op","acplugins/signatures/js/ops/getting/get-sign-activity-op","acplugins/signatures/js/ops/downloading/open-sign-agreement-op","acplugins/signatures/js/ops/getting/get-next-participant-list-op","acplugins/signatures/js/ops/getting/get-sign-agreement-etag-op","acplugins/signatures/js/ops/getting/get-sign-agreement-data-op","acplugins/signatures/js/ops/getting/get-sign-agreement-thumbnail-op","acplugins/signatures/js/ops/getting/get-sign-files-using-search-op","acplugins/signatures/js/ops/getting/get-sign-agreement-data-using-search-op","acplugins/signatures/js/ops/getting/get-sign-agreement-data-batch-using-search-op","acplugins/signatures/js/ops/plugin/inititalize-echosign-op"],function(e,i){i.OpFactory=e.Op.extend({create:function(e,t){var s=i[e];
return s?new s(t):void LOG(0,"AcSignatures.OpFactory.create: Unrecognized class: "+e)}})}),define("acplugins/signatures/js/utils/sc-constants",["plugins-common/ac-plugins"],function(e){e.Signatures||(e.Signatures={});var i=e.Signatures;return i.ScConstants={ACTION:"Action",ACTIONS:"Actions",ADD_FILES_TO_SHARE:"AddFilesToShare",ADDRESS_BOOK:"AddressBook",ATTEMPTED_TO_SHARE_FORM:"AttemptedToShareForm",AUTOCOMPLETE:"Autocomplete",AVOIDED:"Avoided",BROWSER_CLOSE:"BrowserClosed",BRANDING:"Branding",CANCEL:"Cancel",CHECKED:"Checked",CHICKLET_ADDED:"ChickletAdded",CLICKED:"Clicked",CLICK_BRANDING:"ClickBranding",CLICK_BRANDING_IN_READER:"ClickBrandingInReader",CLICK_BRANDING_IN_ACROBAT:"ClickBrandingInAcrobat",CLOSE:"Close",COLOR_INPUT:"ColorInput",COLOR_MENU_BUTTON:"ColorMenuButton",COLOR_WELL:"ColorWell",CONTINUE:"Continue",DATE_VIEWED:"DateViewed",DEFAULT:"Default",DIALOG:"Dialog",DISABLED:"Disabled",DISALLOWED:"Disallowed",DOWNLOAD:"Download",DOWNLOAD_ALL:"DownloadAll",DOWNLOAD_ONE:"DownloadOne",DRAG_FILES:"DragFiles",DURATION:"Duration",EDIT_BRANDING_ONLINE:"ContinueOnline",EMAIL:"Email",EMAIL_LINK:"EmailLink",ENABLED:"Enabled",ENTERED:"Entered",EVENTUAL_CLICK:"EventualClick",FILE:"File",FILE_LIST:"FileList",FILE_NAME:"FileName",FILES_SHARED_DLG:"FilesSharedDlg",FORWARD:"Forward",FULL_ACTIVITY:"FullActivity",HIDDEN:"Hidden",IMMEDIATE_CLICK:"ImmediateClick",INCLUDE_MESSAGE_TEXT:"IncludeMessageText",INCLUDE_REPLY_TO:"IncludeReplyTo",IPM:"IPM",LATER:"Later",LOGO_BUTTON:"LogoButton",LOGO_CANCEL:"LogoCancel",LOGO_SAVE:"LogoSave",MESSAGE:"Message",MULTI:"Multi",NO_PARCELS:"NoParcels",NOTIFY_WHEN_VIEWED:"NotifyWhenViewed",NUM_FILES_CHECKED:"NumFilesChecked",PERSONAL:"Personal",PERSONAL_AND_PUBLIC:"PersonalANDPublic",PREVIEW:"Preview",PUBLIC:"Public",PUBLIC_LINK:"PublicLink",RECVIEW:"RecView",REPLY:"Reply",REMOVE:"Remove",REPORT_ABUSE:"ReportAbuse",RHP:"RHP",SCROLL:"Scroll",SAVE_AS:"SaveAs",SELECT_ALL:"SelectAll",SELECT_FILES:"SelectFiles",SENT_FILES:"SentFiles",SHARE:"Share",SHARE_BUTTON:"ShareButton",SHARE_FILE_BUTTON:"ShareFileButton",SHARE_ICON:"ShareIcon",SHARE_WITH:"ShareWith",SHARED:"Shared",SHOWN:"Shown",SINGLE:"Single",SORT:"Sort",SUBJECT:"Subject",SUCCESS:"Success",SURVEY:"Survey",SURVEY_CANCEL:"SurveyCancel",SURVEY_FIELD_FOCUS:"SurveyFieldFocus",SURVEY_LINK:"SurveyLink",SURVEY_SEND:"SurveySend",TOOLS:"Tools",TRACK:"Track",TRASH:"Trash",TURN_OFF_BRANDING:"TurnOffBranding",TURN_ON_BRANDING:"TurnOnBranding",UNCHECKED:"Unchecked",UNSHARE:"Unshare",UPGRADE:"Upgrade",URL_HIGHLIGHT:"UrlHighlight",URL_KEY_COPY:"UrlKeyCopy",VIEW:"View",VIEW_ALL_SHARED_FILES:"ViewAllSharedFiles",VIEW_FULL_ACTIVITY:"ViewFullActivity",WARNED_BEFORE_CLOSING:"WarnB4Close",WARNING:"Warning",WITH_REPLY:"wReply",1:"1","2_TO_5":"2to5","6_TO_10":"6to10","11_OR_MORE":"11orMore","11_TO_20":"11to20","21_TO_40":"21to40","41_TO_120":"41to120","121_OR_MORE":"121orMore",FSS:"FSS",FORM:"Form",OUTPUT:"Output",SAVE_TO_PDF:"SaveToPDF","1_STARTED":"1-Started","2_COMPLETED":"2-Completed",ERROR:"Error",SEND_TAB:"SendTab",COMPLETED:"Completed",ALL:"All",DRAFT:"Drafts",IN_PROGRESS:"In progress",WAITING_FOR_YOU:"Waiting for you",EXPIRED:"Expired",CANCELED:"Canceled",TEMPLATES:"Templates"},i.ScConstants}),define("acplugins/signatures/js/templates/tracked-send-template.html",[],function(){return'<div class="on-signed-in ui-theme theme-container"></div>    <div class= "one_table" >      <div class= "one_row" >         <div class="lhs_space" >        </div >        <div class="on-signed-out ui-theme theme-container ">        </div >       </div >       </div >     <div class="files-offline-view ui-theme theme-container"></div>	 <div class="files-no-access-view ui-theme theme-container"></div>    <div class="context-board-view context-board-rhp"></div>'}),define("acplugins/signatures/js/utils/sharing",[],function(){var e={Connector:{kind:"value",values:["DOCCLD","CCLOUD","ONEDRV"]},CountValue2:{kind:"value",values:["2to5","6to10","11orMore"]},CountValue1:{kind:"value",values:["1","2to5","6to10","11orMore"]},CountValue0:{kind:"value",values:["0","1","2to5","6to10","11orMore"]}},i=[{pageName:"FileList:SentFiles:Clicked",selector:""},{pageName:"FileList:SentFiles:Action:Unshare",selector:""},{pageName:"FileList:SentFiles:Action:Forward",selector:""},{pageName:"FileList:SentFiles:Action:Download",selector:""},{pageName:"FileList:SentFiles:Action:Trash",selector:""},{pageName:"FileList:SentFiles:Action:SelectAll",selector:""},{pageName:"FileList:SentFiles:FileName:Checked",selector:""},{pageName:"FileList:SentFiles:FileName:Unchecked",selector:""},{pageName:"FileList:SentFiles:NumFilesChecked:<CountValue1>",selector:"",variables:{CountValue1:e.CountValue1},values:e.CountValue1},{pageName:"Preview:Shared:Single:Shown",selector:""},{pageName:"Preview:Shared:Multi:Shown",selector:""},{pageName:"Preview:Shared:Single:NotifyWhenViewed:Checked",selector:""},{pageName:"Preview:Shared:Multi:NotifyWhenViewed:Checked",selector:""},{pageName:"Preview:Shared:Single:NotifyWhenViewed:Unchecked",selector:""},{pageName:"Preview:Shared:Multi:NotifyWhenViewed:Unchecked",selector:""},{pageName:"Preview:Shared:Single:ViewFullActivity",selector:""},{pageName:"Preview:Shared:Multi:ViewFullActivity",selector:""},{pageName:"Preview:Shared:Multi:PreviewFile:SendFileAgain",selector:""},{pageName:"Preview:Shared:Single:Unshare",selector:""},{pageName:"Preview:Shared:Multi:Unshare",selector:""},{pageName:"Preview:Shared:Single:PublicLink",selector:""},{pageName:"Preview:Shared:Multi:PublicLink",selector:""},{pageName:"Preview:Shared:Multi:Forward",selector:""},{pageName:"Preview:Shared:Multi:File:NextPg",selector:""},{pageName:"Preview:Shared:Multi:File:PrevPg",selector:""},{pageName:"Preview:Shared:Multi:UnshareDlg:Shown",selector:""},{pageName:"Preview:Shared:Multi:UnshareDlg:Unshare:Clicked",selector:""},{pageName:"Preview:Shared:Multi:UnshareDlg:Unshare:Cancel",selector:""},{pageName:"Preview:Shared:Single:FullActivity:Shown",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Shown",selector:""},{pageName:"Preview:Shared:Single:FullActivity:Close",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Close",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Filter:All",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Filter:Recipient",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Filter:Activity",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Filter:Item",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Sort:ViewedBy",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Sort:DateViewed",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Close",selector:""},{pageName:"Preview:Shared:Multi:FullActivity:Sort:File",selector:""},{pageName:"Preview:Shared:Multi:Preview:RHP:ShareFileButton",selector:""},{pageName:"RecView:Multi:Shown",selector:""},{pageName:"RecView:Multi:Shown:wReply",selector:""},{pageName:"RecView:Multi:SaveToAcrobat",selector:""},{pageName:"RecView:Multi:File:NextPg",selector:""},{pageName:"RecView:Multi:File:PrevPg",selector:""},{pageName:"RecView:Preview:BottomNavBar:FitPgFull",selector:""},{pageName:"RecView:Preview:BottomNavBar:FitPgWidth",selector:""},{pageName:"RecView:Preview:BottomNavBar:FullScreen",selector:""},{pageName:"RecView:Preview:BottomNavBar:HideRHP",selector:""},{pageName:"RecView:Preview:BottomNavBar:NextPg",selector:""},{pageName:"RecView:Preview:BottomNavBar:PrevPg",selector:""},{pageName:"RecView:Preview:BottomNavBar:Scroll",selector:""},{pageName:"RecView:Preview:BottomNavBar:Close",selector:""},{pageName:"RecView:Multi:Preview:Shown",selector:""},{pageName:"RecView:Multi:Preview:ReportAbuse",selector:""},{pageName:"RecView:Multi:Preview:Download",selector:""},{pageName:"RecView:Multi:downloadOne",selector:""},{pageName:"RecView:Multi:downloadAll",selector:""},{pageName:"RecView:Multi:Preview:BackButton",selector:""},{pageName:"RecView:Multi:Preview:Reply",selector:""},{pageName:"RecView:Single:Shown",selector:""},{pageName:"RecView:Single:Shown:wReply",selector:""},{pageName:"RecView:Single:ReportAbuse",selector:""},{pageName:"RecView:Single:Download",selector:""},{pageName:"RecView:Single:Reply",selector:""},{pageName:"Preview:Toolbar:Share:Clicked",selector:""},{pageName:"Tools:Share:Clicked",selector:""},{pageName:"Tools:Share:Shown",selector:""},{pageName:"Tools:Share:Shown:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:ts-direct-to-workflow-view:<cohort-name>",selector:""},{pageName:"Tools:Share:welcome:Shown",selector:""},{pageName:"Tools:Share:workflow:Shown",selector:""},{pageName:"Tools:Share:success:Shown",selector:""},{pageName:"Tools:Share:welcome:Shown:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:workflow:Shown:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:success:Shown:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:welcome:BrowserClosed:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:workflow:BrowserClosed:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:success:BrowserClosed:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:SelectFiles:Clicked",selector:""},{pageName:"Tools:Share:ViewAllSharedFiles:Clicked",selector:""},{pageName:"Tools:Share:AddFilesToShare",selector:""},{pageName:"Tools:Share:ShareWith:Public",selector:""},{pageName:"Tools:Share:ShareWith:Public:Checked",selector:""},{pageName:"Tools:Share:ShareWith:Public:Unchecked",selector:""},{pageName:"Tools:Share:ShareWith:Personal",selector:""},{pageName:"Tools:Share:ShareWith:Personal:Checked",selector:""},{pageName:"Tools:Share:ShareWith:Personal:Unchecked",selector:""},{pageName:"Tools:Share:ShareWith:Personal:<CountValue1>",selector:"",variables:{CountValue1:e.CountValue1},values:e.CountValue1},{pageName:"Tools:Share:Email:Disabled:Clicked",selector:""},{pageName:"Tools:Share:Subject:Entered",selector:""},{pageName:"Tools:Share:Message:Entered",selector:""},{pageName:"Tools:Share:Subject:Default",selector:""},{pageName:"Tools:Share:Message:Default",selector:""},{pageName:"Tools:Share:IncludeMessageText:Unchecked",selector:""},{pageName:"Tools:Share:IncludeMessageText:Checked",selector:""},{pageName:"Tools:Share:IncludeReplyTo:Unchecked",selector:""},{pageName:"Tools:Share:IncludeReplyTo:Checked",selector:""},{pageName:"Tools:Share:AttemptedToShareForm",selector:""},{pageName:"Tools:Share:ShareButton",selector:""},{pageName:"Tools:Share:ShareButton:Clicked",selector:""},{pageName:"Tools:Share:ShareButton:Disabled",selector:""},{pageName:"Tools:Share:Cancel",selector:""},{pageName:"Tools:Share:AddressBook:Clicked",selector:""},{pageName:"Tools:Share:AddressBook:Shown",selector:""},{pageName:"Tools:Share:AddressBook:Success",selector:""},{pageName:"Tools:Share:AddressBook:Cancel",selector:""},{pageName:"Tools:Share:AddressBook:IPM",selector:""},{pageName:"Tools:Share:AddressBook:Enabled",selector:""},{pageName:"Tools:Share:FilesSharedDlog:Personal:ts-success-dlg-1:<cohort-name>",selector:""},{pageName:"Tools:Share:FilesSharedDlog:Public:ts-success-dlg-1:<cohort-name>",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:ts-success-dlg-1:<cohort-name>",selector:""},{pageName:"Tools:Share:FilesSharedDlog:Personal:ts-public-url-copy:<cohort-name>",selector:""},{pageName:"Tools:Share:FilesSharedDlog:Public:ts-public-url-copy:<cohort-name>",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic::ts-public-url-copy:<cohort-name>",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Personal:Shown",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Personal:Close",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:Shown",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:EmailLink",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:UrlHighlight",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:Close",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:Shown",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:EmailLink",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:UrlHighlight",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:UrlKeyCopy",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:UrlKeyCopy",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Personal:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:Duration:<DurationValue>",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Personal:WarnB4Close",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Public:WarnB4Close",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:WarnB4Close",selector:""},{pageName:"Tools:Share:FilesSharedDlg:PersonalANDPublic:Close",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:MyCmptr:Shown",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:MyCmptr:ChooseFilesButton:Clicked",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:MyCmptr:DragFiles:<CountValue1>",selector:"",variables:{CountValue1:e.CountValue1},values:e.CountValue1},{pageName:"Tools:Share:ChooseFilesDlg:MyCmptr:AddSelected:<CountValue1>",selector:"",variables:{CountValue1:e.CountValue1},values:e.CountValue1},{pageName:"Tools:Share:ChooseFilesDlg:MyCmptr:Cancel",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:<Connector>:Shown",selector:"",variables:{Connector:e.Connector},values:e.Connector},{pageName:"Tools:Share:ChooseFilesDlg:<Connector>:ChooseFiles:Clicked",selector:"",variables:{Connector:e.Connector},values:e.Connector},{pageName:"Tools:Share:ChooseFilesDlg:<Connector>:AddSelected:<CountValue1>",selector:"",variables:{Connector:e.Connector,CountValue1:e.CountValue1},values:e.CountValue1},{pageName:"Tools:Share:ChooseFilesDlg:<Connector>:Cancel",selector:"",variables:{Connector:e.Connector},values:e.Connector},{pageName:"Tools:Share:ChooseFilesDlg:RecentFiles:Clicked",selector:""},{pageName:"Tools:Share:Branding:ColorMenuButton",selector:"",prop49:"Clicked on the color menu button in the customize branding dialog"},{pageName:"Tools:Share:Branding:LogoButton",selector:"",prop49:"Clicked to change logo in customize branding dialog"},{pageName:"Tools:Share:Branding:ClickBrandingInReader",selector:"",prop49:"Clicked to edit their branding settings while in the In Reader Browser"},{pageName:"Tools:Share:Branding:ClickBranding",selector:""},{pageName:"Tools:Share:Branding:LogoCancel",selector:""},{pageName:"Tools:Share:Branding:LogoSave",selector:""},{pageName:"Tools:Share:Branding:TurnOffBranding",selector:""},{pageName:"Tools:Share:Branding:TurnOnBranding",selector:""},{pageName:"Tools:Share:Branding:ColorWell",selector:""},{pageName:"Tools:Share:Branding:ColorInput",selector:""},{pageName:"Tools:Share:Branding:ContinueOnline",selector:""},{pageName:"Tools:Share:Branding:ContinueOnline:Continue",selector:""},{pageName:"Tools:Share:Branding:ContinueOnline:Cancel",selector:""},{pageName:"RecView:ReportAbuse:Dialog:ReportAbuse:Success",selector:""},{pageName:"RecView:ReportAbuse:Dialog:ReportAbuse:Cancel",selector:""},{pageName:"Tools:Share:ShareWith:Personal:IPM:Shown",selector:""},{pageName:"Tools:Share:ShareWith:Personal:IPM:<cohort-name>",selector:""},{pageName:"Tools:Share:ShareWith:Personal:IPM:Later:Clicked",selector:""},{pageName:"Tools:Share:ShareWith:Personal:IPM:Upgrade:Clicked",selector:""},{pageName:"Tools:Share:ShareWith:Personal:IPM:Close",selector:""},{pageName:"Tools:Share:FilesSharedDlg:Disallowed:Warning:Shown",selector:""},{pageName:"Preview:FileInfo:Clicked",selector:""},{pageName:"Preview:ShareIcon:Clicked",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:Cancel",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:<Connector>:Clicked",selector:"",variables:{Connector:e.Connector},values:e.Connector},{pageName:"Tools:Share:ChooseFilesDlg:Continue",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:AcomOnly:Success:1",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:MyCmptr:Clicked",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:Cancel",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:AcomOnly:Success:2",selector:""},{pageName:"Tools:Share:ChooseFilesDlg:AcomOnly:Success:3",selector:""},{pageName:"FileList:Shared:Clicked",selector:""},{pageName:"FileList:ShareFileDlg:Shown",selector:""},{pageName:"FileList:ShareFileDlg:MakePrivate",selector:""},{pageName:"FileList:ShareFileDlg:MakePublic",selector:""},{pageName:"FileList:ShareFileDlg:EmailLink:Clicked",selector:""},{pageName:"FileList:ShareFileDlg:EmailLinkButton:Clicked",selector:""},{pageName:"FileList:ShareFileDlg:Cancel",selector:""},{pageName:"FileList:ActionBar:ShareFileDlg:Shown",selector:""},{pageName:"FileList:ActionBar:ShareFileDlg:MakePrivate",selector:""},{pageName:"FileList:ActionBar:ShareFileDlg:MakePublic",selector:""},{pageName:"FileList:ActionBar:ShareFileDlg:EmailLink:Clicked",selector:""},{pageName:"FileList:ActionBar:ShareFileDlg:EmailLinkButton:Clicked",selector:""},{pageName:"FileList:ActionBar:ShareFileDlg:Cancel",selector:""},{pageName:"Preview:Toolbar:GearMenu:ShareFileDlg:Shown",selector:""},{pageName:"Preview:Toolbar:GearMenu:ShareFileDlg:MakePrivate",selector:""},{pageName:"Preview:Toolbar:GearMenu:ShareFileDlg:MakePublic",selector:""},{pageName:"sent",selector:""},{pageName:"Preview:Toolbar:GearMenu:ShareFileDlg:EmailLinkButton:Clicked",selector:""},{pageName:"Preview:Toolbar:GearMenu:ShareFileDlg:Cancel",selector:""},{pageName:"FileList:DupFileNameDlg:DeleteUploaded:Success",selector:""},{pageName:"Tools:Survey:SurveyLink",selector:""},{pageName:"Tools:Survey:Cancel",selector:""},{pageName:"Tools:Survey:Send",selector:""},{pageName:"Tools:Survey:SurveyFieldFocus",selector:""}];return{variables:e,pages:i}}),define("acplugins/signatures/js/utils/ts-utils",[],function(){var e={extractRootUrl:function(e){var i=document.createElement("a");return i.href=e,i.protocol+"//"+i.host}};return e}),define("acplugins/signatures/js/models/ui/parcel-preview-ui-model",["core/ac-core","acplugins/signatures/js/ac-signature","core/models/ui/ui-model"],function(e,i){return i.ParcelPreviewUiModel=e.UiModel.extend({recognized:{parcelPreview:{type:"object",optional:!0},deferred:{type:"object",optional:!0},onHistoryChange:{type:"object",optional:!0}},defaults:{parcelPreview:void 0,deferred:void 0,onHistoryChange:void 0}}),i.ParcelPreviewUiModel}),define("viewer/ac-viewer",[],function(){var e,i,t;return e="dev",i=Ac.Viewer,i||(i=Ac.Viewer={}),t=i[e],t||(t=i[e]={}),t.VERSION=e,t.ID||(t.APP_ID="viewer"),t}),define("viewer/models/parcel-asset-model",["core/ac-core","viewer/ac-viewer","core/models/collection-item-model"],function(e,i){i.ParcelAssetModel=e.CollectionItemModel.extend({initialize:function(i,t){e.CollectionItemModel.prototype.initialize.call(this,i,t),t.collection&&(this.rootUrl=t.collection.rootUrl),t.rootUrl&&(this.rootUrl=t.rootUrl)},getRenditionUrl:function(i,t){var s,n,o;return s=this.collection.parcel,o=s.get("invitation"),o?(n=this.rootUrl+"a/invitation/"+encodeURIComponent(o)+"/asset/"+encodeURIComponent(this.get("id"))+"/"+i,t&&(n+="?page="+t),n):e.CollectionItemModel.prototype.getRenditionUrl.call(this,i,t)}})}),define("viewer/collections/parcel-asset-collection",["viewer/ac-viewer","core/utils/http-util","viewer/models/parcel-asset-model"],function(e,i){e.ParcelAssetCollection=Backbone.Collection.extend({model:e.ParcelAssetModel,initialize:function(e,i){Backbone.Collection.prototype.initialize.call(this,e,i),this.rootUrl=i.rootUrl,this.parcel_id=i.parcel_id,this.parcel=i.parcelModel,this.sortAscending=!0,this.sortField="name"},comparator:function(e,i){var t,s,n,o=e.get(this.sortField),a=i.get(this.sortField);return t=this.sortAscending?o:a,s=this.sortAscending?a:o,n=t===s?0:s>t?-1:1},url:function(){return this.rootUrl+"/a/api/parcels/"+this.parcel_id+"/assets"},fetch:function(e){return e=i.customizeOptions("GET",e),Backbone.Collection.prototype.fetch.call(this,e)},parse:function(e){return e.assets}})}),define("acplugins/signatures/js/ops/showing/parcel-preview-op",["core/ac-core","acplugins/signatures/js/ac-signature","viewer/ac-viewer","acplugins/signatures/js/utils/sc-constants","acplugins/signatures/js/utils/ts-utils","viewer/collections/parcel-asset-collection","core/ops/op"],function(e,i,t,s,n){return i.ParcelPreviewOp=e.Op.extend({run:function(){var e,o,a,r,l,c,d=this.options,p=this.options.parcelModel,h=this.options.parcelPreviewUiModel,u=this.options.appApi;e=u.displayApi.showFullOverlay(!0),o=this.options.appApi.baseFilesUrisApi.getSendApiUri(),o=n.extractRootUrl(o),d.parcelAssetsCollection=new t.ParcelAssetCollection([],{rootUrl:o,parcel_id:p.id,parcelModel:p}),a=h.get("parcelPreview"),a&&a.off(),l=h.get("deferred"),l||(l=$.Deferred(),h.set({deferred:l})),c=h.get("onHistoryChange"),c&&u.routerApi.removeHistoryChangeCallback(c),c=this._onHistoryChange,u.routerApi.addHistoryChangeCallback(c),h.set({onHistoryChange:c}),r=_.extend({},d,{el:e,parcelModel:p}),a=new i.ParcelPreviewView(r),h.set({parcelPreview:a}),this.parcelPreview=a,a.on("all",d.rootView._onViewEvent,d.rootView),a.on("ParcelPreview_Close",this._onParcelPreviewClose,this);var g=i.opFactory.create("GettingAssetsOp",d);return g.run().then(_.bind(function(){var e;e=d.parcelAssetsCollection&&d.parcelAssetsCollection.length>1?s.MULTI:s.SINGLE,u.siteCatalystApi.logScEvent([s.PREVIEW,s.SHARED,e,s.SHOWN]),this.render()},a)),l.promise()},_onParcelPreviewClose:function(){var e,i=this.options.parcelPreviewUiModel;e=i.get("parcelPreview"),e&&(i.unset("parcelPreview"),e.off(),_.defer(_.bind(function(){var t=i.get("deferred");t.resolve(),i.unset("deferred"),this.options.appApi.routerApi.removeHistoryChangeCallback(this._onHistoryChange),this.options.appApi.displayApi.showFullOverlay(!1),e.$el.empty()},this)))},_onHistoryChange:function(){this._onParcelPreviewClose()}}),i.ParcelPreviewOp}),define("acplugins/signatures/js/templates/on-signed-in-template.html",[],function(){return'<div class="signatures-files-header"></div><div class="signatures-files-body shared-workflow-files-body"></div><div class="sent-files-rhp shared-files-rhp hidden"></div><div class="sent-files-footer ui-theme theme-container-prominent theme-border"></div>'}),define("acplugins/signatures/js/templates/signatures-files-header-template.html",[],function(){return'<div class="signatures-files-main-header shared-files-main-header theme-file-list-row-border"><div class="signature-workflow-name shared-workflow-heading theme-page-header "><%= workflowName %></div></div>'}),define("acplugins/signatures/js/utils/sign-workflow-utils",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!core/nls/ui-strings","core/models/workflow-status-strings","acplugins/signatures/js/utils/sc-constants","i18n!acplugins/signatures/js/nls/ui-strings"],function(e,i,t,s,n,o){var a=[{id:"waiting-for-you",str:t.WAITING_FOR_YOU,status:[s.WAITING_FOR_MY_SIGNATURE,s.WAITING_FOR_MY_APPROVAL,s.WAITING_FOR_MY_DELEGATION,s.WAITING_FOR_MY_ACKNOWLEDGEMENT,s.WAITING_FOR_MY_ACCEPTANCE,s.WAITING_FOR_MY_FORM_FILLING]},{id:"signed",str:t.SIGNED,status:s.SIGNED},{id:"completed",str:t.COMPLETED,status:s.COMPLETED},{id:"waiting",str:t.WAITING,status:[s.WAITING_FOR_MY_SIGNATURE,s.WAITING_FOR_MY_APPROVAL,s.WAITING_FOR_MY_DELEGATION,s.WAITING_FOR_MY_ACKNOWLEDGEMENT,s.WAITING_FOR_MY_ACCEPTANCE,s.WAITING_FOR_MY_FORM_FILLING]},{id:"canceled",str:t.CANCELLED,status:s.CANCELLED},{id:"expired",str:t.EXPIRED,status:s.EXPIRED},{id:"approved",str:t.APPROVED,status:s.APPROVED},{id:"delivered",str:t.DELIVERED,status:s.DELIVERED},{id:"accepted",str:t.ACCEPTED,status:s.ACCEPTED},{id:"form-filled",str:t.FORM_FILLED,status:s.FORM_FILLED},{id:"template",str:t.LIBRARY_TEMPLATE,status:s.LIBRARY_TEMPLATE}];return i.SignWorkflowUtil={_getStatusInfo:function(){return a},convertToNativeRSState:function(e){var i="";return e===s.SIGNED||e===s.APPROVED||e===s.DELIVERED||e===s.ACCEPTED||e===s.FORM_FILLED||e===s.ARCHIVED?i=n.COMPLETED:e===s.WAITING_FOR_MY_SIGNATURE||e===s.WAITING_FOR_MY_APPROVAL||e===s.WAITING_FOR_MY_DELEGATION||e===s.WAITING_FOR_MY_ACKNOWLEDGEMENT||e===s.WAITING_FOR_MY_ACCEPTANCE||e===s.WAITING_FOR_MY_FORM_FILLING?i=n.WAITING_FOR_YOU:e===s.OUT_FOR_SIGNATURE||e===s.OUT_FOR_APPROVAL||e===s.OUT_FOR_DELIVERY||e===s.OUT_FOR_ACCEPTANCE||e===s.OUT_FOR_FORM_FILLING?i=n.IN_PROGRESS:e===s.CANCELLED?i=n.CANCELED:e===s.EXPIRED?i=n.EXPIRED:e===s.DRAFT||e===s.WAITING_FOR_AUTHORING?i=n.DRAFT:(e===s.TEMPLATES||e===s.LIBRARY_TEMPLATE)&&(i=n.TEMPLATES),i},getUIStringFromStatusID:function(e){switch(e){case n.ALL:return o.ALL;case n.COMPLETED:return o.COMPLETED;case n.DRAFT:return o.DRAFTS;case n.WAITING_FOR_YOU:return o.WAITING_FOR_YOU;case n.CANCELED:return o.CANCELED;case n.IN_PROGRESS:return o.IN_PROGRESS;case n.EXPIRED:return o.EXPIRED;case n.TEMPLATES:return o.TEMPLATES;default:return""}},getPromptMsgFromStatusID:function(e){switch(e){case n.ALL:return o.EMPTY_STATE_ALL_PROMPT;case n.COMPLETED:return o.EMPTY_STATE_COMPLETED_PROMPT;case n.DRAFT:return o.EMPTY_STATE_DRAFT_PROMPT;case n.WAITING_FOR_YOU:return o.EMPTY_STATE_WAITING_FOR_YOU_PROMPT;case n.CANCELED:return o.EMPTY_STATE_CANCELED_PROMPT;case n.IN_PROGRESS:return o.EMPTY_STATE_IN_PROGRESS_PROMPT;case n.EXPIRED:return o.EMPTY_STATE_EXPIRED_PROMPT;case n.TEMPLATES:return o.EMPTY_STATE_TEMPLATES_PROMPT;default:return""}},getSubPromptMsgFromStatusID:function(e){switch(e){case n.ALL:return o.EMPTY_STATE_ALL_SUBPROMPT;case n.COMPLETED:return o.EMPTY_STATE_COMPLETED_SUBPROMPT;case n.DRAFT:return o.EMPTY_STATE_DRAFT_SUBPROMPT;case n.WAITING_FOR_YOU:return o.EMPTY_STATE_WAITING_FOR_YOU_SUBPROMPT;case n.CANCELED:return o.EMPTY_STATE_CANCELED_SUBPROMPT;case n.IN_PROGRESS:return o.EMPTY_STATE_IN_PROGRESS_SUBPROMPT;case n.EXPIRED:return o.EMPTY_STATE_EXPIRED_SUBPROMPT;case n.TEMPLATES:return o.EMPTY_STATE_TEMPLATES_SUBPROMPT;default:return""}},isNativeRSLeftRailID:function(e){return[n.ALL,n.COMPLETED,n.DRAFT,n.WAITING_FOR_YOU,n.CANCELED,n.IN_PROGRESS,n.EXPIRED,n.TEMPLATES].indexOf(e)>=0}},i.SignWorkflowUtil}),define("acplugins/signatures/js/views/signatures-files-header-view",["core/ac-core","core/models/workflow-status-strings","acplugins/signatures/js/ac-signature","i18n!acplugins/signatures/js/nls/ui-strings","i18n!files/nls/ui-strings","acplugins/signatures/js/templates/signatures-files-header-template.html","acplugins/signatures/js/utils/sign-workflow-utils"],function(e,i,t,s,n,o){t.SignaturesFilesHeaderView=e.View.extend({events:{},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(o),this._addUiModelEventListeners(),this._addKeyEventListener(),this._addFocusEventListener()},render:function(){if(e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({workflowName:s.AGREEMENT_HEADER})),this._initWrappers()),this.options.isInSearchResultsView){var i=this.options,t=i.searchModel.get("total_hits");if(_.isUndefined(t))this.$signaureWorkflowName.text(s.AGREEMENT_HEADER);else{var o=_.template(n.SEARCH_HEADER,{label:s.AGREEMENT_HEADER,count:t});this.$signaureWorkflowName.text(o),this.$signaureWorkflowName.attr("title",o),this.$signaureWorkflowName.attr("aria-label",_.template(this.options.searchUiModel.getHeaderAriaLabel(),{category:s.AGREEMENT_HEADER,count:t}))}}return this},_initWrappers:function(){this.$listViewBtn=this.$(".shared-workflow-header-btn.listView"),this.$thumbnailViewBtn=this.$(".shared-workflow-header-btn.thumbnailView"),this.$listingToggleButtons=this.$(".signatures-files-header-item.shared-header-listing-btns"),this.$mainHeader=this.$(".signatures-files-main-header"),this.$signaureWorkflowName=this.$(".signature-workflow-name"),this.options.isInSearchResultsView&&(this.$mainHeader.addClass("uss-search-active"),this.$thumbnailViewBtn.hide(),this.$listViewBtn.hide(),this.$listingToggleButtons.hide())},_addUiModelEventListeners:function(){var e=this.options,i=e.appApi.pluginsApi.getPluginsUiModel(e.pluginId);this.listenTo(e.selectionUiModel,"change:selected_item_models",this._onSelectedItemModelsChange),e.isInSearchResultsView&&(this.listenTo(e.searchModel,"change:total_hits",this.render),this.listenTo(i,"change:selected_searched_plugin_id",this._searchPluginChanged))},_searchPluginChanged:function(e,i){"search_summary"===i?this.$el.show():this.$el.hide()},_onListViewButtonClick:function(){this.$thumbnailViewBtn.removeClass("button-selected"),this.$listViewBtn.addClass("button-selected"),this.options.collectionsUiModel.set("view","list")},_onThumbnailViewButtonClick:function(){this.$thumbnailViewBtn.addClass("button-selected"),this.$listViewBtn.removeClass("button-selected"),this.options.collectionsUiModel.set("view","thumbnail")},_onSelectedItemModelsChange:function(e){var i=this.options,t=(this.$header,this.$body,this.$rhp,i.appApi);i.noSelectionActions||t.acrobatApi.isInAcrobat()||(e.isItemSelected()?this.$mainHeader.addClass("with-rhp"):this.$mainHeader.removeClass("with-rhp"))},_updateButtonSelectionState:function(){this.options.parcelCollection&&(0==this.options.parcelCollection.length?this.$listingToggleButtons.hide():this.$listingToggleButtons.show());var e=this.options.collectionsUiModel.get("view");"list"==e?(this.$thumbnailViewBtn.removeClass("button-selected"),this.$listViewBtn.addClass("button-selected")):"thumbnail"==e&&(this.$thumbnailViewBtn.addClass("button-selected"),this.$listViewBtn.removeClass("button-selected"))}})}),define("acplugins/signatures/js/templates/sent-files-body-template.html",[],function(){return'<div class="parcels"></div>    <div class="parcels-search-results"></div>    <div class="parcel-hover-details"></div>'}),define("acplugins/signatures/js/templates/parcels-template.html",[],function(){return'<div class="parcels-content signature-parcels-content ui-theme theme-container"></div>    <div class="parcels-no-content"></div>	<div class="parcel-redirect-web"></div>'}),define("acplugins/uss-search/js/ac-uss-search",["plugins-common/ac-plugins"],function(e){var i=e.USSSearch;return i||(e.USSSearch=i={}),i.PLUGIN_ID||(i.PLUGIN_ID="uss_search"),i}),define("acplugins/signatures/js/templates/parcels-collection-template.html",[],function(){return'<div role="toolbar" class="selection-actions ui-theme theme-container"></div><div role="group"     aria-labelledby="<%= pluginSelectorId %>"     aria-multiselectable="true">    <div role="row" class="agreement-header shared-workflow-files-header ui-theme theme-container theme-file-list-row-border"></div>    <div role="presentation" tabindex="-1"         class="signature-collection-items shared-collection-items with-header">    </div>    <div role="presentation" class="collection-footer"></div></div>'}),define("acplugins/signatures/js/models/ui/parcels-list-item-ui-model",["core/ac-core","acplugins/signatures/js/ac-signature","core/models/ui/ui-model"],function(e,i){i.ParcelsListItemUiModel=e.CollectionItemUiModel.extend({recognized:{expanded:{type:"boolean",optional:!1},masked:{type:"boolean",optional:!1},selected:{type:"boolean",optional:!1}},defaults:{expanded:!1,masked:!1,selected:!1}})}),define("acplugins/signatures/js/templates/parcels-list-file-template.html",[],function(){return'<div role="row" class="signature-list-item-file" data-id="<%= fileId %>"        aria-selected="false" aria-level="2">    <div role="gridcell"></div>    <div role="gridcell">        <div role="img"             aria-label="<%= iconDesc %>"             class="collection-item-thumb <%= iconCls %> signature-list-item-file-icon"></div>        <a class="signature-list-item-file-name theme-list-item-text"           tabindex="-1"><%- filename %></a>    </div>    <div role="gridcell"></div>    <div role="gridcell"></div>    <div role="gridcell"></div>    <div role="gridcell"></div></div>'}),define("acplugins/signatures/js/templates/parcels-list-item-template.html",[],function(){return'<div id="fullItem-<%=viewId%>" role="<%= itemRole %>" class="signature-list-item shared-workflow-list-item theme-list-item-row theme-file-list-row-border shared-file-list-text-color">    <div role="row" class="shared-list-item-row shared-theme-list-item-row" aria-selected="false">        <div role="gridcell">            <div class="list-item-checkbox" style="display:none;"                 tabindex="-1"                 aria-checked="false"                 aria-labelledby="list-item-file-name-<%= viewId %>" id="list-item-checkbox-<%= viewId %>">            </div>        </div>        <div role="presentation"             class="agreement-list-item-info-container shared-list-item-info-container">            <div role="rowheader">                <div class="signature-list-preview-img-cn shared-list-preview-img-cn theme-file-list-row-border" id="signature-list-preview-img-cn-<%= viewId %>">                   <div role="img" aria-label="<%= iconDesc %>"                     aria-hidden="true"                     class="collection-item-thumb <%= iconCls %>                            signature-list-item-icon shared-list-item-icon" id="signature-list-item-icon-<%= viewId %>"></div>                <img class="signature-list-preview-image shared-list-preview-image centered-vertically" id="signature-list-preview-image-<%= viewId %>" style="display: none;" alt=""  src=""/>                </div>                <div class="list-item-file-name"                     id="list-item-file-name-<%= viewId %>"                    <%- numFiles %>                </div>            </div>            <div role="gridcell" class="list-item-sender" id="list-item-sender-<%= viewId %>">               <div id="list-item-sender-name-<%= viewId %>"><%= senderName %></div>               <div id="list-item-sender-company-<%= viewId %>" style="display:none;"><%= senderCompany %></div>            </div>            <div role="gridcell" class="list-item-modified-date"                 id="list-item-modified-date-<%= viewId %>">               <%= itemDate %></div>            <div role="gridcell" class="list-item-status"                 id="list-item-status-<%= viewId %>">               <%= status %></div>        </div>    </div>    <div role="presentation" class="signature-list-item-files"></div>    <div role="presentation" class="signature-list-item-mask"></div></div>'
}),define("acplugins/signatures/js/views/parcels-list-item-view",["core/ac-core","acplugins/signatures/js/ac-signature","core/utils/view-util","core/utils/css-util","core/utils/date-util","core/utils/file-types","core/utils/truncate","acplugins/signatures/js/templates/parcels-list-file-template.html","acplugins/signatures/js/templates/parcels-list-item-template.html","i18n!acplugins/signatures/js/nls/ui-strings","core/models/workflow-status-strings","acplugins/signatures/js/utils/sc-constants"],function(e,i,t,s,n,o,a,r,l,c,d,p){i.ParcelsListItemView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(l),this._fileTemplate=_.template(r),this._addUiModelEventListeners()},render:function(i,t){var s,n,o,a,r,l=this.options.model.get("resources"),c=this.model.id,d=this._getSenderCompany().toUpperCase();if(e.View.prototype.render.call(this),this.$item?(i?i.data("id")!==c&&(this.$item=this.$item.clone(),i.replaceWith(this.$item.get(0)),this._initWrappers()):this.$el.append(this.$item.get(0)),this.invalidate()):(1===l.length?(s="s_agreementfiletype",n=this._getIconDesc(l[0]),o="presentation"):(s="file-icon-multifile signature-list-item-icon-hitarea",n="",o="rowgroup"),a=c,r=$(this._template({iconCls:s,iconDesc:n,numFiles:this._getNumFiles(),itemDate:this._getDateSent(),senderName:this._getSenderName(),senderCompany:d,people:this._getRecipients(),status:this._getStatus(),viewId:a,modelId:c,itemRole:o})),e.Util.isCEF()?1===l.length?r.find("[role='row']:first").addClass("signature-list-item-row").attr({"aria-label":this._getNumFiles()+", "+this._getDateSent()+", "+this._getSenderName()+" "+d+", "+this._getStatus(),tabindex:"-1"}):r.addClass("signature-list-item-row").attr({"aria-expanded":"false","aria-label":this._getParcelAriaLabel(l.length)+", "+this._getDateSent()+", "+this._getSenderName()+" "+d+", "+this._getStatus(),"aria-level":"1","aria-selected":"false",tabindex:"-1"}):1===l.length?r.find("[role='row']:first").addClass("signature-list-item-row").attr({"aria-labelledby":"list-item-file-name-"+a,tabindex:"-1"}):r.addClass("signature-list-item-row").attr({"aria-expanded":"false","aria-labelledby":"list-item-file-name-"+a+" list-item-modified-date-"+a,"aria-level":"1","aria-selected":"false",tabindex:"-1"}),n.length&&r.find(".collection-item-thumb:first").removeAttr("aria-hidden"),i?i.replaceWith(r):this.$el.append(r),this.$item=this.$el.children().eq(t),this._initWrappers()),this.$item.data("id",c),e.Util.isCEF()){this.$item.find(".list-item-modified-date").addClass("desktop"),this.$item.find(".list-item-sender").addClass("desktop"),this.$item.find(".signature-list-item-file-name").addClass("desktop");var p=this._calcVisibilityBasedOnFilter();p?this.$item.show():this.$item.hide();var h="[RS LISTING] "+this.model.id+" visiblity is "+p;this.options.appApi.acroLogApi.ACRO_DEBUG(h)}return this._initWrappers(),this._updateFields(),d&&(this.$senderName.addClass("list-item-top-level"),this.$senderCompany.addClass("list-item-bottom-level"),this.$senderCompany.show()),e.Util.isCEF()&&this._updateForVerticalScrollBar(),this._setSignButtonTextAndVisibility(),this._onViewChange(this.options.collectionsUiModel),this._showThumbnail(null,!1),this},_calcVisibilityBasedOnFilter:function(){if(this.options.isInSearchResultsView===!0)return!0;var e=this.options.parcelCollection.leftRailFilter;if(i.SignWorkflowUtil.isNativeRSLeftRailID(e)===!1)return!0;var t=this.model.get("signature_info").state,s=i.SignWorkflowUtil.convertToNativeRSState(t);return e===p.ALL||e===s?!0:!1},_getParcelAriaLabel:function(e){return _.template(c.GENERIC_ARIA_LABEL_STRING,{prefix:e,suffix:c.FILES})},_updateForVerticalScrollBar:function(){setTimeout(_.bind(function(){this.$el.length&&this.options.collectionUiModel.set("has_vertical_scrollbar",t.isVerticalScrollBarPresent(this.$el))},this),150)},remove:function(){this.$item.remove()},getViewElement:function(){return this.$item},invalidate:function(){e.View.prototype.invalidate.call(this)},expand:function(){this.options.itemUiModel.set("expanded",!0)},collapse:function(){this.options.itemUiModel.set("expanded",!1)},isExpanded:function(){return this.options.itemUiModel.get("expanded")},stopListening:function(i,t,s){e.View.prototype.stopListening.call(this,i,t,s)},_initWrappers:function(){this.$expandBtn=this.$item.find(".signature-list-item-expand-btn"),this.$expandHitArea=this.$item.find(".signature-list-item-expand-hitarea"),this.$iconHitArea=this.$item.find(".signature-list-item-icon-hitarea"),this.$infoContainer=this.$item.find(".agreement-list-item-info-container"),this.$files=this.$item.find(".signature-list-item-files"),this.$checkbox=this.$item.find("#list-item-checkbox-"+this.model.id),this.$fileName=this.$item.find("#signature-list-item-file-name-"+this.model.id),this.$numFiles=this.$item.find("#list-item-file-name-"+this.model.id),this.$itemDate=this.$item.find("#list-item-modified-date-"+this.model.id),this.$sender=this.$item.find("#list-item-sender-"+this.model.id),this.$senderName=this.$item.find("#list-item-sender-name-"+this.model.id),this.$senderCompany=this.$item.find("#list-item-sender-company-"+this.model.id),this.$people=this.$item.find("#list-item-people-"+this.model.id),this.$status=this.$item.find("#list-item-status-"+this.model.id),this.$itemRow=this.$item.find(".signature-list-item-row"),this.$parcelItemIcon=this.$item.find("#signature-list-item-icon-"+this.model.id),this.$multiFileIcon=this.$item.find(".file-icon-multifile"),this.$parcelNumFiles=this.$item.find("#list-item-file-name-"+this.model.id),this.$actionButton=this.$item.find("#signature-list-item-action-button-"+this.model.id),this.$preview=this.$("#signature-list-preview-image-"+this.model.id),this.$previewCn=this.$("#signature-list-preview-img-cn-"+this.model.id),this.$tripleDot=this.$("#signature-list-item-triple-dot-"+this.model.id)},_getNumFiles:function(){var e,i=this.model.get("resources");return e=i?1===i.length?i[0].name:_.template(c.SENT_FILES_NUM_FILES,{numFiles:i.length}):0},_getEmailSubject:function(){return this.model.get("signature_info").intro_message},_getRecipients:function(){var e=0,i=0;if(this.model.get("signature_info").state===d.ARCHIVED){var t=this.options.model.get("participants");t.length>0?(e=t.length,i=t.length):(e=1,i=1)}_.each(this.options.model.get("participants"),function(t){"SHARE"!=t.role&&(e++,(-1!=$.inArray(t.status,[d.WAITING_FOR_OTHERS,d.SIGNED,d.COMPLETED,d.APPROVED,d.DELIVERED,d.ACCEPTED,d.FORM_FILLED])||t.status.startsWith("OUT_FOR_"))&&i++)},this);var s=_.template(c.PARTIAL_COMPLETE.toLowerCase(),{done:i,total:e});return s},_getDateSent:function(){var e=this.model.get("create_date"),i=this.options.isInSearchResultsView?void 0:"YYMMDDHHmmssZ";return n.formatDateWithFormat(e,i,!1)},_getDateModified:function(){var e=this.model.get("modify_date"),i=this.options.isInSearchResultsView?void 0:"YYMMDDHHmmssZ";return n.formatDateWithFormat(e,i,!1)},_getSenderName:function(){var e=this.model.getSenderName();return e?e:"-"},_getSenderCompany:function(){return this.model.get("signature_info").company},_getStatus:function(){var e=this.model.get("signature_info").state,i="-",t=!1;return e==d.SIGNED||e==d.APPROVED||e==d.DELIVERED||e==d.ACCEPTED||e==d.FORM_FILLED||e==d.ARCHIVED?i=c.COMPLETED:e==d.WAITING_FOR_MY_SIGNATURE||e==d.WAITING_FOR_MY_APPROVAL||e==d.WAITING_FOR_MY_DELEGATION||e==d.WAITING_FOR_MY_ACKNOWLEDGEMENT||e==d.WAITING_FOR_MY_ACCEPTANCE||e==d.WAITING_FOR_MY_FORM_FILLING?(i=c.WAITING_FOR_YOU,t=!0):e==d.OUT_FOR_SIGNATURE||e==d.OUT_FOR_APPROVAL||e==d.OUT_FOR_DELIVERY||e==d.OUT_FOR_ACCEPTANCE||e==d.OUT_FOR_FORM_FILLING?i=c.WAITING_FOR_OTHERS:e==d.CANCELLED?(i=c.CANCELLED_DECLINED,t=!0):e==d.EXPIRED?(i=c.EXPIRED,t=!0):e==d.DRAFT||e==d.WAITING_FOR_AUTHORING?(i=c.DRAFT,t=!0):e==d.LIBRARY_TEMPLATE&&(i=c.ACTIVE,t=!0),t?i:this._getRecipients()},_getIconClass:function(e){var i,t=o.getFileInfo(e.type||"",e.name);return i=t.iconCls||""},_getIconDesc:function(e){var i,t=o.getFileInfo(e.type||"",e.name);return i=t.desc||""},_getNumHits:function(){return this.model.getNumHits()},_updateExpandButtonVisibility:function(){var e=this.model.get("resources").length;e>1&&(this.$expandBtn.addClass("shown"),this.$expandHitArea.removeAttr("aria-hidden disabled").prop("disabled",!1))},_setSignButtonTextAndVisibility:function(){var e=this.$actionButton;if("thumbnail"==this.options.collectionsUiModel.get("view"))return void e.hide();var i=this.options.model,t=i.getWorkflowStatus(),s=!1,n="";t==d.WAITING_FOR_MY_SIGNATURE?(n=c.SIGN,s=!0):t==d.WAITING_FOR_MY_APPROVAL?(n=c.APRROVE,s=!0):t==d.WAITING_FOR_MY_DELEGATION?(n=c.DELEGATE,s=!0):t==d.WAITING_FOR_MY_ACKNOWLEDGEMENT?(n=c.ACKNOWLEDGE,s=!0):t==d.WAITING_FOR_MY_ACCEPTANCE?(n=c.ACCEPT,s=!0):t==d.WAITING_FOR_MY_FORM_FILLING?(n=c.FILL_FORM,s=!0):s=!1,s?(e.text(n),e.attr("title",n),e.show()):e.hide()},_updateFields:function(){{var i=this.model.id,t=this.$numFiles;this.$infoContainer}t.attr("href")&&-1!==t.attr("href").indexOf(i)||t.attr("href","/sentfiles/"+i),e.Util.isCEF()&&this.$fileName.addClass("desktop");var s=this._getDateSent(),n=this._getSenderName(),o=this._getSenderCompany(),a=this._getRecipients(),r=this._getStatus(),l=this._getNumFiles();if(this.$itemDate.text(s),this.$itemDate.attr("title",s),this.$people.text(a),this.$people.attr("title",a),this.$status.text(r),this.$status.attr("title",r),this.$numFiles.attr("title",l),this.options.isInSearchResultsView){var c=this.options.searchUiModel.get("mru_query_regex");l=l.replace(c,function(e){return"<b>"+e+"</b>"}),this.$numFiles.html(l)}else this.$numFiles.text(l);this.$senderName.text(n),o?(this.$senderCompany.text(o),this.$sender.attr("title",n+"\n"+o)):this.$sender.attr("title",n)},onExpandButtonClick:function(i){var t=this.model.get("resources");this._consumeEvent(i),t.length<2||(this.isExpanded()?this.collapse():this.expand(),e.Util.isCEF()&&this._updateForVerticalScrollBar())},_onExpandedChange:function(e,i){this._showFileList(i)},_addUiModelEventListeners:function(){var e=this.options.itemUiModel;this.listenTo(e,"change:expanded",this._onExpandedChange).listenTo(e,"change:selected",this._onUiModelSelectedChange).listenTo(this.options.collectionsUiModel,"change:view",this._onViewChange).listenTo(this.options.collectionsUiModel,"change:rhpShown",this._adjustLayout).listenTo(this.options.collectionUiModel,"change:has_vertical_scrollbar",this._adjustLayout),this.options.appApi.windowApi.addWindowResizeCallback(_.bind(this._adjustLayout))},_onUiModelSelectedChange:function(){this._updateSelectionStatus()},_showFileList:function(e){this.render(this.$item),e?this.$files.slideDown("fast"):this.$files.slideUp("fast")},_updateSelectionStatus:function(){var i=this.$item,n=this.$checkbox,o=this.$tripleDot,a=this.model.get("resources").length>1,r=a?i:this.$itemRow,l=r.find("[aria-selected]").addBack();this.options.itemUiModel.get("selected")?(s.addClass(i,"selected"),s.addClass(n,"selected"),s.addClass(o,"selected"),l.attr("aria-selected",!0),n.attr("aria-checked",!0)):(s.removeClass(i,"selected"),s.removeClass(n,"selected"),s.removeClass(o,"selected"),l.attr("aria-selected",!1),n.attr("aria-checked",!1)),e.Util.isIE8()&&t.detachAndReattachElement(n)},_loadThumbnail:function(){if(this.model){var e=null;if(this.model.get("thumbnailUrl"))e=this.model.get("thumbnailUrl"),this._showThumbnail(e,!0);else if(0==this.model.get("thumbFetchSucces",!1))this._showThumbnail(e,!1);else{var t=i.opFactory.create("GetSignAgreementThumbnailOp",this.options).run(this.model.id);t.then(_.bind(function(i){i&&i.FIXED_WIDTH_250px?(e=i.FIXED_WIDTH_250px,this._showThumbnail(e,!0),this.model.set("thumbnailUrl",e),this.model.set("thumbFetchSucces",!0)):(this._showThumbnail(e,!1),this.model.set("thumbFetchSucces",!1))},this),function(){}),this.model.set("thumbFetchSucces",!1)&&this._showThumbnail(e,!1)}}},_showThumbnail:function(e,i){var t="#signature-list-preview-image-"+this.model.id,s=this.$(t),n="#signature-list-item-icon-"+this.model.id,o=this.$(n);s.attr("src",e),i?(s.show(),o.hide()):(s.hide(),o.show())},_onViewChange:function(e){var i=e.get("view");"list"==i?(this.$itemDate.removeClass("shared-thumb-view"),this.$sender.removeClass("shared-thumb-view"),this.$people.removeClass("shared-thumb-view"),this.$status.removeClass("shared-thumb-view"),this.$preview.removeClass("shared-thumb-view"),this.$item.removeClass("shared-thumb-view"),this.$item.addClass("theme-list-item-row theme-file-list-row-border"),this.$previewCn.removeClass("shared-thumb-view theme-file-preview-background theme-grid-view-border"),this.$infoContainer.removeClass("shared-thumb-view"),this._setSignButtonTextAndVisibility()):"thumbnail"==i&&(this.$itemDate.addClass("shared-thumb-view"),this.$sender.addClass("shared-thumb-view"),this.$people.addClass("shared-thumb-view"),this.$status.addClass("shared-thumb-view"),this.$preview.addClass("shared-thumb-view"),this.$item.addClass("shared-thumb-view"),this.$item.removeClass("theme-list-item-row theme-file-list-row-border"),this.$previewCn.addClass("shared-thumb-view theme-file-preview-background theme-grid-view-border"),this.$infoContainer.addClass("shared-thumb-view "),this._setSignButtonTextAndVisibility()),this._adjustLayout()},_updateVisibilityOfColumns:function(e,i){var t=i.colMargin,s=this.$numFiles.position().left,n=i.totalVisibleCols,o=e-s,a=o-t*n,r=i.totalFluidCols,l=a/r;if(1==i.fileName.visibility){var c=i.fileName.end-i.fileName.start+1;this.$numFiles.css("width",l*c+"px"),this.$numFiles.css("margin-right",t+"px"),this.$numFiles.show()}else this.$numFiles.hide();if(1==i.lastActivity.visibility){var c=i.lastActivity.end-i.lastActivity.start+1,d=i.lastActivity.colNumber;this.$itemDate.css("left",s+l*(i.lastActivity.start-1)+t*d+"px"),this.$itemDate.css("width",l*c+"px"),this.$itemDate.css("margin-right",t+"px"),this.$itemDate.show()}else this.$itemDate.hide();if(1==i.owner.visibility){var c=i.owner.end-i.owner.start+1,d=i.owner.colNumber;this.$sender.css("left",s+l*(i.owner.start-1)+t*d+"px"),this.$sender.css("width",l*c+"px"),this.$sender.css("margin-right",t+"px"),this.$sender.show()}else this.$sender.hide();if(1==i.status.visibility){var c=i.status.end-i.status.start+1,d=i.status.colNumber;this.$status.css("left",s+l*(i.status.start-1)+t*d+"px"),this.$status.css("width",l*c+"px"),this.$status.css("margin-right",t+"px"),this.$status.show()}else this.$status.hide()},_adjustLayout:function(){if(this.$el.is(":visible")){var e=this.options.collectionsUiModel.get("view");if(this.$numFiles.removeAttr("style"),this.$itemDate.removeAttr("style"),this.$sender.removeAttr("style"),this.$status.removeAttr("style"),this.$tripleDot.removeAttr("style"),this.$tripleDot.hide(),"list"==e){var i=this.$item.width();100>=i?this._updateVisibilityOfColumns(i,{fileName:{visibility:!1},lastActivity:{visibility:!1},owner:{visibility:!1},status:{visibility:!1},totalFluidCols:0,totalVisibleCols:0,colMargin:24}):i>100&&300>=i?this._updateVisibilityOfColumns(i,{fileName:{visibility:!0,colNumber:0,start:1,end:1},lastActivity:{visibility:!1},owner:{visibility:!1},status:{visibility:!1},totalFluidCols:1,totalVisibleCols:1,colMargin:24}):i>300&&500>=i?this._updateVisibilityOfColumns(i,{fileName:{visibility:!0,colNumber:0,start:1,end:3},lastActivity:{visibility:!1},owner:{visibility:!1},status:{visibility:!0,colNumber:1,start:4,end:5},totalFluidCols:5,totalVisibleCols:2,colMargin:24}):i>500&&700>=i?this._updateVisibilityOfColumns(i,{fileName:{visibility:!0,colNumber:0,start:1,end:3},lastActivity:{visibility:!1},owner:{visibility:!0,colNumber:1,start:4,end:5},status:{visibility:!0,colNumber:2,start:6,end:7},totalFluidCols:7,totalVisibleCols:3,colMargin:32}):this._updateVisibilityOfColumns(i,{fileName:{visibility:!0,colNumber:0,start:1,end:3},lastActivity:{visibility:!0,colNumber:1,start:4,end:5},owner:{visibility:!0,colNumber:2,start:6,end:7},status:{visibility:!0,colNumber:3,start:8,end:9},totalFluidCols:9,totalVisibleCols:4,colMargin:32})}else if("thumbnail"==e){var i=this.$el.width();if(i){var t=parseInt($(".shared-workflow-files-body").css("marginLeft")),s=$(".shared-thumb-view .shared-workflow-list-item").width(),n=24,o=Math.floor((i-t)/(s+n)),a=(i-t-s*o)/o;$(".shared-thumb-view .shared-workflow-list-item").css("marginRight",a+"px")}}}}})}),define("acplugins/signatures/js/ops/manipulation/unshare-one-if-confirmed-op",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!acplugins/signatures/js/nls/ui-strings","i18n!core/nls/ui-strings","core/ops/op"],function(e,i,t,s){i.UnshareOneIfConfirmedOp=e.Op.extend({run:function(){var e,n,o,a=this.options,r=a.appApi.dialogApi;return e=t.CONFIRM_UNSHARE_MSG_ONE_ITEM,n=t.CONFIRM_UNSHARE_TITLE,r.displayTextAlert(r.SEVERITY_WARNING,n,e,t.UNSHARE,s.CANCEL).then(function(){o=new i.UnshareOneParcelOp(a),o.run()})}})}),define("acplugins/signatures/js/templates/parcel-activity-template.html",[],function(){return'<div role="dialog" tabindex="-1" aria-label="<%- header %>" class="parcel-activity-dlg generic-dialog">        <div role="presentation" class="parcel-activity-dlg-content">            <div role="presentation" class="dialog-title-bar">                <div role="heading" class="dialog-title">                    <%= header %>                </div>            </div>            <div role="grid" class="parcel-table-container">                <div role="row" class="parcel-activity-table-header collection-header">                    <div role="columnheader" class="collection-header-column-title parcel-recipient-col parcel-activity-nosort"><%= recipient %></div>                    <div role="columnheader" class="collection-header-column-title parcel-activity-col parcel-activity-nosort"><%= activity %></div>                    <div role="columnheader" class="collection-header-column-title parcel-item-col parcel-activity-nosort"><%= item %></div>                    <button role="columnheader" tabindex="0" aria-sort="descending" class="collection-header-column-title parcel-date-col parcel-date-col-header"><%= dateViewed %>                    <div class="collection-header-column-sort descending parcel-activity-sort-btn" data-test-name="parcel-activity-date-sort"></div>                    </button>                </div>                <div role="presentation" class="parcel-activity-body"></div>            </div>            <button class="parcel-activity-close-btn control-button ui-theme theme-text button-grey"><%= close %></button>        </div>    </div>'}),define("acplugins/signatures/js/templates/parcel-activity-item-template.html",[],function(){return'<div role="row" class="parcel-activity-item-row collection-item">        <div role="gridcell" class="parcel-activity-item-recipient parcel-recipient-col"><%= email %></div>            <div role="gridcell" class="parcel-activity-item-what parcel-activity-col"><%= what %></div>        <div role="gridcell" class="parcel-activity-item-item parcel-item-col">            <div role="img" aria-label="<%= iconDesc %>"<% if (!iconDesc.length) { %>                 aria-hidden="true"<% } %>                 class="collection-item-thumb <%= iconCls %>"></div>            <div class="parcel-activity-item-filename"><%= filename %></div>        </div>        <div role="gridcell" class="parcel-activity-item-date parcel-date-col"><%= date %></div>    </div>'}),define("acplugins/signatures/js/collections/fileviewevent-collection",["acplugins/signatures/js/ac-signature","core/utils/http-util"],function(e,i){e.FileViewEventCollection=Backbone.Collection.extend({initialize:function(e,i){Backbone.Collection.prototype.initialize.call(this,e,i),this.parcel_id=i.parcel_id,this.rootUrl=i.rootUrl},url:function(){return this.rootUrl+"/a/api/parcels/"+this.parcel_id+"/file_view_events"},fetch:function(e){return e=e||{},e=i.customizeOptions("GET",e),Backbone.Collection.prototype.fetch.call(this,e)},parse:function(e){return e.events}})}),define("acplugins/signatures/js/views/parcel-activity-dlg",["core/ac-core","core/utils/date-util","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/parcel-activity-template.html","acplugins/signatures/js/templates/parcel-activity-item-template.html","core/utils/file-types","core/utils/truncate","i18n!acplugins/signatures/js/nls/ui-strings","acplugins/signatures/js/utils/sc-constants","acplugins/signatures/js/utils/ts-utils","core/utils/util","acplugins/signatures/js/collections/fileviewevent-collection"],function(e,i,t,s,n,o,a,r,l,c,d){t.ParcelActivityDlg=e.DialogView.extend({PAGE_SIZE:25,_page_num:0,_sort_order:"desc",_no_more_events:!1,_prev_scrolltop:0,_what_map:{parcel_view:r.PARCEL_ACTIVITY_PREVIEWED,download:r.PARCEL_ACTIVITY_DOWNLOADED},events:{"click .parcel-activity-close-btn":"_onCloseBtnClick","click .parcel-date-col-header":"_onSortClick"},initialize:function(){var i,o,a,d=this.options,p=this.options.parcelModel.get("parcel_id"),h={},u={};o=this.options.appApi.baseFilesUrisApi.getSendApiUri(),o=c.extractRootUrl(o),i={parcel_id:p,comparator:!1,rootUrl:o},e.DialogView.prototype.initialize.call(this),this._fileviewevent_collection=new t.FileViewEventCollection([],i),d.parcelModel.set("fileviewevents",this._fileviewevent_collection),this._template=_.template(s),this._itemTemplate=_.template(n),e.View.prototype.initialize.call(this),_.each(d.parcelModel.get("invitations"),function(e){h[e.invitation_id]="PARCEL_PUBLIC_SHARING"===e.recipient_email?r.PARCEL_ACTIVITY_PUBLIC_VISITOR:_.escape(e.recipient_email)},this),this._inv_emails=h,_.each(d.parcelModel.get("files"),function(e){e.icon_class=this._getIconClass(e),e.icon_desc=this._getIconDesc(e),u[e.id]=e},this),this._files_by_id=u,a=d.parcelAssetsCollection&&d.parcelAssetsCollection.length>1?l.MULTI:l.SINGLE,d.appApi.siteCatalystApi.logScEvent([l.PREVIEW,l.SHARED,a,l.FULL_ACTIVITY,l.SHOWN])},render:function(){e.DialogView.prototype.render.call(this),this.$el.html(this._template({header:_.template(r.PARCEL_ACTIVITY_HEADING,{emailSubject:_.escape(this.options.parcelModel.get("email_subject"))}),recipient:r.PARCEL_ACTIVITY_RECIPIENT,activity:r.PARCEL_ACTIVITY_ACTIVITY,item:r.PARCEL_ACTIVITY_ITEM,dateViewed:r.PARCEL_ACTIVITY_DATE_VIEWED,close:r.PARCEL_ACTIVITY_CLOSE})),this.$body=this.$(".parcel-activity-body"),this.loadEvents(_.bind(function(e){this._checkLimit(e.length),this.displayEvents(e),this.$body.scrollTop(0)},this),!1),this.$body.scroll(_.bind(function(){this._checkScroll()},this)),this._initWrappers(),this._invalidateSize(),this._initTabLimits(),this.$el.find(":focusable:first").focus()},loadEvents:function(e,i){this.isLoading=!0,this._fileviewevent_collection.fetch({data:{sort:"created!"+this._sort_order,page:this._page_num,max:this.PAGE_SIZE},reset:i,success:e})},displayEvents:function(e){_.each(e.models,function(e){var t,s,n,o,a=e.get("event_type"),l=e.get("file_id"),c="hidden",d="";"parcel_view"===a?(n=this.options.parcelModel.get("files"),1===n.length?(s=this._files_by_id[n[0].id],o=s.name,c=s.icon_class,d=s.icon_desc):(o=r.PARCEL_ACTIVITY_ALL_FILES_PREVIEW,c="file-icon-multifile")):"all"===l?(o=r.PARCEL_ACTIVITY_ALL_FILES,c="file-icon-multifile"):(s=this._files_by_id[l],o=s?s.name:"",c=s?s.icon_class:"hidden",d=s?s.icon_desc:""),t=this._itemTemplate({filename:o,iconCls:c,iconDesc:d,what:this._what_map[a],email:this._inv_emails[e.get("invitation_id")],date:i.formatDate(e.get("created"))}),this.$body.append(t)},this),_.each(this.$(".parcel-recipient-col"),function(e){var i=$(e);a.truncateElementText(i)}),_.each(this.$(".parcel-activity-item-filename"),function(e){var i=$(e);a.truncateElementText(i)}),this.isLoading=!1},close:function(i,t){var s;s=this.options.parcelAssetsCollection&&this.options.parcelAssetsCollection.length>1?l.MULTI:l.SINGLE,this.options.appApi.siteCatalystApi.logScEvent([l.PREVIEW,l.SHARED,s,l.FULL_ACTIVITY,l.CLOSE]),e.DialogView.prototype.close.call(this,i,t)},_initWrappers:function(){e.DialogView.prototype._initWrappers.call(this),this.$body=this.$(".parcel-activity-body")},_onSortClick:function(){var e,i=this.options;this._sort_order="asc"===this._sort_order?"desc":"asc",this._page_num=0,this._no_more_events=!1,this.loadEvents(_.bind(function(e){var i=this.$(".parcel-activity-sort-btn"),t=this.$(".parcel-date-col-header");this.$body.empty(),this._checkLimit(e.length),this.displayEvents(e),this.$body.scrollTop(0),"asc"===this._sort_order?(i.removeClass("descending"),t.attr("aria-sort","ascending")):(i.addClass("descending"),t.attr("aria-sort","descending"))},this),!0),e=i.parcelAssetsCollection&&i.parcelAssetsCollection.length>1?l.MULTI:l.SINGLE,i.appApi.siteCatalystApi.logScEvent([l.PREVIEW,l.SHARED,e,l.FULL_ACTIVITY,l.SORT,l.DATE_VIEWED])},_checkLimit:function(e){e<this.PAGE_SIZE&&(this._no_more_events=!0)},_checkScroll:function(){var e=100,i=this.$body.height(),t=this.$body.get(0).scrollHeight,s=this.$body.scrollTop(),n=this._prev_scrolltop;this._prev_scrolltop=s,!this._no_more_events&&s>n&&!this.isLoading&&+s+i+e>t&&(this._page_num+=1,this.loadEvents(_.bind(function(e){this._checkLimit(e.length),this.displayEvents(e)},this),!1))},_getIconClass:function(e){var i,t=o.getFileInfo(e.content_type||"",e.name);return i=t.iconCls||""},_getIconDesc:function(e){var i,t=o.getFileInfo(e.content_type||"",e.name);return i=t.desc||""},_setupSizedElement:function(e){var i=this.$(e);i.attr("data-title")?i.text(i.attr("data-title")):i.attr({"data-title":i.text()}),a.truncateElementText(i)},_invalidateSize:function(){this._setupSizedElement(".dialog-title"),this._center(),this._showModalMask(!0)},_addAppApiCallbacks:function(){e.DialogView.prototype._addAppApiCallbacks.call(this),d.isIE8()||this.options.appApi.windowApi.addWindowResizeCallback(this._onWindowResize)},_removeAppApiCallbacks:function(){e.DialogView.prototype._removeAppApiCallbacks.call(this),d.isIE8()||this.options.appApi.windowApi.removeWindowResizeCallback(this._onWindowResize)},_onWindowResize:function(){this.render()}})}),define("acplugins/tracked-send/js/tool/ac-tracked-send",["plugins-common/ac-plugins"],function(e){e.TrackedSend||(e.TrackedSend={});var i=e.TrackedSend.Tool;return i||(i=e.TrackedSend.Tool={}),i.PLUGIN_ID||(i.PLUGIN_ID="send"),i}),define("viewer/templates/viewer-page-template.html",[],function(){return'<div class="page-main-container">        <div class="page-error error"></div>        <div class="page-body-container parcel-container">            <div class="page-body thumbnails">                <div class="parcel-body-header">                    <div class="full-preview-home-btn-wrapper">                        <button class="full-preview-home-btn parcel-preview-home-btn"                                id="full-preview-header-home-btn"                                title="<%= back %>">                            <span class="hidden-accessible"><%= back %></span>                        </button>                        <div class="full-preview-home-btn-separator"></div>                        <div class="toolbar-item plugin-selector">                            <div class="toolbar-item-icon-container">                                <div class="toolbar-item-icon back-toolbar-icon parcel-preview-home-btn"></div>                            </div>                            <div class="toolbar-item-label"></div>                        </div>                    </div>                    <div class="full-preview-branding-logo wrap-branding-logo"><div class="branding-logo parcel-branding-logo"></div></div>                    <div class="full-preview-name parcel-subject" id="parcel-subject" role="heading" aria-level="1"><%= parcelSubject %></div>                    <div class="parcel-action-buttons">                        <button class="toolbar-item plugin-selector tracked-send-unshare-btn">                            <div class="tracked-send-toolbar-item-icon-container">                                <div class="tracked-send-toolbar-item-icon unshare"></div>                            </div>                                <div class="tracked-send-toolbar-item-label"><%= unshare %></div>                        </button>                        <button class="toolbar-item plugin-selector tracked-send-forward-btn">                            <div class="tracked-send-toolbar-item-icon-container">                                <div class="tracked-send-toolbar-item-icon forward"></div>                            </div>                                <div class="tracked-send-toolbar-item-label"><%= forwardLabel %></div>                        </button>                        <button class="control-button ts-viewer-download-button"><%= downloadAll %></button>                    </div>                </div>                <div class="parcel-rendition-body-holder">                    <div class="parcel-rendition-list"                         role="group" aria-labelledby="parcel-subject">                    </div>                    <div role="complimentary" class="parcel-rendition-list-rhp">                    </div>                </div>            </div>            <div class="page-body full-preview"></div>        </div>    </div>'}),define("acplugins/tracked-send/js/nls/ui-strings",{root:!0,"xx-xx":!0,"de-de":!0,"en-gb":!0,"es-es":!0,"fr-fr":!0,"it-it":!0,"ja-jp":!0,"da-dk":!0,"fi-fi":!0,"nb-no":!0,"nl-nl":!0,"pt-br":!0,"sv-se":!0,"zh-cn":!0,"zh-tw":!0,"ko-kr":!0,"cs-cz":!0,"hu-hu":!0,"pl-pl":!0,"ru-ru":!0,"uk-ua":!0,"tr-tr":!0,"sk-sk":!0,"sl-si":!0,"bg-bg":!0}),define("acplugins/tracked-send/js/nls/root/ui-strings",{SELECTOR_LABEL:"For Viewing",SELECTOR_LABEL_WEB:"Sent",TOOL_LABEL:"Send",SEND_TRACK_LABEL:"Shared For Viewing",TYPE:"Type",ADDED_DATE:"Added",MODIFIED_DATE:"Modified",PAGES:"Pages",SIZE:"Size",SENDER_NAME:"Sent By",SENT_DATE:"Date Sent",REPORT_ABUSE:"Report Abuse",UNKNOWN:"Unknown",EXTENSION:"(.<%- ext %>)",DOWNLOAD:"Download",DOWNLOAD_ALL:"Download All",REPLY:"Reply",FORWARD:"Forward",NOTIFY_ME_WHEN_VIEWED:"Notify when recipients viewed",UNSHARE:"Unshare",UNSHARED:"Unshared",VIEWED_BY:"Viewed By",VIEW_FULL_ACTIVITY:"View Full Activity",EMAIL_REPLY_FORMAT:"Re: <%= emailSubject %>",OPEN:"Open",SAVEAS:"Save As",TRACK:"Track Online",OPEN_LINK:"(Open Link)",MESSAGE_HEADING:"Message",REMOVE:"Remove",DELETE:"Delete",SHARED_FILES:"Sent Files",SUBJECT:"Subject",SENT_TO:"Sent To",DATE_SENT:"Date Sent",VIEWS:"Views",PARCEL_PUBLIC_SHARING:"Anonymous",EXPAND:"Expand",COLLAPSE:"Collapse",SELECT_ALL:"Select All",NUMBER_OF_VIEWS:"Number of Views",GO_TO_ADOBE_SEND_WEBSITE:"Go To Adobe Send Website",GO_TO_ADOBE_S_T_WEBSITE:"Manage Documents Sent for Signature",DATE_VIEWED:"Date Viewed",CONFIRM_UNSHARE_TITLE:"Unshare File",CONFIRM_UNSHARE_MSG_ONE_ITEM:"If you unshare this file, people won’t be able to access it anymore. You can share it again later.",CONFIRM_UNSHARE_MSG_N_ITEMS:"If you unshare this file, people won’t be able to access it anymore. You can share it again later.",CONFIRM_UNSHARE_MSG:"Are you sure? We will remove the link to this document from your account.",Unshare_checkbox:"Delete shared file from Document Cloud",CONFIRM_REMOVE_TITLE:"Delete shared file",CONFIRM_REMOVE_BUTTON:"Delete file",CONFIRM_REMOVE_MSG_ONE_ITEM:"Are you sure you want to remove these files from the sent list? By removing the files, they will be unshared and removed from this list, but will not be deleted from your library.",CONFIRM_REMOVE_MSG_N_ITEMS:"Are you sure you want to remove these files from the sent list? By removing the files, they will be unshared and removed from this list, but will not be deleted from your library.",CONFIRM_DELETE_MSG_ONE_ITEM:"Deleting this shared file will permanently remove it from Document Cloud. This can’t be undone.",NO_FILES_TITLE:"No Files",NO_FILES_MESSAGE:"There are no files available to download. The files may have been deleted.",SHARE_TITLE:"Send Files",SHARE_WELCOME:"Send and track large files online.",SHARE_WELCOME_DESKTOP:"The fast, easy way to share and monitor files.",SHARE_SELECT_FILES:"Select Files to Send",SHARE_VIEW_SHARED_FILES:"View All Sent Files",READER_FILESELECT_WINDOW_TITLE:"Select Files",READER_FILESELECT_CONTINUE_BUTTON:"Continue",ALL_SUPPORTED_FILES:"All supported files",CHOOSE_FILES:"Choose Files",ALL_SUPPORTED_FILES:"All supported files",FILE:"file",FILES:"files",UPLOADING_TO_SEND:"Uploading to Adobe Document Cloud...",SELECTED_FILES:"Selected Files",ADD_MORE_FILES:"Add Files",SHARE_WITH_HEADING:"Send To",SHARE_ADDRESS_BOOK:"Address Book",SHARE_CHOICE_WORLD:"Create Anonymous Link",SHARE_CHIOCE_WORLD_EXPLAIN:"(with basic usage information)",SHARE_CHOICE_INDIVIDUAL:"Send Personalized Invitations",SHARE_CHOICE_INDIVIDUAL_EXPLAIN:"(with detailed tracking)",SHARE_CHOICE_ALLOW_COMMENTS:"Allow Comments",SHARE_CHOICE_CUSTOMIZE_RECIPIENT_PAGE:"Add Your Logo & Color",SHARE_CHOICE_CUSTOMIZE_RECIPIENT_PAGE_EDIT:"Edit",SHARE_ADDRESS_HEADING:"Recipient Email Addresses",SHARE_ADDRESS_PROMPT:"Enter recipient email addresses",SHARE_SUBJECT_MSG_HEADING:"Subject & Message",SHARE_INITIAL_SUBJECT:"Shared Files",SHARE_AV_ERROR:"Audio/video files are not supported for sending, and have been omitted from your selection.",SHARE_AV_UPGRADE_MESSAGE:" Upgrade to be able to send audio/video files.",SHARE_FORMS_ERROR:"Form files are not currently supported for sending. Go to Fill & Sign to find and download the form.",SHARE_FORMS_ERROR_DESKTOP:"This file type is currently not supported and has been omitted from your selection.",SHARE_AV_FORMS_ERROR:"Audio/video and form files are not supported for sending, and have been omitted from your selection.",SHARE_OVER_LIMIT_APPEND_ERROR:"<br/><br/>Additionally, you selected more than <%- limit %> files. Files beyond that limit have been omitted.",SHARE_OVER_LIMIT_ERROR:"You selected more than <%- limit %> files. Files beyond that limit have been omitted.",SHARE_OVER_LIMIT_TITLE:"Too many files.",SHARE_NON_NATIVE_APPEND_ERROR:"<br/><br/>Additionally, your selection included files stored in one or more unsupported storage locations, and have been omitted.",SHARE_NON_NATIVE_ERROR:"Send & Track is currently not supported for files stored in <%= connectorLabel %>. To send files from <%= connectorLabel %>, save them to your computer first.",SHARE_NON_NATIVE_ERROR_DEFAULT:"Your selection included files stored in one or more unsupported storage locations, and have been omitted.",SHARE_NON_NATIVE_ERROR_HEADING:"Unsupported File Storage",SHARE_MESSAGE_HEADING:"Message",SHARE_MESSAGE_PROMPT:"I have shared some files with you. Please click on the link to view and download them.",SHARE_BUTTON:"Send",SHARE_BUTTON_LINK:"Create Link",SHARE_CANCEL:"Cancel",SHARE_EMAIL_INVALID_PLURAL:"The following email addresses are invalid:",SHARE_EMAIL_INVALID_SINGULAR:"The following email address is invalid:",SHARE_ERROR_SEND_LIMIT_EXCEEDED_TITLE:"Not sent",SHARE_ERROR_SEND_LIMIT_EXCEEDED:"The number of recipients you have selected exceeds your recent limit. Reduce the number of recipients, or wait until later to try again.",SHARE_ERROR_UNSUPPORTED_SHARING_MIME_TYPE:"Audio/video files aren't supported.",SHARE_ERROR_RECIPIENTS_NOT_ALLOWED:"Please upgrade to send to individuals.",SHARE_ERROR_CANNOT_CONVERT_FORM:"Files could not be sent because the form file could not be converted to pdf.",SHARE_ERROR_CANNOT_CONVERT_FORM_RESTRICTION:"Files could not be sent because the form file could not be converted to pdf.",SHARE_ERROR_CANNOT_CONVERT_FORM_TIMEOUT:"Files could not be sent because the form file conversion to PDF timed out.",SHARE_INDIVIDUAL_HELP_WEB:"Note: Personalized links are unique to each recipient, but anyone the recipient shares those links with can access the documents.",SHARE_INDIVIDUAL_HELP:"Note: Personalized invitations are unique to each recipient, but anyone the recipient shares those invitations with can access the documents.",SHARE_UPLOAD_ERROR_TITLE:"Error uploading files",SHARE_UPLOAD_ERROR_MSG:"One or more files could not be uploaded. Please try again.",SHARE_NO_FILES_SELECTED:"There are currently no files selected.",SHARE_CLICK_TO_ADD_FILES:"Click the Add Files button to get started.",SHARE_RECIPIENT_PAGE_HEADLINE:"Recipient Page",SHARE_CHOICE_INCLUDE_MESSAGE:"Include Message Text",SHARE_CHOICE_RESPOND_BACK:"Include Reply-To",SHARE_REMOVE:"Remove",ADD_FILES_REJECTED_TITLE:"Invalid Filename Format",ADD_FILES_REJECTED_MESSAGE:"Files must have a file name extension or be a known file type to be sent. Please ensure that your filename includes a valid file extension.",SHARE_PUBLIC_LINK_HEADING_DESKTOP:"Distribute the anonymous link by:",SHARE_COPY_LINK_BUTTON:"Copy Link",SHARE_SUCCESS_SENT_LINK:"Go to Sent Files",SHARE_SUCCESS_SENT_LINK_FOOTER:"to view all previously sent files",READER_GO_URL:"http://www.adobe.com/go/sendpluginrdr_12_0_0",ACROBAT_GO_URL:"http://www.adobe.com/go/sendpluginacro_12_0_0",SEND_UPSELL_HEADLINE:"Upgrade To",SEND_UPSELL_HEADLINE_OLD:"Upgrade to:",SEND_UPSELL_POINT_1:"• Send large files, including documents and videos",SEND_UPSELL_POINT_2:"• Receive an email when files are viewed",SEND_UPSELL_POINT_3:"• Track downloads using an online dashboard",SEND_UPSELL_LATER:"Later",SEND_UPSELL_NOW:"Upgrade Now",SEND_UPSELL_LEARN_MORE:"Learn More",SEND_UPSELL_UPGRADE_REQUIRED:"Unsupported Files",SHARE_TOO_MANY_DLG_TITLE:"Too many email addresses",SHARE_TOO_MANU_DLG_MESSAGE:"You've entered <%=numRecipients%> email addresses, but you can only send to <%=maxRecipients%> at a time. Delete some addresses and try again.",SHARE_SUCCESS_DLG_TITLE:"Files Shared",SHARE_PUBLIC_LINK_HEADING:"Anonymous Link Generated",SHARE_EMAIL_LINK_BUTTON:"Email Link",SHARE_PUBLIC_LINK_MESSAGE:"Anyone with the link will access the files anonymously.",SHARE_PUBLIC_LINK_NO_COPY_OR_EMAIL_WARNING:"You have not yet copied or emailed the link. Are you sure you want to continue?",SHARE_PUBLIC_LINK_INSTRUCTIONS:"Copy the link below to email or share it with others. Anyone who uses the link will be able to access the files.",SHARE_INVITATIONS_HEADING:"Invitations Sent",SHARE_INVITATIONS_MESSAGE:"Each recipient will receive a link by email, and you will be notified when they follow the link.",SHARE_SUCCESS_CLOSE:"Close",SHARE_SUCCESS_CONTINUE:"Continue",SHARE_FILE_EMAIL_BODY:"I'm using Adobe Send. You can view my file by clicking on the link below:",SHARE_FILES_EMAIL_BODY:"I'm using Adobe Send. You can view my files by clicking on the link below:",S_T_FILE_EMAIL_BODY:"I'm using Adobe Send & Track. You can view my file in Adobe Document Cloud by clicking on the link below:",S_T_FILES_EMAIL_BODY:"I'm using Adobe Send & Track. You can view my files in Adobe Document Cloud by clicking on the link below:",SHARE_CLIPBOARD_MESSAGE:"Tip: Use Ctrl + C to copy",SHARE_CLIPBOARD_MESSAGE_MAC:"Tip: Use Cmd + C to copy",SHARE_CLIPBOARD_COPIED:"link is copied to clipboard",PARCEL_ACTIVITY_DOWNLOADED:"downloaded",PARCEL_ACTIVITY_PREVIEWED:"previewed",PARCEL_ACTIVITY_PUBLIC_VISITOR:"public link visitor",PARCEL_ACTIVITY_ALL_FILES:"All Files",PARCEL_ACTIVITY_ALL_FILES_PREVIEW:"All Files Preview Page",PARCEL_ACTIVITY_HEADING:"Activity for “<%= emailSubject %>”",PARCEL_ACTIVITY_RECIPIENT:"Recipient",PARCEL_ACTIVITY_ACTIVITY:"Activity",PARCEL_ACTIVITY_ITEM:"Item",PARCEL_ACTIVITY_DATE_VIEWED:"Date Viewed",PARCEL_ACTIVITY_CLOSE:"Close",CURRENTLY_SHARED_IN:"Sent To",SHARE_THIS_FILE:"Send this File",SHARE_THIS_FILE_AGAIN:"Send this File Again",SENT_FILES_HEADER_SEARCH_CONTROLS:"Search Controls",SENT_FILES_HEADER_REFRESH:"Refresh",SENT_FILES_NUM_FILES:"<%= numFiles %> files",NO_PARCELS_SEND_PROMPT:"There aren't any files here yet.",NO_PARCELS_SEND_SUBPROMPT:"Files you've sent or received for viewing will appear here.",NO_PARCELS_SEND_BTN:"Adobe Send",NO_PARCELS_S_T_BTN:"Learn about sending files for viewing",LEARN_MORE_ST_GO_URL:"http://www.adobe.com/go/LearnMoreSTEmpty",NO_SENT_PARCELS_REVIEW_SUBPROMPT:"Files that are shared by you will appear here.",NO_RECEIVED_PARCELS_REVIEW_SUBPROMPT:"Files that are shared by others will appear here.",SENT_LEARN_MORE:"Learn More",RECEIVED_LEARN_MORE:"Learn More",CTA_SHARE_A_FILE:"Share a file",NO_SHARED_FILE:"No shared files yet.",ON_SIGN_OUT_PROMPT:"Sign in to access shared files.",ON_SIGN_OUT_SUBPROMPT:"See and manage files you've sent or received for viewing.",SIGN_IN_BUTTON:"Sign In",ON_SIGN_OUT_SUBPROMPT_SENT_FILES:"See and manage files that are shared by you.",ON_SIGN_OUT_SUBPROMPT_RECEIVED_FILES:"See and manage files that are shared by others.",COULD_NOT_SEND:"Could not send",ENTERPRISE_USERS_ACCESS_ERROR:"You do not have access to this service. Please contact your IT Administrator to gain access, or try to sign in with an Adobe ID.",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_NOT_AVAILABLE:"Continue at Adobe Document Cloud",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_USE_WEB_MSG:'Edits to your Color and Logo are currently only available online at the Adobe Send web site. Click "<%= buttonName %>" to go there now.',S_T_CUSTOMIZE_RECIPIENT_PAGE_DIALOG_USE_WEB_MSG:'Edits to your logo and color are currently only available at Adobe Document Cloud. Click "<%= buttonName %>" to go there now.',CUSTOMIZE_RECIPIENT_PAGE_DIALOG_USE_WEB_OK:"Continue",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_TITLE:"Add Your Logo & Color",CUSTOMIZE_RECIPIENT_PAGE_DIALOG_DESCRIPTION:"Add your logo and choose a color to display on emails and recipient page.",CUSTOMIZE_RECIPIENT_PAGE_ADD_LOGO:"Add Logo",CUSTOMIZE_RECIPIENT_PAGE_REMOVE_LOGO:"Remove Logo",CUSTOMIZE_RECIPIENT_PAGE_CHOOSE_COLOR:"Choose Color",CUSTOMIZE_RECIPIENT_PAGE_SAVE:"Save",CUSTOMIZE_RECIPIENT_PAGE_CLOSE:"Cancel",CUSTOMIZE_RECIPIENT_PAGE_FILE_FILTERING_LABEL:"File Type is an image",CUSTOMIZE_RECIPIENT_PAGE_UNSUPPORTED_LOGO_TITLE:"Error",CUSTOMIZE_RECIPIENT_PAGE_UNSUPPORTED_LOGO_FORMAT:"The file you have chosen cannot be used as a logo. Please select another file. ",CUSTOMIZE_RECIPIENT_PAGE_UNSUPPORTED_COLOR_FORMAT:"The color you have entered is invalid. Please enter a hex value like #FFFFFF or #FFF.",SURVEY_TITLE:"We are interested in your Feedback",SURVEY_LINK:"Tell Us What You Think",SURVEY_QUESTION_ONE:"Why are you using Send & Track today?",SURVEY_QUESTION_TWO:"Does it work well for you?",SURVEY_QUESTION_THREE:"Is it missing something you wanted?",SURVEY_SEND:"Send",SURVEY_CLOSE:"No Thanks",SURVEY_TEXTAREA_LIMITATION_LABEL:"characters remaining",INVALID_PARAMETER_SURVEY_MESSAGE:"Answer type not allowed",INVALID_PARAMETER_SURVEY_TITLE:"Invalid Parameter",SEND_RHP_TITLE:"Sent To",GENERIC_ARIA_LABEL_STRING:"<%= prefix %>. <%= suffix %>",ENTERPRISE_RESTRICTIONS_ENFORCED:"Enterprise Sharing Restrictions Enabled",ENTERPRISE_USERS_SHARING_ACCESS:"This feature isn't available because your organization has enabled sharing restrictions. ",NAME:"NAME",SENT_RECEIVED:"SENT/RECEIVED",OWNER:"SENDER",STATUS:"STATUS",SHARED:"Shared",YOU:"You",VIEWED:"viewed",VIEWED_CAPS:"Viewed",WAITING_FOR_YOU:"Waiting for you",OF:"of",ACTIVITY_VIEWED_BY:"Viewed by <%= participant %>",ACTIVITY_DOWNLOADED_BY:"Downloaded by <%= participant %>",ACTIVITY_ONE_DOWNLOADED_BY:"<%= file_name %> downloaded by <%= participant %>",ACTIVITY_CREATED_BY:"Created by <%= participant %>",ACTIVITY_DOCUMENT_CREATED_BY:"Document created by <%= participant %>",ACTIVITY_SENT_TO:"Sent to <%= participant %>",REMOVE_LINK_DC_TITLE:"Remove Link from Adobe's cloud storage",REMOVE_LINK_DC_CONTENT:"Removing this link will delete it from the list of items shared with you.",REMOVE_LINK_DC_BUTTON:"Remove Link",ASCENDING:"Ascending",DESCENDING:"Descending",SHARED_FILES_DOWNLOAD_TITLE:"Shared Files",SENT_FILES_HEADER:"Shared by you",RECEIVED_FILES_HEADER:"Shared by others",LAST_ACTIVITY:"LAST ACTIVITY",DATE_LAST_ACTIVITY:"Date Last Activity",SHARED_BY:"SHARED BY",SIZE:"SIZE",SHARING:"SHARING",DATE_SHARED:"DATE SHARED",DATE_SHARED_S:"Date Shared",FROM:"FROM",DUE_BY:"Due by"}),define("acplugins/tracked-send/js/utils/sc-constants",["plugins-common/ac-plugins"],function(e){e.TrackedSend||(e.TrackedSend={});
var i=e.TrackedSend;return i.ScConstants={ACTION:"Action",ACTIONS:"Actions",ADD_FILES_TO_SHARE:"AddFilesToShare",ADDRESS_BOOK:"AddressBook",ATTEMPTED_TO_SHARE_FORM:"AttemptedToShareForm",AUTOCOMPLETE:"Autocomplete",AVOIDED:"Avoided",BROWSER_CLOSE:"BrowserClosed",BRANDING:"Branding",CANCEL:"Cancel",CHECKED:"Checked",CHICKLET_ADDED:"ChickletAdded",CLICKED:"Clicked",CLICK_BRANDING:"ClickBranding",CLICK_BRANDING_IN_READER:"ClickBrandingInReader",CLICK_BRANDING_IN_ACROBAT:"ClickBrandingInAcrobat",CLOSE:"Close",COLOR_INPUT:"ColorInput",COLOR_MENU_BUTTON:"ColorMenuButton",COLOR_WELL:"ColorWell",CONTINUE:"Continue",DATE_VIEWED:"DateViewed",DEFAULT:"Default",DIALOG:"Dialog",DISABLED:"Disabled",DISALLOWED:"Disallowed",DOWNLOAD:"Download",DOWNLOAD_ALL:"DownloadAll",DOWNLOAD_ONE:"DownloadOne",DRAG_FILES:"DragFiles",DURATION:"Duration",EDIT_BRANDING_ONLINE:"ContinueOnline",EMAIL:"Email",EMAIL_LINK:"EmailLink",ENABLED:"Enabled",ENTERED:"Entered",EVENTUAL_CLICK:"EventualClick",FILE:"File",FILE_LIST:"FileList",FILE_NAME:"FileName",FILES_SHARED_DLG:"FilesSharedDlg",FORWARD:"Forward",FULL_ACTIVITY:"FullActivity",HIDDEN:"Hidden",IMMEDIATE_CLICK:"ImmediateClick",INCLUDE_MESSAGE_TEXT:"IncludeMessageText",INCLUDE_REPLY_TO:"IncludeReplyTo",IPM:"IPM",LATER:"Later",LOGO_BUTTON:"LogoButton",LOGO_CANCEL:"LogoCancel",LOGO_SAVE:"LogoSave",MESSAGE:"Message",MULTI:"Multi",NO_PARCELS:"NoParcels",NOTIFY_WHEN_VIEWED:"NotifyWhenViewed",NUM_FILES_CHECKED:"NumFilesChecked",PERSONAL:"Personal",PERSONAL_AND_PUBLIC:"PersonalANDPublic",PREVIEW:"Preview",PUBLIC:"Public",PUBLIC_LINK:"PublicLink",RECVIEW:"RecView",REPLY:"Reply",REMOVE:"Remove",REPORT_ABUSE:"ReportAbuse",RHP:"RHP",SCROLL:"Scroll",SAVE_AS:"SaveAs",SELECT_ALL:"SelectAll",SELECT_FILES:"SelectFiles",SENT_FILES:"SentFiles",SHARE:"Share",SHARE_BUTTON:"ShareButton",SHARE_FILE_BUTTON:"ShareFileButton",SHARE_ICON:"ShareIcon",SHARE_WITH:"ShareWith",SHARED:"Shared",SHOWN:"Shown",SINGLE:"Single",SORT:"Sort",SUBJECT:"Subject",SUCCESS:"Success",SURVEY:"Survey",SURVEY_CANCEL:"SurveyCancel",SURVEY_FIELD_FOCUS:"SurveyFieldFocus",SURVEY_LINK:"SurveyLink",SURVEY_SEND:"SurveySend",TOOLS:"Tools",TRACK:"Track",TRASH:"Trash",TURN_OFF_BRANDING:"TurnOffBranding",TURN_ON_BRANDING:"TurnOnBranding",UNCHECKED:"Unchecked",UNSHARE:"Unshare",UPGRADE:"Upgrade",URL_HIGHLIGHT:"UrlHighlight",URL_KEY_COPY:"UrlKeyCopy",VIEW:"View",VIEW_ALL_SHARED_FILES:"ViewAllSharedFiles",VIEW_FULL_ACTIVITY:"ViewFullActivity",WARNED_BEFORE_CLOSING:"WarnB4Close",WARNING:"Warning",WITH_REPLY:"wReply",1:"1","2_TO_5":"2to5","6_TO_10":"6to10","11_OR_MORE":"11orMore","11_TO_20":"11to20","21_TO_40":"21to40","41_TO_120":"41to120","121_OR_MORE":"121orMore",FSS:"FSS",FORM:"Form",OUTPUT:"Output",SAVE_TO_PDF:"SaveToPDF","1_STARTED":"1-Started","2_COMPLETED":"2-Completed",ERROR:"Error",SEND_TAB:"SendTab",COMPLETED:"Completed",SHARED_BY_YOU:"SharedByYou",SHARED_BY_OTHERS:"SharedByOthers",VIEW_FILES:"ViewFiles ",REVIEW_FILES:"ReviewFiles "},i.ScConstants}),define("viewer/templates/page-header-template.html",[],function(){return'<div class="adc-logo"></div>    <div class="page-header-tabs">        <div class="page-header-tab selected"><%= title %></div>    </div>'}),define("viewer/nls/ui-strings",{root:!0,"xx-xx":!0,"de-de":!0,"en-gb":!0,"es-es":!0,"fr-fr":!0,"it-it":!0,"ja-jp":!0}),define("viewer/nls/root/ui-strings",{APP_NAME:"VIEWER",UNSUPPORTED_BROWSER_TITLE_2:"Browser Unsupported",UNSUPPORTED_BROWSER_MSG_2:"You are running an unsupported version of Internet Explorer. To view shared file(s), you must upgrade to the <a class='dialog-link' href='<%= ie %>'>latest version of Internet Explorer</a>, or use the latest version of <a class='dialog-link' href='<%= chrome %>'>Google Chrome</a>, <a class='dialog-link' href='<%= safari %>'>Safari</a> or <a class='dialog-link' href='<%= firefox %>'>Firefox</a>."}),define("viewer/views/page-header-view",["core/ac-core","viewer/ac-viewer","viewer/templates/page-header-template.html","i18n!viewer/nls/ui-strings","core/views/view"],function(e,i,t,s){i.PageHeaderView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t)},render:function(){return e.View.prototype.render.call(this),0===this.$el.children().length&&this.$el.html(this._template({title:s.APP_NAME})),this}})}),define("viewer/templates/full-preview-tracked-send-template.html",[],function(){return'<div class="full-preview-header files-header our-preview">    <div class="full-preview-home-btn-wrapper">        <button class="full-preview-home-btn parcel-preview-home-btn"                id="full-preview-header-home-btn"                title="<%= back %>">            <span class="hidden-accessible"><%= back %></span>        </button>        <div class="full-preview-home-btn-separator"></div>    </div>     <div class="full-preview-name-container folder-path                with-home-btn">        <div class="wrap-branding-logo"><div class="branding-logo parcel-branding-logo"></div></div>        <div id="full-preview-name" class="full-preview-name"             role="heading" aria-level="1"><%- name %></div>         <button class="full-preview-action-menu-btn                       files-header-btn"             id="full-preview-action-menu-btn"             title="<%= actions %>" aria-haspopup="true">            <span class="hidden-accessible"><%= actions %></span>        </button>        <div class="full-preview-action-menu menu" role="menu"              aria-hidden="true"></div>    </div>     <div class="full-preview-plugins-selector">        <div class="toolbar-selection-pointer"></div>        <div class="full-preview-plugins-selector-separator"></div>    </div>     <div class="full-preview-header-btns files-header-btns right">        <button class="full-preview-download-btn"             data-test-name="full-preview-header-download-btn">            <div class="full-preview-download-btn-icon"></div>            <div class="full-preview-download-btn-label">                 <%= download %></div>        </button>    </div></div> <div class="full-preview-main">    <div class="full-preview-body folder-items">        <div id="full-preview-image-container"             class="full-preview-image-container">            <!-- Intentionally omit close tag for img.                 See bug 3498744 (IE8) -->            <img class="full-preview-image single hidden" alt=""/>            <div class="full-preview-svg single hidden"/>        </div>        <div class="full-preview-not-available">            <%= previewNotAvailable %>            <span class="full-preview-not-available-desc"                ><%= previewNotAvailableDesc %></span>        </div>    </div>     <div class="full-preview-hud" role="toolbar"         aria-labelledby="full-preview-name"         aria-controls="full-preview-image-container"></div></div> <div class="full-preview-sidebar" tabindex="-1"></div>'}),define("viewer/views/full-preview-tracked-send-view",["core/ac-core","files/ac-files","viewer/ac-viewer","viewer/templates/full-preview-tracked-send-template.html","i18n!files/nls/ui-strings","i18n!acplugins/tracked-send/js/nls/ui-strings","acplugins/tracked-send/js/utils/sc-constants","files/views/full-preview-view"],function(e,i,t,s){t.FullPreviewTrackedSendView=i.FullPreviewView.extend({initialize:function(){i.FullPreviewView.prototype.initialize.call(this),this._template=_.template(s),this.options.fullPreviewUiModel.on("change:show_info",this._toggleRHP,this)},template:function(){return this._template},render:function(){var e,t=(this.options.parcelModel.get("invitation"),new Image);return i.FullPreviewView.prototype.render.call(this),!this.$homeBtn||this.options.viewMode&&"plugin"===this.options.viewMode||this.options.parcelModel.get("enabled")!==!0||(this.$parcelBody.addClass("branded"),this.$fullPreviewHeader.addClass("has-branding"),this.$fullPreviewMain.addClass("has-branding"),this.$parcelBody.addClass("has-branding"),this.$fullPreviewSidebar.addClass("has-branding"),e=this.options.parcelModel.get("color"),this.$fullPreviewBrandingLogo.children().length<1&&this.$fullPreviewBrandingLogo.append(t)),this},_initWrappers:function(){i.FullPreviewView.prototype._initWrappers.call(this),this.$fullPreviewBrandingLogo=$(".full-preview .branding-logo"),this.$parcelContainerFullPreviewName=$(".parcel-container .full-preview-name"),this.$parcelBody=this.$(".full-preview-name-container"),this.$fullPreviewHeader=this.$(".full-preview-header"),this.$fullPreviewMain=this.$(".full-preview-main"),this.$fullPreviewName=this.$(".full-preview-name"),this.$fullPreviewSidebar=this.$(".full-preview-sidebar"),this.$fullPreviewHomeButtonWrapper=this.$(".full-preview-home-btn-wrapper"),this.$fullPreviewHomeButton=this.$(".full-preview-home-btn")},_renderHudView:function(){this._renderChildView("_fullPreviewHudView",t.FullPreviewTrackedSendHudView,this.$previewHud)},_toggleRHP:function(){var e;LOG("Toggle Right Hand Panel"),e=this.options.fullPreviewUiModel.get("show_info"),e?this.$fullPreviewSidebar.addClass("show"):this.$fullPreviewSidebar.removeClass("show")}})}),define("viewer/templates/parcel-asset-template.html",[],function(){return'<div class="parcel-asset-view spinner-icon" role="group" aria-labelledby="parcel-name-<%= viewId %>">        <div role="presentation" class="parcel-hover-preview parcel-asset-rendition-block">            <div role="presentation" class="hover-preview-page3 hover-preview-page small-shadow"></div>            <div role="presentation" class="hover-preview-page2 hover-preview-page small-shadow"></div>            <div role="presentation" class="hover-preview-page1 hover-preview-page small-shadow">                <img class="parcel-asset-rendition" alt="" src="<%= rendition_url %>" />                <div role="presentation" class="hover-preview-not-available-parcel">                    <div class="hover-preview-not-available-header"><%=PREVIEW_NOT_AVAILABLE%></div>                    <div class="hover-preview-not-available-desc">                        <%=PREVIEW_NOT_AVAILABLE_DESC%>                    </div>                </div>                <div role="presentation" class="hover-preview-hud">                    <button data-test-name="hover-preview-hud-prev"                            class="hover-preview-hud-prev                                   hover-preview-control                                   hover-preview-nav-btn disabled"                            title="<%= PREV_PAGE_TITLE %>"                            aria-label="<%= PREV_PAGE_TITLE %>" disabled>                        <div class="hover-preview-nav-btn-img hover-preview-img-prev"></div>                    </button>                    <button data-test-name="hover-preview-hud-next" class="hover-preview-hud-next                                   hover-preview-control                                   hover-preview-nav-btn"                            title="<%= NEXT_PAGE_TITLE %>"                            aria-label="<%= NEXT_PAGE_TITLE %>">                        <div class="hover-preview-nav-btn-img hover-preview-img-next"></div>                    </button>                </div>            </div>        </div>        <div role="presentation" class="parcel-asset-rendition-footer">            <button class="parcel-inline download-button" title="<%= DOWNLOAD %>" aria-label="<%= DOWNLOAD %>"></button><button class="parcel-inline parcel-name" id="parcel-name-<%= viewId %>"><%= filename %></button>        </div>    </div>'}),define("viewer/views/parcel-asset-view",["core/ac-core","viewer/ac-viewer","viewer/templates/parcel-asset-template.html","i18n!files/nls/ui-strings","i18n!core/nls/ui-strings","acplugins/tracked-send/js/utils/sc-constants","core/views/view"],function(e,i,t,s,n,o){i.ParcelAssetView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t),this._addKeyEventListener()},resetRendition:function(){var e=this.model.getRenditionUrl("tile",this.model.get("current_page"));this.$rendition.attr("src",e)},adjustHud:function(){0===this.model.get("current_page")?(this.$prevBtn.addClass("disabled").prop("disabled",!0),this.$nextBtn.removeClass("disabled").prop("disabled",!1)):this.model.get("current_page")===this.model.get("page_count")-1?(this.$prevBtn.removeClass("disabled").prop("disabled",!1),this.$nextBtn.addClass("disabled").prop("disabled",!0)):(this.$prevBtn.removeClass("disabled").prop("disabled",!1),this.$nextBtn.removeClass("disabled").prop("disabled",!1))},turnPage:function(e){e.stopPropagation();var i,t,s=e.data.direction,n=1,a="NextPg",r=this.options;"prev"===s&&(n=-1,a="PrevPg"),1===n&&this.$nextBtn.hasClass("disabled")||-1===n&&this.$prevBtn.hasClass("disabled")||(t=r.parcelAssetsCollection&&r.parcelAssetsCollection.length>1?o.MULTI:o.SINGLE,r.appApi.siteCatalystApi.logScEvent(r.viewMode&&"plugin"===r.viewMode?[o.PREVIEW,t,o.FILE,a]:[o.RECVIEW,t,o.FILE,a]),i=(this.model.get("current_page")||0)+n,this.model.set("current_page",i),this.resetRendition(),this.adjustHud())},download:function(i){i.stopPropagation();var t=this.model,s=_.extend({},this.options,{id:t.get("id"),content_type:t.get("content_type")});this._triggerViewEvent(e.ViewEvents.DOWNLOAD,s),this.options.appApi.siteCatalystApi.logScEvent([o.RECVIEW,o.MULTI,o.DOWNLOAD_ONE])},render:function(i,t){var o,a=this.model.id,r=1;return e.View.prototype.render.call(this),this.$item||(o=this._template({filename:this.model.get("name"),rendition_url:this.model.getRenditionUrl("tile",0),PREVIEW_NOT_AVAILABLE:n.PREVIEW_NOT_AVAILABLE,PREVIEW_NOT_AVAILABLE_DESC:n.PREVIEW_NOT_AVAILABLE_DESC,DOWNLOAD:n.DOWNLOAD,PREV_PAGE_TITLE:s.PREV_PAGE_TITLE,NEXT_PAGE_TITLE:s.NEXT_PAGE_TITLE,viewId:a}),i?i.replaceWith(o):this.$el.append(o),this.$item=this.$el.children().eq(t),this.$rendition=$(this.$item.find(".parcel-asset-rendition")),this.$hud=$(this.$item.find("div.hover-preview-hud")),this.$prev=this.$hud.find(".hover-preview-img-prev"),this.$next=this.$hud.find(".hover-preview-img-next"),this.$prevBtn=this.$hud.find(".hover-preview-hud-prev"),this.$nextBtn=this.$hud.find(".hover-preview-hud-next"),this.$download=this.$item.find(".download-button"),this.$norendition=this.$item.find(".hover-preview-not-available-parcel"),this.$rendition.on("error",{},_.bind(function(){this.$norendition.show(),this.$rendition.hide(),$(this.$item.find(".parcel-asset-rendition-block")).css("opacity",1),$(this.$item.find(".hover-preview-page")).css("margin-top",this.$norendition.height()/2-this.$norendition.height())},this)),this.$rendition.on("load",{},_.bind(function(){$(this.$item.find(".hover-preview-page")).css("margin-top",this.$rendition.height()/2-this.$rendition.height()),$(this.$item.find(".parcel-asset-rendition-block")).css("opacity",1),this.$item.removeClass("spinner-icon")},this)),r=parseInt(this.model.get("page_count"),10),r>1?(this.$rendition.on("load",{},_.bind(function(){var e=$(this.$item.find(".hover-preview-page"));e.css("width",this.$rendition.width()).css("height",this.$rendition.height()).css("margin-top",this.$rendition.height()/2-this.$rendition.height())},this)),this.$prevBtn.on("click",{direction:"prev"},_.bind(this.turnPage,this)),this.$nextBtn.on("click",{direction:"next"},_.bind(this.turnPage,this))):this.$hud.addClass("hidden"),this.$download.on("click",{},_.bind(this.download,this)),this.$norendition.find(".preview-download").on("click",{},_.bind(this.download,this))),this.$item.data("id",a),this._checkForReportAbuseFlow(),this},_checkForReportAbuseFlow:function(){"True"===this.options.parcelModel.get("reportabuse")&&($(".parcel-asset-rendition").hide(),$(".hover-preview-not-available-parcel").show())},_onKeyPress:function(e){var i,t=$(e.target),s=e.charCode||e.keyCode,n=!1,o=this.$prevBtn,a=this.$nextBtn,r=!1;return(13===s||32===s)&&(r=t.is(o),(r||t.is(a))&&(i=r?a:o,t.trigger("click"),n=!0,t.is(":disabled")&&i.focus())),n}})}),define("viewer/views/multi-file-view",["core/ac-core","viewer/ac-viewer","i18n!acplugins/tracked-send/js/nls/ui-strings","viewer/views/parcel-asset-view","core/views/view"],function(e,i,t){i.MultiFileView=e.View.extend({events:{"click .parcel-asset-view":"_onClickView"},initialize:function(){e.View.prototype.initialize.call(this)},render:function(){return e.View.prototype.render.call(this),this._renderChildViews(),$(".parcel-rendition-list").addClass("plugin"===this.options.viewMode?"plugin":"viewer"),this},_renderChildViews:function(){var e,i=this.$el.children(),s=i.length,n=0,o=this.options.parcelAssetsCollection;o.each(function(t){var o=this._getChildItemView(t);e=s>n?i.eq(n):void 0,o.render(e,n),n+=1},this),"plugin"!==this.options.viewMode&&0===$(".report-abuse").length&&this.$el.append('<div role="button" tabindex="0" class="report-abuse"><span class="report-abuse-label">'+t.REPORT_ABUSE+"</span></div>")},_getChildItemView:function(e){var t,s=this.options,n=e.id,o=this.$el;return t=this.getChildViewById(n),t?(t.$el!==o&&t.setElement(o),_.extend(t.model.attributes,e.attributes)):(s=_.extend({},s,{el:o,model:e}),t=new i.ParcelAssetView(s),this.addChildView(t,n)),t},_getEventTargetItem:function(e){return $(e.target).closest(".parcel-asset-view")},_getEventTargetView:function(e){var i,t=this._getEventTargetItem(e);return t&&(i=this.getChildViewById(t.data("id"))),i},_onClickView:function(e){var i,t,s,n=this.options;s=this._getEventTargetView(e),t=s.model,i=t.id,this._triggerViewEvent("viewer:preview-file",_.extend({},n,{id:i,itemModel:t}))}})}),define("viewer/templates/viewer-page-rhp-view-template",[],function(){return'<div class="ts-rhp-respond-back-multi"></div><div role="button" tabindex="0" class="report-abuse">    <span class="report-abuse-label"><%= reportAbuse %></span></div> '}),define("acplugins/tracked-send/js/viewer-rhp/templates/respond-back-view-template.html",[],function(){return'<div class="ts-rhp-respond-back-container">       <div class="ts-rhp-sender-title ts-rhp-title"><%= senderHeading %></div>       <div class="ts-rhp-sender-name"><%= senderName %></div>       <input type="button" class="button-light-blue-small ts-rhp-reply-button"           value="<%= replyBtn %>"/>       <div class="ts-rhp-message-title ts-rhp-title"><%- messageHeading %></div>       <div class="ts-rhp-email-subject ts-rhp-body-single" title="<%- emailSubject %>"><%- emailSubject %></div>       <div class="ts-rhp-email-message ts-rhp-body-multi"><%- emailMessage %></div>       <div class="ts-rhp-date-title ts-rhp-title"><%= dateTitle %></div>       <div class="ts-rhp-date-sent ts-rhp-body-single"><%= sentDate %></div>   </div>'}),define("acplugins/tracked-send/js/viewer-rhp/views/respond-back-view",["core/ac-core","acplugins/tracked-send/js/viewer-rhp/templates/respond-back-view-template.html","i18n!acplugins/tracked-send/js/nls/ui-strings","core/utils/date-util","acplugins/tracked-send/js/utils/sc-constants","core/views/view"],function(e,i,t,s,n){return e.View.extend({events:{"click .ts-rhp-reply-button":"_onReplyClick"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(i)},render:function(){var i=this.options.parcelModel,s=i.get("email_message"),n=i.get("sender_email"),o=i.get("sender_name"),a=i.get("email_subject");e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({messageHeading:t.SHARE_SUBJECT_MSG_HEADING,emailSubject:a,emailMessage:s,senderEmail:n,senderHeading:t.SENDER_NAME,senderName:o,replyBtn:t.REPLY,dateTitle:t.SENT_DATE,sentDate:this._formatDateSend()})),this._initWrappers()),s||n||o?(this.$respondBackContainer.parent().show(),n?this.$replyButton.show():this.$replyButton.hide(),a?this.$emailSubject.show():this.$emailSubject.hide(),s?this.$emailMessage.show():this.$emailMessage.hide(),a||s?this.$messageTitle.show():this.$messageTitle.hide()):this.$respondBackContainer.parent().hide()},_onReplyClick:function(){var e,i,s="mailto:",o=this.options.parcelModel;i=this.options.parcelAssetsCollection&&this.options.parcelAssetsCollection.length>1?[n.RECVIEW,n.MULTI,n.PREVIEW,n.REPLY]:[n.RECVIEW,n.SINGLE,n.REPLY],this.options.appApi.siteCatalystApi.logScEvent(i),s+=o.get("sender_email"),e=_.template(t.EMAIL_REPLY_FORMAT,{emailSubject:encodeURIComponent(o.get("email_subject"))}),s+="?subject="+e,document.location.href=s},_initWrappers:function(){this.$respondBackContainer=this.$(".ts-rhp-respond-back-container"),this.$replyButton=this.$(".ts-rhp-reply-button"),this.$emailSubject=this.$(".ts-rhp-email-subject"),this.$emailMessage=this.$(".ts-rhp-email-message"),this.$messageTitle=this.$(".ts-rhp-message-title")},_formatDateSend:function(){var e,i=this.options.parcelModel;return e=i.get("date_sent"),i?s.formatDate(e||""):""}})}),define("viewer/views/viewer-page-rhp-view",["core/ac-core","viewer/ac-viewer","viewer/templates/viewer-page-rhp-view-template","i18n!acplugins/tracked-send/js/nls/ui-strings","acplugins/tracked-send/js/viewer-rhp/views/respond-back-view","core/views/view"],function(e,i,t,s,n){i.ViewerPageRHPView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t),this._addModelEventListeners()},render:function(){var i=this.options.parcelModel;e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({reportAbuse:s.REPORT_ABUSE,sentBy:s.SENDER_NAME,senderName:i.get("sender_name")})),this._initWrappers()),this._renderChildViews()},_addModelEventListeners:function(){this.options.parcelModel.on("change",this._onParcelChange)},_onParcelChange:function(){},_removeModelEventListeners:function(){this.options.parcelModel.off("change")},_initWrappers:function(){this.$respondBack=$(".ts-rhp-respond-back")},_renderChildViews:function(){this._renderRespondBackView()},_renderRespondBackView:function(){this.$respondBack=$(".ts-rhp-respond-back-multi"),this._renderChildView("_respondBackView",n,this.$respondBack)}})}),define("viewer/views/viewer-page-view",["core/ac-core","files/ac-files","app/ac-app","viewer/ac-viewer","acplugins/tracked-send/js/tool/ac-tracked-send","core/utils/css-util","viewer/templates/viewer-page-template.html","i18n!files/nls/ui-strings","i18n!acplugins/tracked-send/js/nls/ui-strings","acplugins/tracked-send/js/utils/sc-constants","viewer/views/page-header-view","viewer/views/full-preview-tracked-send-view","viewer/views/multi-file-view","viewer/views/viewer-page-rhp-view","app/views/modal-mask-view"],function(e,i,t,s,n,o,a,r,l,c){s.ViewerPageView=e.View.extend({events:{"click .ts-viewer-download-button":"_onDownloadClick","click .report-abuse":"_onReportAbuseClick"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(a),this._addUiModelEventListeners(),this._addModelEventListeners(),this._addAppApiCallbacks(),this._addKeyEventListener(),this.on("viewer:preview-file",this._onClickPreview,this)},render:function(){var i=this.$el,t=this.options.parcelModel,s=t.get("email_message"),n=t.get("sender_email"),o=t.get("sender_name");return e.View.prototype.render.call(this),(s||n||o)&&i.addClass("respondBack"),0===this.$el.children().length&&(this.$el.html(this._template({parcelSubject:this._getParcelSubject(),downloadAll:l.DOWNLOAD_ALL,forwardLabel:l.FORWARD,notifyMeWhenViewed:l.NOTIFY_ME_WHEN_VIEWED,viewedBy:l.VIEWED_BY,viewFullActivity:l.VIEW_FULL_ACTIVITY,unshare:l.UNSHARE,reportAbuse:l.REPORT_ABUSE,back:r.BACK})),1===this.options.parcelAssetsCollection.models.length&&"plugin"!==this.options.viewMode&&(this.$(".thumbnails").css("visibility","hidden"),this.$(".parcel-container").css("background-color","#f5f5f5")),this._initWrappers(),this._updateButtonStatus(),this._checkForReportAbuseFlow(),this._renderBrandingLogo()),this._renderChildViews(),this._updateName(),this},stopListening:function(i,t,s){e.View.prototype.stopListening.call(this,i,t,s)},teardown:function(){this._removeModelEventListeners()},_addModelEventListeners:function(){this.options.parcelModel.on("change",this._onParcelChange)},_onParcelChange:function(){0!==this.$el.children().length&&this._updateButtonStatus()},_removeModelEventListeners:function(){this.options.parcelModel.off("change")},_initWrappers:function(){this.$header=this.$(".page-header"),this.$error=this.$(".page-error"),this.$pageBody=this.$(".page-body.thumbnails"),this.$fullPreview=this.$(".page-body.full-preview"),this.$thumbnails=this.$(".parcel-rendition-list"),this.$rightPanel=this.$(".parcel-rendition-list-rhp"),this.$viewedByList=this.$(".parcel-viewed-by-list"),this.$viewedByHead=this.$(".parcel-viewed-by-heading"),this.$notifyChbox=this.$(".parcel-notify-checkbox"),this.$notifyLable=this.$(".parcel-notify-checkbox-label"),this.$modalMask=$("#modal-mask"),this.$parcelBody=this.$(".page-body-container"),this.$parcelBodyHeader=this.$(".parcel-body-header"),this.$brandingLogo=this.$(".branding-logo"),this.$wrapBrandingLogo=this.$(".wrap-branding-logo"),this.$fullPreviewName=this.$(".full-preview-name"),this.$parcelActionBtns=this.$(".parcel-action-buttons"),this.$homeBtnWrapper=this.$(".full-preview-home-btn-wrapper"),this.$homeBtnWrapper.length||(this.$homeBtnWrapper=this.$(".full-preview-home-btn"))},_renderBrandingLogo:function(){var e,i=this.options.parcelModel.get("invitation"),t=new Image;1===this.options.parcelAssetsCollection.models.length||this.options.viewMode&&"plugin"===this.options.viewMode||this.options.parcelModel.get("enabled")!==!0||(this.$parcelBody.addClass("branded"),e=this.options.parcelModel.get("color"),$(t).load($.proxy(this.render,this)),t.src=this.options.itemModel.rootUrl+"a/invitation/"+i+"/asset/branding",this.$brandingLogo.append(t))},_renderChildViews:function(){return e.Features.isFeatureEnabled("ts_enable_eol_ie8and9")&&util.isIE9orBelow()?(this.$parcelBody.hide(),void this._renderUnsupportedBrowserView()):(this.$error.hide(),(this.options.parcelAssetsCollection.models.length>1||"plugin"===this.options.viewMode)&&this._renderPageHeaderView(),this._renderFullPreviewView(),this._renderModalMaskView(),(this.options.parcelAssetsCollection.models.length>1||"plugin"===this.options.viewMode)&&this._renderMultiFileView(),void this._renderRightHandPanel())},_renderUnsupportedBrowserView:function(){this.$error.show(),this._renderChildView("_unsupportedBrowserView",s.UnsupportedBrowserView,this.$error)},_renderPageHeaderView:function(){this._renderChildView("_pageHeaderView",s.PageHeaderView,this.$header)},_renderFullPreviewView:function(){this._renderChildView("_fullPreviewView",s.FullPreviewTrackedSendView,this.$fullPreview)},_renderModalMaskView:function(){var e=this.options.dialogsUiModel.getDialogCount();0===e&&this._renderChildView("_modalMaskView",s.ModalMaskView,this.$modalMask)._updateModal()},_renderMultiFileView:function(){this._renderChildView("_multiFileView",s.MultiFileView,this.$thumbnails)},_renderRightHandPanel:function(){this._renderChildView("_previewRHP",s.ViewerPageRHPView,this.$rightPanel)},_updateButtonStatus:function(){var e=this.options,i=this.$notifyChbox,t=this.$notifyLable,s=e.parcelModel.get("invitations"),n=s&&1===s.length&&"PARCEL_PUBLIC_SHARING"===s[0].recipient_email,a=!n&&e.parcelModel.get("delivery_receipts");a?(o.addClass(i,"selected"),i.prop("checked",!0)):(o.removeClass(i,"selected"),i.prop("checked",!1)),n?(o.addClass(i,"disabled"),o.addClass(t,"disabled"),i.prop("disabled",!0)):(o.removeClass(i,"disabled"),o.removeClass(t,"disabled"),i.prop("disabled",!1))},_addUiModelEventListeners:function(){var e=this.options,i=e.windowUiModel||e.appApi.windowApi.options.windowUiModel;i&&i.on("change:width",this._onWindowResize).on("change:height",this._onWindowResize)},_addAppApiCallbacks:function(){this.options.appApi.previewApi.addItemModelChangeCallback(this._onFullPreviewModelChange)},_onFullPreviewModelChange:function(e){this._toggleOverlay(e?!0:!1)},_toggleOverlay:function(e){var i=this.$pageBody,t="hidden";i&&i.length&&(e?i.addClass(t).attr("aria-hidden",!0):(i.removeClass(t).removeAttr("aria-hidden"),this.render()))},_onWindowResize:function(){if(!this._onDebouncedWindowResize){var e=this.options,i=e.windowUiModel||e.appApi.windowApi.options.windowUiModel;this._onDebouncedWindowResize=_.debounce(this.render,i.get("resize_debounce_delay"))}this._onDebouncedWindowResize()},_onDownloadClick:function(){var i={parentView:this,id:"all"};this.options.appApi.siteCatalystApi.logScEvent([c.RECVIEW,c.MULTI,c.DOWNLOAD_ALL]),this._triggerViewEvent(e.ViewEvents.DOWNLOAD,i)},_onClickPreview:function(t){var s,n,o,a=i.opFactory,r=t.fullPreviewUiModel,l={item_model:t.itemModel};n=t.itemModel.get("page_count"),o=r.get("scroll_pages_limit"),o||(o=1e3);try{e.Features.isFeatureEnabled("enable_ngsend")&&(l.enable_ngdoc=!0,l.view_type="ngdoc")}catch(c){LOG("enable_ngsend is not a feature flipper")}return l.view_format=n>o?"fit_page_width":"scroll_pages",r.set(l),this.options.appApi.siteCatalystApi.logScEvent(["RecView","Multi","Preview","Shown"]),s=a.create("OpeningFullPreviewOp",t),s.run()},_checkForReportAbuseFlow:function(){var e=this.options;"True"===e.parcelModel.get("reportabuse")&&_.defer(function(){$(".report-abuse").trigger("click")}),"plugin"===e.viewMode&&$(".report-abuse").hide()},_onReportAbuseClick:function(){var i,t={parentView:this};return this.options.parcelAssetsCollection&&this.options.parcelAssetsCollection.length>1?(i=[c.RECVIEW,c.MULTI,c.PREVIEW,c.REPORT_ABUSE],t.parcelId=this.options.parcelAssetsCollection.id):(i=[c.RECVIEW,c.SINGLE,c.REPORT_ABUSE],t.id=this.options.itemModel.id),this.options.appApi.siteCatalystApi.logScEvent(i),this._triggerViewEvent(e.ViewEvents.SHOW_REPORT_ABUSE_DLG,t),!1},_getParcelSubject:function(){return _.escape(this.options.parcelModel.get("email_subject"))},_getNameWidth:function(){var e=o.getFullWidth(this.$parcelBodyHeader)-o.getFullWidth(this.$wrapBrandingLogo)-o.getExtraWidth(this.$fullPreviewName)-o.getFullWidth(this.$homeBtnWrapper)-o.getFullWidth(this.$parcelActionBtns);return e},_updateName:function(){var e=this.$fullPreviewName;e&&e.length&&(this.$fullPreviewName.text(this._getParcelSubject()),this._truncateName())},_truncateName:function(){function i(){return truncate.getTextSize(s).width-t}var t=this._getNameWidth(),s=this.$fullPreviewName;"ja-jp"===e.Locale.getLocale()&&(t*=.85,t=Math.floor(t)),!isNaN(t)&&t>0&&truncate.truncateToFit(s,i)},_onKeyPress:function(e){var i=$(e.target),t=e.charCode||e.keyCode,s=!1;return 13!==t&&32!==t||!i.is("[role='button']:not([aria-disabled='true']):not(:disabled)")||(i.trigger("click"),s=!0),s}})}),define("acplugins/signatures/js/templates/parcel-preview-rhp-template",[],function(){return'    <div class="parcel-topic-message-heading" role="heading" level="2"><%= emailHeading %></div>   <div class="parcel-message"><%- emailMessage %></div>   <div role="grid">       <div role="row">           <div class="parcel-viewed-by-heading" role="columnheader">               <%= viewedBy %>           </div>           <div class="hidden-accessible" role="columnheader">               <%= views %>           </div>       </div>       <div role="presentation" class="parcel-viewed-by-list">       </div>   </div>   <div role="button" tabindex="0" class="parcel-activity-btn">       <span class="parcel-activity-btn-label"><%= viewFullActivity %></span>   </div>   <div class="parcel-notify">       <input type="checkbox" class="parcel-notify-checkbox core-checkbox"              id="parcel-notify-checkbox" />       <span class="parcel-notify-checkbox-checkmark" aria-hidden="true"></span>       <div class="parcel-notify-checkbox-label">           <label for="parcel-notify-checkbox"><%= notifyMeWhenViewed %></label>       </div>   </div> '}),define("acplugins/signatures/js/templates/viewer-page-recipient-template.html",[],function(){return'<div role="row" class="parcel-viewed-by-item">        <div role="gridcell" class="parcel-viewed-by-email">            <%= email %>            <% if (typeof(url) != "undefined") { %><a href="<%= url %>" target="_blank"><% } %>            <% if (typeof(url) != "undefined") { %><%= openLink %><% } %>            <% if (typeof(url) != "undefined") { %></a><% } %>        </div>        <div role="gridcell" class="parcel-viewed-by-count"><%= count %></div>    </div>'
}),define("acplugins/signatures/js/views/parcel-preview-rhp-view",["core/ac-core","app/ac-app","files/ac-files","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/parcel-preview-rhp-template","acplugins/signatures/js/templates/viewer-page-recipient-template.html","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/css-util","core/utils/view-util","acplugins/signatures/js/utils/sc-constants"],function(e,i,t,s,n,o,a,r,l,c){s.ParcelPreviewRHPView=e.View.extend({events:{"click .parcel-notify-checkbox":"_onDeliveryReceiptsClick","click .parcel-notify-checkbox-label":"_onDeliveryReceiptsClick","click .parcel-activity-btn":"_onActivityBtnClick","keydown .parcel-activity-btn":"_onActivityBtnClick"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(n),this._recipientTemplate=_.template(o),this._addModelEventListeners()},render:function(){var i=this.options.parcelModel;e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({notifyMeWhenViewed:a.NOTIFY_ME_WHEN_VIEWED,viewedBy:a.VIEWED_BY,viewFullActivity:a.VIEW_FULL_ACTIVITY,publicLink:a.PARCEL_PUBLIC_SHARING,openLink:a.OPEN_LINK,emailHeading:a.MESSAGE_HEADING,emailTopic:i.get("email_subject"),emailMessage:i.get("email_message"),views:a.VIEWS})),this._initWrappers(),this._renderRightPanelItems()),this._updateButtonStatus()},_addModelEventListeners:function(){this.options.parcelModel.on("change",this._onParcelChange)},_onParcelChange:function(){this._updateButtonStatus()},_removeModelEventListeners:function(){this.options.parcelModel.off("change")},_initWrappers:function(){this.$viewedByList=this.$(".parcel-viewed-by-list"),this.$viewedByHead=this.$(".parcel-viewed-by-heading"),this.$notifyChbox=this.$(".parcel-notify-checkbox"),this.$notifyLable=this.$(".parcel-notify-checkbox-label"),this.$parcelTopicMessageHeading=this.$(".parcel-topic-message-heading"),this.$parcelMessage=this.$(".parcel-message")},_renderRightPanelItems:function(){var e,i,t,s,n=this.options.parcelModel,o=n.get("invitations"),r=[],l=!1;o=_.sortBy(o,function(e){return e.recipient_email}),_.each(o,function(n){e=n.event_counts.parcel_view||0,"PARCEL_PUBLIC_SHARING"===n.recipient_email?(s=n.preview_url,t=this._recipientTemplate({email:a.PARCEL_PUBLIC_SHARING,openLink:a.OPEN_LINK,count:e,url:s})):(l=!0,i=this._recipientTemplate({email:_.escape(n.recipient_email),count:e}),r.push(i))},this),t&&r.push(t),this.$viewedByList.append(r),l||(this.$parcelTopicMessageHeading.hide(),this.$parcelMessage.hide())},_updateButtonStatus:function(){var e=this.options,i=this.$notifyChbox,t=this.$notifyLable,s=e.parcelModel.get("invitations"),n=s&&1===s.length&&"PARCEL_PUBLIC_SHARING"===s[0].recipient_email,o=!n&&e.parcelModel.get("delivery_receipts");o?(r.addClass(i,"selected"),i.prop("checked",!0)):(r.removeClass(i,"selected"),i.prop("checked",!1)),l.enableInput(i,!n),n?r.addClass(t,"disabled"):r.removeClass(t,"disabled")},_onActivityBtnClick:function(e){var i,t,n,o=this.options;return"keydown"===e.type&&13!==e.which&&32!==e.which?!0:(t=_.extend(this.options,{parentView:this}),delete t.el,i=new s.ParcelActivityDlg(t),i.open(),n=o.parcelAssetsCollection&&o.parcelAssetsCollection.length>1?c.MULTI:c.SINGLE,void o.appApi.siteCatalystApi.logScEvent([c.PREVIEW,c.SHARED,n,c.VIEW_FULL_ACTIVITY]))},_onDeliveryReceiptsClick:function(){var e,i,t=this.options,n=t.parcelModel.get("invitations"),o=1===n.length&&"PARCEL_PUBLIC_SHARING"===n[0].recipient_email,a=!t.parcelModel.get("delivery_receipts");if(!o)return this._setCheckboxSelectionStatus(a),e=t.parcelAssetsCollection&&t.parcelAssetsCollection.length>1?c.MULTI:c.SINGLE,t.appApi.siteCatalystApi.logScEvent([c.PREVIEW,c.SHARED,e,c.NOTIFY_WHEN_VIEWED,a?c.CHECKED:c.UNCHECKED]),i=s.opFactory.create("SettingDeliveryReceiptsOp",{parcelModel:this.options.parcelModel,deliveryReceipts:a}),i.run().fail(_.bind(function(){this._setCheckboxSelectionStatus(!a)},this))},_setCheckboxSelectionStatus:function(e){var i=this.$(".parcel-notify-checkbox");e?(r.addClass(i,"selected"),i.prop("checked",!0)):(r.removeClass(i,"selected"),i.prop("checked",!1))}})}),define("acplugins/signatures/js/views/parcel-preview-view",["core/ac-core","app/ac-app","files/ac-files","acplugins/signatures/js/ac-signature","viewer/ac-viewer","core/utils/view-util","acplugins/signatures/js/utils/sc-constants","acplugins/signatures/js/ops/manipulation/unshare-one-parcel-op","acplugins/signatures/js/ops/manipulation/unshare-one-if-confirmed-op","acplugins/signatures/js/views/parcel-activity-dlg","viewer/views/viewer-page-view","viewer/collections/parcel-asset-collection","core/models/ui/error-ui-model","core/models/ui/full-preview-ui-model","core/models/ui/plugins-ui-model","app/models/ui/modal-mask-ui-model","acplugins/signatures/js/views/parcel-preview-rhp-view"],function(e,i,t,s,n,o,a){s.ParcelPreviewView=n.ViewerPageView.extend({events:{"click .parcel-preview-home-btn":"_onHomeBtnClick","click .tracked-send-forward-btn":"_onForwardClick","click .tracked-send-unshare-btn":"_onUnshareClick","click .parcel-viewed-by-email":"_onPublicLinkClick"},initialize:function(){this.options.viewMode="plugin",this.options.errorUiModel=e.uiModelFactory.create("ErrorUiModel"),this.options.fullPreviewUiModel=e.uiModelFactory.create("FullPreviewUiModel"),this.options.fullPreviewPluginsUiModel=e.uiModelFactory.create("PluginsUiModel"),this.options.fullPreviewOverlaysUiModel=e.uiModelFactory.create("PluginsUiModel"),this.options.modalMaskUiModel=i.uiModelFactory.create("ModalMaskUiModel"),this.options.fullPreviewUiModel.set({standalone:!1,read_only:!1}),n.ViewerPageView.prototype.initialize.call(this),this.on(t.ViewEvents.FULL_PREVIEW_CLOSE,this._onFullPreviewClose,this)},render:function(){var e=this.options.parcelModel.id,i=s.PLUGIN_ID+"/"+e;n.ViewerPageView.prototype.render.call(this),this.options.appApi.routerApi.navigate(i)},_renderChildViews:function(){this._renderPageHeaderView(),this._renderFullPreviewView(),this._renderModalMaskView(),this._renderMultiFileView(),this._renderRightHandPanel()},_renderRightHandPanel:function(){this._renderChildView("_previewRHP",s.ParcelPreviewRHPView,this.$rightPanel)},_onFullPreviewClose:function(){t.opFactory.create("ClosingFullPreviewOp",this.options).run()},closeWithoutResolving:function(){this.applyMethodRecursively("undelegateEvents"),this.applyMethodRecursively("stopListening"),this._triggerViewEvent("ParcelPreview_Close")},_initWrappers:function(){n.ViewerPageView.prototype._initWrappers.call(this),this.$unshareButton=this.$(".tracked-send-unshare-btn")},_updateButtonStatus:function(){n.ViewerPageView.prototype._updateButtonStatus.call(this),o.enableInput(this.$unshareButton,this.options.parcelModel.get("is_active"))},_onClickPreview:function(e){var i=e.itemModel;this.options.appApi.routerApi.navigate("/file/"+i.id,{trigger:!0}),this.closeWithoutResolving()},_onHomeBtnClick:function(e){e.preventDefault(),this.closeWithoutResolving(),this.options.appApi.routerApi.navigate(s.PLUGIN_ID)},_onForwardClick:function(){var e,i=this.options,t="/send/parcel/"+i.parcelModel.id;i.appApi.routerApi.navigate(t,{trigger:!0}),this.closeWithoutResolving(),e=i.parcelAssetsCollection&&i.parcelAssetsCollection.length>1?a.MULTI:a.SINGLE,i.appApi.siteCatalystApi.logScEvent([a.PREVIEW,a.SHARED,e,a.PREVIEW,a.RHP,a.SHARE_FILE_BUTTON])},_onPublicLinkClick:function(){var e;e=this.options.parcelAssetsCollection&&this.options.parcelAssetsCollection.length>1?a.MULTI:a.SINGLE,this.options.appApi.siteCatalystApi.logScEvent([a.PREVIEW,a.SHARED,e,a.PUBLIC_LINK])},_onUnshareClick:function(){var e,i,t;this.$unshareButton.hasClass("disabled")||(t=this.options.parcelAssetsCollection&&this.options.parcelAssetsCollection.length>1?a.MULTI:a.SINGLE,this.options.appApi.siteCatalystApi.logScEvent([a.PREVIEW,a.SHARED,t,a.UNSHARE]),i=_.extend(this.options,{itemModel:this.options.parcelModel}),e=new s.UnshareOneIfConfirmedOp(i),e.run())}})}),define("acplugins/signatures/js/ops/getting/getting-assets-op",["core/ac-core","acplugins/signatures/js/ac-signature","core/ops/op","viewer/collections/parcel-asset-collection"],function(e,i){i.GettingAssetsOp=e.Op.extend({run:function(){var e=this.options.parcelAssetsCollection;return e.fetch()}})}),define("acplugins/signatures/js/views/parcels-list-view",["core/ac-core","acplugins/signatures/js/ac-signature","viewer/ac-viewer","core/utils/view-util","core/utils/css-util","acplugins/signatures/js/utils/sc-constants","acplugins/signatures/js/utils/ts-utils","core/utils/sc-analytics","i18n!acplugins/signatures/js/nls/ui-strings","core/models/workflow-status-strings","acplugins/signatures/js/utils/sign-workflow-utils","acplugins/signatures/js/models/ui/parcels-list-item-ui-model","acplugins/signatures/js/views/parcels-list-item-view","acplugins/signatures/js/views/parcel-preview-view","acplugins/signatures/js/ops/getting/getting-assets-op"],function(e,i,t,s,n,o,a,r,l,c,d){i.ParcelsListView=e.View.extend({events:{"click .signature-list-item":"_onItemClick","dblclick .signature-list-item":"_onItemDblClick","keyClick .signature-list-item":"_onItemKeyClick"},initialize:function(){e.View.prototype.initialize.call(this),this.listenTo(this.options.collectionsUiModel,"change:checkbox",_.bind(function(){this.render()},this)),this._addKeyEventListener(),this._addFocusEventListener(),this.bIsSingleClickEventWaiting=!1},findEmptyStates:function(){if(this.options.isInSearchResultsView!==!0){this.options.parcelCollection.emptyState={};for(var e=this.options.parcelCollection.emptyState,i=this.options.parcelCollection.models,t=0;t<i.length;t++){var s=d.convertToNativeRSState(i[t].attributes.signature_info.state);null!=e&&e.hasOwnProperty(s)||(e[s]=!1)}}},showEmptyStatePage:function(){var e=this.options.parcelCollection.leftRailFilter;$(".on-signed-in").hide(),$(".on-signed-out").show(),$(".sign-workflow-name").text(d.getUIStringFromStatusID(e)),$(".shared-on-sign-out-prompt").text(d.getPromptMsgFromStatusID(e)),$(".shared-on-sign-out-subprompt").text(d.getSubPromptMsgFromStatusID(e)),$(".shared-offline-icon").removeClass("shared-offline-signtemplate-icon"),$(".one_table").removeClass("div-nativers-table"),$(".one_row").removeClass("div-nativers-table-row"),$(".lhs_space").removeClass("div-nativers-table-col"),$(".on-signed-out").removeClass("div-nativers-table-col"),$(".on-signed-out").removeClass("div-nativers-nativers-library-template"),1==i.SignWorkflowUtil.isNativeRSLeftRailID(e)&&($(".one_table").addClass("div-nativers-table"),$(".one_row").addClass("div-nativers-table-row"),$(".lhs_space").addClass("div-nativers-table-col"),$(".on-signed-out").addClass("div-nativers-table-col")),this.options.appApi.selectionApi.isRunningInFileSelection()===!0&&this.options.appApi.saveAsApi.isCalledFromNativeRS()===!0&&e===o.TEMPLATES?($(".on-signed-out").addClass("div-nativers-nativers-library-template"),$(".shared-offline-icon").addClass("shared-offline-signtemplate-icon"),$(".shared-on-sign-out-prompt").hide(),$(".shared-on-sign-out-button").hide()):e===o.TEMPLATES?($(".on-signed-out").addClass("div-nativers-nativers-library-template"),$(".shared-offline-icon").addClass("shared-offline-signtemplate-icon"),$(".shared-on-sign-out-button").text(l.CREATE_ESIGN_TEMPLATE),$(".shared-on-sign-out-button").show()):e===o.ALL||e===o.IN_PROGRESS?($(".shared-on-sign-out-button").text(l.REQUEST_ESIGN),$(".shared-on-sign-out-button").show()):$(".shared-on-sign-out-button").hide()},checkEmptyStatePage:function(){if(this.options.isInSearchResultsView===!0)return!1;var e=this.options.parcelCollection.leftRailFilter,t=i.SignWorkflowUtil.isNativeRSLeftRailID(e);if("signatures"==e||!t){var s="[RS LISTING] checkEmptyStatePage returning false for currLeftRailFilter:"+e;return this.options.appApi.acroLogApi.ACRO_DEBUG(s),!1}var n=this.options.parcelCollection.emptyState;if(e!=o.ALL&&(null==n||!n.hasOwnProperty(e))){var s="[RS LISTING] checkEmptyStatePage returning true  for currLeftRailFilter:"+e;return this.options.appApi.acroLogApi.ACRO_DEBUG(s),this.showEmptyStatePage(),!0}return!1},render:function(){return e.View.prototype.render.call(this),this.findEmptyStates(),this._asyncSetLeftRailFilterID().then(_.bind(function(){this.checkEmptyStatePage()||(this._renderChildViews(),e.Util.isCEF()||this._updateForVerticalScrollBar())},this)),this},_asyncSetLeftRailFilterID:function(){var e=$.Deferred();return this.options.appApi.selectionApi.isRunningInFileSelection()?(this.options.parcelCollection.leftRailFilter=o.TEMPLATES,$(".signature-workflow-name").text(this._getHeaderText(o.TEMPLATES)),e.resolve(),e.promise()):(_.defer(_.bind(function(){this.options.appApi.rnaApi.done(_.bind(function(){this.options.appApi.rnaApiObj.esApi.getActiveAgreementFilter().then(_.bind(function(i){this.options.parcelCollection.leftRailFilter="",void 0!=i&&i.length>0&&(this.options.parcelCollection.leftRailFilter=i,$(".signature-workflow-name").text(this._getHeaderText(i))),e.resolve()},this))},this))},this)),e.promise())},_getHeaderText:function(e){if(this.options.isInSearchResultsView===!0)return l.AGREEMENT_HEADER;var t=i.SignWorkflowUtil.isNativeRSLeftRailID(e);return t&&e!=o.ALL?d.getUIStringFromStatusID(e):l.AGREEMENT_HEADER},_updateForVerticalScrollBar:function(){setTimeout(_.bind(function(){this.$el.length&&this.options.collectionUiModel.set("has_vertical_scrollbar",s.isVerticalScrollBarPresent(this.$el))},this),50)},_getEventTargetItem:function(e,i){return $(e.target).closest(i)},_getEventTargetView:function(e,i){var t,s;return i||(i=".signature-list-item"),s=this._getEventTargetItem(e,i),s&&(t=this.getChildViewById(s.data("id"))),t},_getEventTargetId:function(e,i){var t,s=this._getEventTargetItem(e,i);return s&&(t=s.data("id")),t},_getViewEventOptions:function(e){return{collectionItemsView:this,itemView:this._getEventTargetView(e)}},_addKeyEventListener:function(){this.options.appApi.keyApi.pushKeyHandler(this)},_removeKeyEventListener:function(){this.options.appApi.keyApi.popKeyHandler(this)},_selectType:function(i){this._triggerViewEvent(e.ViewEvents.SELECT_ITEM,{collectionItemsView:this,selectType:i})},_onExpandClick:function(i){var t=this._getEventTargetView(i);t.onExpandButtonClick(i),e.Util.isCEF()||this._updateForVerticalScrollBar()},showParcelPreview:function(e){var s,n,r,l,c,d,p=this.options,h=p.appApi;s=h.displayApi.showFullOverlay(!0),l=this.options.appApi.baseFilesUrisApi.getSendApiUri(),l=a.extractRootUrl(l),p.parcelAssetsCollection=new t.ParcelAssetCollection([],{rootUrl:l,parcel_id:e.id,parcelModel:e}),this._parcelPreview&&this._parcelPreview.off(),n=_.extend({},p,{el:s,parcelModel:e}),r=new i.ParcelPreviewView(n),this._parcelPreview=r,r.on("ParcelPreview_Close",this._onParcelPreviewClose,this),d=i.opFactory.create("GettingAssetsOp",p),d.run().then(_.bind(function(){c=p.parcelAssetsCollection&&p.parcelAssetsCollection.length>1?o.MULTI:o.SINGLE,h.siteCatalystApi.logScEvent([o.PREVIEW,o.SHARED,c,o.SHOWN]),this.render()},r))},_handleModifiedClick:function(i){var t,s;s=i.shiftKey?e.SelectionUiModel.SELECT_EXTEND:i.ctrlKey||i.metaKey?e.SelectionUiModel.SELECT_TOGGLE:e.SelectionUiModel.SELECT_SELECT,t=this._getViewEventOptions(i),_.extend(t,{selectType:s}),this._triggerViewEvent(e.ViewEvents.SELECT_ITEM,t)},_onItemClick:function(e){this.bIsSingleClickEventWaiting=!0,setTimeout(_.bind(function(){if(1==this.bIsSingleClickEventWaiting){var i=this._getEventTargetItem(e,".parcel-list-item");this.bIsSingleClickEventWaiting=!1,this._selectItemRow(e),this._consumeEvent(e),this._scrollItemIntoView(i)}},this),500)},_onItemKeyClick:function(e){this._delayedKeyClickTimer&&clearTimeout(this._delayedKeyClickTimer),this._delayedKeyClickTimer=_.defer(_.bind(function(){var i=this._getEventTargetItem(e,".parcel-list-item");this._selectItemRow(e),this._consumeEvent(e),this._scrollItemIntoView(i)},this),e)},_onItemDblClick:function(e){this.options.appApi.selectionApi.isRunningInFileSelection()||(this.bIsSingleClickEventWaiting=!1,this.$(".shared-workflow-list-item.selected").removeClass("selected"),this._doOpenFile(e),this.$(".shared-workflow-list-item.selected").find(".shared-list-item-row").focus(),this._consumeEvent(e))},_openSignAgreement:function(e){return this.options.esInitialized||i.opFactory.create("InitializeEchoSignOp",this.options).run(),this.options.appApi.siteCatalystApi.logScEvent([r.SIGN_FILES_HOME_VIEW,r.CLICKED]),this.options.appApi.siteCatalystApi.logVirgoFileOpenEvent(r.VIRGO_SIGN),i.opFactory.create("OpenSignAgreementOp",this.options).run({model:e})},_onSignButtonClick:function(e){var i;if(i=this._getEventTargetView(e)){var t=i.model;t&&this._openSignAgreement(t)}},_doOpenFile:function(e){var i;if(i=this._getEventTargetView(e)){var t=i.model;t&&this._openSignAgreement(t)}},_deselectAll:function(i){this._triggerViewEvent(e.ViewEvents.SELECT_ITEM,_.extend(i,{selectType:e.SelectionUiModel.SELECT_NONE}))},_selectItemRow:function(i){var t,s,n=this._getEventTargetItem(i,".signature-list-item");s=n.hasClass("selected"),t=s?e.SelectionUiModel.SELECT_TOGGLE:e.SelectionUiModel.SELECT_SELECT;var o=this._getViewEventOptions(i);_.extend(o,{selectType:t}),this._consumeEvent(i),this._triggerViewEvent(e.ViewEvents.SELECT_ITEM,o)},_onParcelPreviewClose:function(){_.defer(_.bind(function(){var e=this._parcelPreview;e.off(),this.options.appApi.displayApi.showFullOverlay(!1),delete this._parcelPreview},this))},_renderChildViews:function(){var e=this.collection.length;this._renderInProgress||(this._renderInProgress=!0,this._asyncBeginRenderingListItems().then(_.bind(this._asyncRenderListItems,this,0,e,10)).then(_.bind(this._asyncEndRenderingListItems,this)).then(_.bind(function(){this._renderInProgress=!1,this.collection.length>0&&$("#parcels-no-parcels-prompt-sign").hide()},this)))},_beginRenderingListItems:function(){var e=this.getChildViews();_.each(e,function(e){e.options.remove=!0})},_asyncBeginRenderingListItems:function(){var e=$.Deferred();return _.defer(_.bind(function(){this._beginRenderingListItems(),e.resolve()},this)),e.promise()},_endRenderingListItems:function(){var e,i,t,s=this.getChildViews(),n=this.$el.children();for(i=s.length-1;i>=0;i-=1)e=s[i],e.options.remove&&(e.$item.hasClass("selected")&&this._clearSelection(this.options),this.removeChildView(e));for(n=this.$el.children(),t=this.collection.length-1,i=n.length-1;i>t;i-=1)n.eq(i).remove();this._setTabbableItem()},_asyncEndRenderingListItems:function(){var e=$.Deferred();return _.defer(_.bind(function(){this._endRenderingListItems(),e.resolve()},this)),e.promise()},_renderSomeListItems:function(e,i){var t,s,n=this.$el.children(),o=n.length,a=e;this.collection.each(function(r,l){l>=e&&i>l&&(t=this._getChildItemView(r),s=o>a?n.eq(a):void 0,t.render(s,a),delete t.options.remove,a+=1)},this)},_asyncRenderSomeListItems:function(e,i){var t,s=$.Deferred();return t=_.bind(function(e,i){this._renderSomeListItems(e,i),s.resolve()},this,e,i),t(),s.promise()},_asyncRenderListItems:function(e,i,t){return i>e?this._asyncRenderSomeListItems(e,e+t).then(_.bind(this._asyncRenderListItems,this,e+t,i,t)):this._getResolvedPromise()},_getChildItemView:function(e){var t,s,n=this.options,o=e.id,a=this.$el;return t=this.getChildViewById(o),t?(t.$el!==a&&t.setElement(a),_.extend(t.model.attributes,e.attributes),t.options.checkbox=n.collectionsUiModel.get("checkbox")):(s=new i.ParcelsListItemUiModel,n=_.extend({},n,{el:a,checkbox:n.collectionsUiModel.get("checkbox"),model:e,itemUiModel:s}),t=new i.ParcelsListItemView(n),this.addChildView(t,o)),t},_getContainingItem:function(e){return e.closest(".signature-list-item")},_getContainingRowOrRowGroup:function(e){return e.closest(".signature-list-item-row")},_isItemSelected:function(e){return this._getContainingItem(e).hasClass("selected")},_logScSelectionEvent:function(e,i){var t;t=this._isItemSelected(e),t!==i&&this.options.appApi.siteCatalystApi.logScEvent([o.FILE_LIST,o.SENT_FILES,o.FILE_NAME,t?o.CHECKED:o.UNCHECKED])},_getChildViewHeight:function(){var e=this.$el.children();return e.length>0?n.getFullHeight(e.eq(0)):void 0},_getChildViewWidth:function(){var e=this.$el.children();return e.length>0?n.getFullWidth(e.eq(0)):void 0},_isListView:function(){return this.options.collectionsUiModel.isListView()},_isThumbnailView:function(){return this.options.collectionsUiModel.isThumbnailView()},_scrollItemIntoView:function(e){function i(e){t.stop(!0,!0),t.animate({scrollTop:e},l.get("scroll_duration"))}var t,s,n,o,a,r,l=this.options.collectionsUiModel;e.length&&(t=this.$el,s=e.position().top,n=e.height(),o=t.height(),this._isMouseWheel||(0>s||s+n>o)&&(a=t.scrollTop(),r=s-(o-n)/2,i(Math.max(a+r,0))))},_onFocusIn:function(e){var i,t,s,n=$(e.target);return i=this.$(".signature-list-item-row"),t=this._getContainingRowOrRowGroup(n),s=i.index(t),this._lastActiveRowIndex===s&&this._consumeEvent(e),0===t.length?!0:(i.attr("tabindex",-1),t.hasClass("focused")||(t.addClass("focused").attr("tabindex",0),n.attr("tabindex",0)),this._lastActiveRowIndex!=i.index(t)&&(this._lastActiveRowIndex=i.index(t)),this._consumeEvent(e),this.$el.scrollLeft(0),!0)},_onFocusOut:function(e){var i,t=$(e.target);return i=this._getContainingRowOrRowGroup(t),i.removeClass("focused").find("[role=checkbox]:tabbable, button:tabbable, a[href]:tabbable, [role=link]:tabbable").attr("tabindex",-1),!0},_setTabbableItem:function(){var e=this.$(".signature-list-item-row:focusable"),i=this.$(":tabbable");0===i.length&&e.attr("tabindex","0")},_getNextFocusableIndexForThumbnailView:function(e,i,t,s){var n=i,o=e.width()/$(".shared-thumb-view .signature-list-item").outerWidth(!0)|0,a=Math.ceil(t/o),r=i/o|0,l=i%o;switch(s){case 39:i!=t-1&&(n=i+1);break;case 37:0!=i&&(n=i-1);break;case 38:0!=r&&(n=o*(r-1)+l);break;case 40:r!=a-1&&(n=o*(r+1)+l)}return n>t-1&&(n=i),n},_onKeyDown:function(i){function t(e){r.stop(!0,!0),r.animate({scrollTop:e},v.get("scroll_duration"))}var n,o,a=$(i.target),r=this.$el,l=r[0],c=this.options,d=c.appApi.selectionApi,p=i.which,h=r.height(),u=r.width(),_=r?r.scrollTop():0,g=this._getChildViewHeight(),E=this._getChildViewWidth(),m=0,S=0===g?0:Math.floor(h/g),A=0===E?0:Math.floor(u/E),f=!1,v=this.options.collectionsUiModel,w=this.options.selectionUiModel,I=this.$(".signature-list-item-row"),T=this._getContainingRowOrRowGroup(a),C=T.find(".list-item-checkbox"),R=I.first(),N=I.last(),b=r.find(":tabbable").first(),O=a.is(T),L=!T.is(a),P=a.is("a[href], [role=link]"),y=a.is(".signature-list-item-expand-hitarea,.signature-list-item-expand-btn"),D=I.index(T),M=($.Event("click"),$.Event("dblclick")),F=$.Event("keyClick"),V=s.descendantHasFocus(".signature-parcels-content"),U=s.descendantHasFocus(r),k=!U&&V,x=!1,G=T.hasClass("expanded"),B=T.find(".signature-list-item-files"),H=this._isListView(),j=this._isThumbnailView(),W=!1,Y=a.is("body")&&x?!0:!1;if(g&&(H?m=S:j&&(m=S*A)),s.isElementHidden(r))return f;if(a.is(":focusable")&&!V)return f;switch(c=this._getViewEventOptions(i),F.shiftKey=i.shiftKey,p){case 9:if(0===w.getNumSelectedItems()&&O);else if(this._setTabbableItem(),k){var z=$(".signature-list-header-info-container").find(":tabbable"),K=z.index(a);K==z.length-1&&(o=0===w.getNumSelectedItems()?R:b?b:R,W=!0)}else Y&&(o=b?b:R);break;case 32:U&&(P?(a.trigger(M),f=!0):y?a.hasClass("signature-list-item-row")&&(a.trigger(F),f=!0):((i.shiftKey?T:C).trigger(F),f=!0));break;case 13:U&&(e.Util.isCEF()?(1===w.getNumSelectedItems()&&(n=w.getSingleSelectedItemModel(),this._openSignAgreement(n)),this._consumeEvent(i)):(a.trigger(F),f=!0));break;case 27:!e.Util.isCEF()||d.isRunningInFileSelection()||this.options.isInSearchResultsView&&!w.isItemSelected()||(this._deselectAll(c),f=!0);break;case 33:U?o=I.eq(Math.max(0,D-m)):(t(_-h),f=!0);break;case 34:U?o=I.eq(Math.min(I.length-1,D+m)):(t(_+h),f=!0);break;case 35:t(l.scrollHeight),f=!0,T.is(N)||(o=N);break;case 36:t(0),f=!0,T.is(R)||(o=R);break;case 37:case 39:U&&(x=37===p,j?(G&&L&&(o=s.getNextFocusableDescendant(B,!0)),o&&o.length||(L?o=T:O&&(o=I.eq(this._getNextFocusableIndexForThumbnailView(r,D,I.length,p)),W=!0,o&&o.hasClass("expanded")&&(o=o.find(":focusable:last"))))):(i.ctrlKey||i.metaKey)&&T.is("[aria-expanded]")?(G&&x||!G&&!x)&&(T.find("button").trigger(F),f=!0):a.hasClass("signature-list-item-file-name")||(o=s.getNextFocusableDescendant(T,x,!0,":not(.signature-list-item-file-name)")));break;case 38:U?(G&&L&&(o=s.getNextFocusableDescendant(B,!0)),o&&o.length||(L?o=T:O&&(j?(o=I.eq(this._getNextFocusableIndexForThumbnailView(r,D,I.length,p)),W=!0):D>0&&(o=I.eq(D-1),W=!0),o&&o.hasClass("expanded")&&(o=o.find(":focusable:last"))))):g&&!k&&(t(_-g),f=!0);break;case 40:U?(G&&(o=s.getNextFocusableDescendant(B)),o&&o.length||(j?(o=I.eq(this._getNextFocusableIndexForThumbnailView(r,D,I.length,p)),W=!0):D<I.length-1&&(o=I.eq(D+1),W=!0))):g&&!k&&(t(_+g),f=!0);break;case 65:(i.ctrlKey||i.metaKey)&&(i.shiftKey?this._clearSelection(c):this._selectAll(c),this._consumeEvent(i),f=!0);break;case 68:break;case 127:case 46:}return o&&o.length>0&&(f=!0,this._isItemSelected(T)&&i.shiftKey?o.trigger(F):1!=W||o.parent().hasClass("selected")||(this.$(".shared-workflow-list-item.selected").removeClass("selected"),o.trigger(F)),o.focus()),f},_selectAll:function(i){_.extend(i,{selectType:e.SelectionUiModel.SELECT_ALL}),this._triggerViewEvent(e.ViewEvents.SELECT_ITEM,i)},_clearSelection:function(i){this._triggerViewEvent(e.ViewEvents.CLEAR_SELECTION,i)},_deleteIfSelected:function(){var e,t=this.options;return e=t.selectionUiModel.getNumSelectedItems()>0,e&&this._triggerViewEvent(i.ViewEvents.DELETE,{parentView:this}),e}})}),define("acplugins/signatures/js/templates/parcels-list-header-template.html",[],function(){return'<div role="columnheader">    <div role="checkbox"         class="list-header-checkbox hidden"         title="<%=SELECT_ALL%>"         tabindex="0"></div></div><div role="presentation" class="agreement-list-header-info-container">   <div role="columnheader" class="parcel-list-header-name shared-workflow-files-header-column name">       <button class="shared-workflow-files-header-column-title parcel-list-header-name-title workflow-files-header-column-sort-text-theme name" aria-label="<%= NAME_T %>" title="<%= NAME_T %>" tabindex="0" ></button>       <div class="parcel-list-header-name-sort virgo-sort descending shared-workflow-files-header-column-sort name" tabindex="0"></div>   </div>   <div role="columnheader" class="parcel-list-header-modified shared-workflow-files-header-column create_date">       <button class="shared-workflow-files-header-column-title parcel-list-header-modified-title workflow-files-header-column-sort-text-theme create_date"  aria-label="<%= MODIFIED_DATE_T %>" title="<%= MODIFIED_DATE_T %>" tabindex="0"></button>       <div class="parcel-list-header-modified-sort virgo-sort descending shared-workflow-files-header-column-sort create_date" tabindex="0"></div>   </div>   <div role="columnheader" class="parcel-list-header-sender shared-workflow-files-header-column initiator">       <button class="shared-workflow-files-header-column-title parcel-list-header-sender-title workflow-files-header-column-sort-text-theme initiator"  aria-label="<%= SENDER_T %>" title="<%= SENDER_T%>" tabindex="0"></button>       <div class="parcel-list-header-sender-sort virgo-sort descending shared-workflow-files-header-column-sort initiator" tabindex="0"></div>   </div>   <div role="columnheader" class="parcel-list-header-status shared-workflow-files-header-column status">       <button class="shared-workflow-files-header-column-title parcel-list-header-status-title workflow-files-header-column-sort-text-theme status"  title="<%= STATUS_T%>" aria-label="<%= STATUS_T%>"></button>       <div class="parcel-list-header-status-sort virgo-sort descending shared-workflow-files-header-column-sort status" tabindex="0"></div>   </div>   <div class="sign-files-sort-menu shared-files-sort-menu menu ui-theme dropdown-background-theme dropdown-border-theme" role="menu">           <div class="shared-files-sort-menu-title cb-text-theme"><%= SORT_BY %></div>           <div class="shared-files-sort-menu-items drop-down-text-theme theme-list-item-row name"  aria-label="<%= NAME %>" title="<%= NAME %>" tabindex="-1">               <div class="shared-files-sort-menu-name"><%= NAME %></div>               <div class="shared-files-sort-menu-items-tick-icon name-tick-icon"></div>           </div>           <div class="shared-files-sort-menu-items drop-down-text-theme theme-list-item-row create_date"  aria-label="<%= CREATE_DATE %>" title="<%= CREATE_DATE %>" tabindex="-1">               <div class="shared-files-sort-menu-name"><%= CREATE_DATE %></div>               <div class="shared-files-sort-menu-items-tick-icon create-date-tick-icon"></div>           </div>           <div class="shared-files-sort-menu-items drop-down-text-theme theme-list-item-row initiator"  aria-label="<%= SENDER %>" title="<%= SENDER %>" tabindex="-1">               <div class="shared-files-sort-menu-name"><%= SENDER %></div>               <div class="shared-files-sort-menu-items-tick-icon initiator-tick-icon"></div>           </div>           <div class="shared-files-sort-menu-items drop-down-text-theme theme-list-item-row status"  aria-label="<%= STATUS %>" title="<%= STATUS %>" tabindex="-1">               <div class="shared-files-sort-menu-name"><%= STATUS %></div>               <div class="shared-files-sort-menu-items-tick-icon status-tick-icon"></div>           </div>    </div></div>'}),define("acplugins/signatures/js/views/parcels-list-header-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/parcels-list-header-template.html","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/truncate","core/utils/view-util","acplugins/signatures/js/utils/sc-constants","core/models/workflow-status-strings","i18n!core/nls/ui-strings","core/utils/event-util","core/utils/sc-analytics"],function(e,i,t,s,n,o,a,r,l,c,d){i.ParcelsListHeaderView=e.View.extend({events:{"click .list-header-checkbox":"_onCheckboxClick","click .agreement-list-header-info-container":"_onHeaderClick","click .sign-files-sort-menu":"_onSortMenuClick","dblclick .agreement-list-header-info-container":"_onHeaderClick","dblclick .sign-files-sort-menu":"_onSortMenuClick"},_addMenuEventListeners:function(){c.addDomEventListener(document.body,"click",this._onBodyClick,!0)},initialize:function(){e.View.prototype.initialize.call(this),this._addKeyEventListener(),this._addKeyEventListener(),this._addUiModelEventListeners(),this._addMenuEventListeners()},_onBodyClick:function(e){var i=$(e.target);i.hasClass("shared-workflow-files-header-column-title")||this._hideSortMenu()},_hideSortMenu:function(){this.$sortMenu.hide(),this.$nameTitle.removeClass("selected"),this.$modifiedTitle.removeClass("selected"),this.$senderTitle.removeClass("selected"),this.$statusTitle.removeClass("selected")},render:function(){var i,n,o=this.$el;return e.View.prototype.render.call(this),0===o.children().length&&(o.html(_.template(t)({SELECT_ALL:s.SELECT_ALL,SORT_BY:l.SORT_BY,NAME:l.NAME_S,SENDER:l.SENDER_S,CREATE_DATE:l.SENT_RECIEVED_S,STATUS:l.STATUS_S,MODIFIED_DATE_T:s.MODIFIED,NAME_T:s.FILE_NAME,SENDER_T:s.SENDER,STATUS_T:s.STATUS})),this._initWrappers()),e.Util.isCEF()?(this.$statusTitle.text(s.STATUS),this.$status.css("background-image","none").css("background-position",0),this.$modified.addClass("desktop"),this.$status.addClass("desktop")):this.$status.addClass("web"),i=this.options.collectionUiModel,i.get("has_vertical_scrollbar")?(n=this._getScrollBarWidth(),this.$header.css({right:n+"px"})):this.$header.css({right:0}),this._updateCheckbox(),this.$nameTitle.text(s.FILE_NAME),this.$modifiedTitle.text(s.MODIFIED),this.$senderTitle.text(s.SENDER),this.$people.text(s.PEOPLE),this.$statusTitle.text(s.VIEWS),this._updateFields(),this._adjustLayout(),this},_initWrappers:function(){this.$checkbox=this.$(".list-header-checkbox"),this.$header=this.$(".agreement-list-header-info-container"),this.$name=this.$(".parcel-list-header-name"),this.$status=this.$(".parcel-list-header-status"),this.$modified=this.$(".parcel-list-header-modified"),this.$sender=this.$(".parcel-list-header-sender"),this.$nameTitle=this.$(".parcel-list-header-name-title"),this.$statusTitle=this.$(".parcel-list-header-status-title"),this.$modifiedTitle=this.$(".parcel-list-header-modified-title"),this.$senderTitle=this.$(".parcel-list-header-sender-title"),this.$nameSort=this.$(".parcel-list-header-name-sort"),this.$statusSort=this.$(".parcel-list-header-status-sort"),this.$modifiedSort=this.$(".parcel-list-header-modified-sort"),this.$senderSort=this.$(".parcel-list-header-sender-sort"),this.$people=this.$(".parcel-list-header-people"),this.$sortMenu=this.$(".sign-files-sort-menu")
},_onSortMenuClick:function(e){var i=$(e.target);i.hasClass("shared-files-sort-menu-items")&&(this.$sortMenu.hide(),this._sortOnColumn(i)),this._consumeEvent(e)},_onHeaderClick:function(e){var i=$(e.target);!this.options.isInSearchResultsView&&i.hasClass("shared-workflow-files-header-column-title")&&i.hasClass("currently_sorted")?i.hasClass("selected")?(i.removeClass("selected"),this.$sortMenu.hide()):(i.addClass("selected"),this.$sortMenu.show(),i.hasClass("status")&&"list"==this.options.collectionsUiModel.get("view")?this.$sortMenu.css("left",i.parent().position().left+i.outerWidth()-this.$sortMenu.width()):this.$sortMenu.css("left",i.parent().position().left)):(i.hasClass("shared-workflow-files-header-column-title")||i.hasClass("shared-workflow-files-header-column-sort"))&&(this.$sortMenu.hide(),this._sortOnColumn(i)),this._consumeEvent(e)},_getLogColumnName:function(e){var i="";switch(e){case r.CREATE_DATE:i=d.VIRGO_SORT_DATE_SENT;break;case r.INITIATOR:i=d.VIRGO_SORT_SENDER;break;case r.FILENAME:i=d.VIRGO_SORT_FILENAME;break;case r.STATUS:i=d.VIRGO_SORT_STATUS}return i},_sortOnColumn:function(e){var i="",t=r.DESC;e.hasClass("create_date")?i=r.CREATE_DATE:e.hasClass("initiator")?i=r.INITIATOR:e.hasClass("name")?i=r.FILENAME:e.hasClass("status")&&(i=r.STATUS),t=e.hasClass("shared-workflow-files-header-column-sort")&&e.hasClass("descending")?r.ASC:r.DESC,this.options.appApi.siteCatalystApi.logVirgoSortEvent(d.VIRGO_SIGN,this._getLogColumnName(i),t==r.DESC),this.options.collectionsUiModel.trigger("SortItems",{sort_key:i,sort_order:t})},_updateFields:function(){this.$nameSort.hide(),this.$nameTitle.removeClass("currently_sorted selected"),this.$statusSort.hide(),this.$statusTitle.removeClass("currently_sorted selected"),this.$modifiedSort.hide(),this.$modifiedTitle.removeClass("currently_sorted selected"),this.$senderSort.hide(),this.$senderTitle.removeClass("currently_sorted selected"),this.$sortMenu.hide(),this.$(".shared-files-sort-menu-items.create_date").removeClass("selected"),this.$(".shared-files-sort-menu-items.initiator").removeClass("selected"),this.$(".shared-files-sort-menu-items.name").removeClass("selected"),this.$(".shared-files-sort-menu-items.status").removeClass("selected"),this.$(".shared-files-sort-menu-name").css("width","100%"),this.$(".name-tick-icon").hide(),this.$(".create-date-tick-icon").hide(),this.$(".initiator-tick-icon").hide(),this.$(".status-tick-icon").hide();var e=this.options.collectionsUiModel;e.get("sort_key")==r.CREATE_DATE?(this.$modifiedSort.show(),this.$modifiedTitle.addClass("currently_sorted"),e.get("sort_order")==r.DESC?(this.$modifiedSort.addClass("descending"),this.$modifiedSort.attr("aria-label",s.DESCENDING),this.$modifiedSort.attr("title",s.DESCENDING)):(this.$modifiedSort.removeClass("descending"),this.$modifiedSort.attr("aria-label",s.ASCENDING),this.$modifiedSort.attr("title",s.ASCENDING)),this.$(".shared-files-sort-menu-items.create_date").addClass("selected"),this.$(".shared-files-sort-menu-items.create_date").find(".shared-files-sort-menu-name").css("width","90%"),this.$(".create-date-tick-icon").show()):e.get("sort_key")==r.INITIATOR?(this.$senderSort.show(),this.$senderTitle.addClass("currently_sorted"),e.get("sort_order")==r.DESC?(this.$senderSort.addClass("descending"),this.$senderSort.attr("aria-label",s.DESCENDING),this.$senderSort.attr("title",s.DESCENDING)):(this.$senderSort.removeClass("descending"),this.$senderSort.attr("aria-label",s.ASCENDING),this.$senderSort.attr("title",s.ASCENDING)),this.$(".shared-files-sort-menu-items.initiator").addClass("selected"),this.$(".shared-files-sort-menu-items.initiator").find(".shared-files-sort-menu-name").css("width","90%"),this.$(".initiator-tick-icon").show()):e.get("sort_key")==r.FILENAME?(this.$nameSort.show(),this.$nameTitle.addClass("currently_sorted"),e.get("sort_order")==r.DESC?(this.$nameSort.addClass("descending"),this.$nameSort.attr("aria-label",s.DESCENDING),this.$nameSort.attr("title",s.DESCENDING)):(this.$nameSort.removeClass("descending"),this.$nameSort.attr("aria-label",s.ASCENDING),this.$nameSort.attr("title",s.ASCENDING)),this.$(".shared-files-sort-menu-items.name").addClass("selected"),this.$(".shared-files-sort-menu-items.name").find(".shared-files-sort-menu-name").css("width","90%"),this.$(".name-tick-icon").show()):e.get("sort_key")==r.STATUS&&(this.$statusSort.show(),this.$statusTitle.addClass("currently_sorted"),e.get("sort_order")==r.DESC?(this.$statusSort.addClass("descending"),this.$statusSort.attr("aria-label",s.DESCENDING),this.$statusSort.attr("title",s.DESCENDING)):(this.$statusSort.removeClass("descending"),this.$statusSort.attr("aria-label",s.ASCENDING),this.$statusSort.attr("title",s.ASCENDING)),this.$(".shared-files-sort-menu-items.status").addClass("selected"),this.$(".shared-files-sort-menu-items.status").find(".shared-files-sort-menu-name").css("width","90%"),this.$(".status-tick-icon").show())},_isItemSelectable:function(){return!0},_getNumSelectable:function(){var e=0;return this.options.collection.each(_.bind(function(i){this._isItemSelectable(i)&&(e+=1)},this)),e},_getNumSelected:function(){return this.options.selectionUiModel.getSelectionCount()},_getScrollBarWidth:function(){var e=this._scrollBarWidth;return void 0===e&&(e=o.getScrollBarWidth(),this._scrollBarWidth=e),e},_updateCheckbox:function(){var e=this.$checkbox,i=this.options,t=i.selectionUiModel.getSelectionCount();if(t>0){if(t===this._getNumSelectable())return void e.addClass("selected")}else e.removeClass("selected")},_onCheckboxClick:function(){this._getNumSelected()>0?this._triggerViewEvent(e.ViewEvents.CLEAR_SELECTION):(this.options.collection.length>0&&this.options.appApi.siteCatalystApi.logScEvent([a.FILE_LIST,a.SENT_FILES,a.ACTION,a.SELECT_ALL]),this._triggerViewEvent(e.ViewEvents.SELECT_ITEM,_.extend({},this.options,{selectType:e.SelectionUiModel.SELECT_ALL})))},getCurrentSortedColumn:function(){var e,i=this.$sortMenu.find(".selected");return i.length&&(i.hasClass("name")?e=this.$nameTitle:i.hasClass("create_date")?e=this.$modifiedTitle:i.hasClass("initiator")?e=this.$senderTitle:i.hasClass("status")&&(e=this.$statusTitle)),e},_onKeyDown:function(e){var i,t=!1,s=$(e.target);if(!o.descendantHasFocus(this.$el))return t;switch(e.which){case 9:o.isElementDisplayed(this.$sortMenu)&&this._hideSortMenu(),i=o.getNextFocusableDescendant(this.$header,e.shiftKey);break;case 27:o.isElementDisplayed(this.$sortMenu)&&(this._hideSortMenu(),t=!0);break;case 13:case 32:s.click(),s.hasClass("shared-files-sort-menu-items")&&(i=this.getCurrentSortedColumn()),t=!0;break;case 37:case 39:t=!0;break;case 38:case 40:o.isElementDisplayed(this.$sortMenu)&&(i=o.getNextFocusableDescendant(this.$sortMenu,e.shiftKey,!0)),t=!0}return i&&i.length>0&&(i.focus(),t=!0),t},_addUiModelEventListeners:function(){var e=this.options;e.collectionUiModel.on("change:has_vertical_scrollbar",this._onHasVerticalScrollbarChange),e.collectionsUiModel.on("change:checkbox",this.render),e.selectionUiModel.on("change:selected_item_models",this._updateCheckbox),this.listenTo(this.options.collectionsUiModel,"change:rhpShown",this._adjustLayout),this.listenTo(e.collectionsUiModel,"change:view",this._adjustLayout),this.options.appApi.windowApi.addWindowResizeCallback(_.bind(this._adjustLayout))},_onHasVerticalScrollbarChange:function(){this.render()},_updateVisibilityOfColumns:function(e,i){var t=i.colMargin,s=this.$name.position().left,n=i.totalVisibleCols,o=e-s,a=o-t*n,r=i.totalFluidCols,l=a/r;if(1==i.name.visibility){var c=i.name.end-i.name.start+1;this.$name.css("width",l*c+"px"),this.$name.css("margin-right",t+"px"),this.$name.show(),this.$nameSort.css("left",this.$nameTitle.outerWidth()),this.$nameTitle.hasClass("currently_sorted")&&this.$sortMenu.css("left",this.$name.position().left)}else this.$name.hide();if(1==i.modified.visibility){var c=i.modified.end-i.modified.start+1,d=i.modified.colNumber;this.$modified.css("left",s+l*(i.modified.start-1)+t*d+"px"),this.$modified.css("width",l*c+"px"),this.$modified.css("margin-right",t+"px"),this.$modified.show(),this.$modifiedSort.css("left",this.$modifiedTitle.outerWidth()),this.$modifiedTitle.hasClass("currently_sorted")&&this.$sortMenu.css("left",this.$modified.position().left)}else this.$modified.hide();if(1==i.sender.visibility){var c=i.sender.end-i.sender.start+1,d=i.sender.colNumber;this.$sender.css("left",s+l*(i.sender.start-1)+t*d+"px"),this.$sender.css("width",l*c+"px"),this.$sender.css("margin-right",t+"px"),this.$sender.show(),this.$senderSort.css("left",this.$senderTitle.outerWidth()),this.$senderTitle.hasClass("currently_sorted")&&this.$sortMenu.css("left",this.$sender.position().left)}else this.$sender.hide();if(1==i.status.visibility){var c=i.status.end-i.status.start+1,d=i.status.colNumber;this.$status.css("left",s+l*(i.status.start-1)+t*d+"px"),this.$status.css("width",l*c+"px"),this.$status.css("margin-right",t+"px"),this.$status.show(),this.$statusSort.css("left",this.$statusTitle.outerWidth()),this.$statusTitle.hasClass("currently_sorted")&&this.$sortMenu.css("left",this.$statusTitle.parent().position().left+this.$statusTitle.outerWidth()-this.$sortMenu.width())}else this.$status.hide()},_adjustLayout:function(){var e=this.options.collectionsUiModel.get("view");if(this.$name.removeAttr("style"),this.$modified.removeAttr("style"),this.$sender.removeAttr("style"),this.$status.removeAttr("style"),"list"==e){var i=this.$header.width();this.$el.hasClass("sticky-search-header")&&(this.$el.removeClass("sticky-search-header"),i=this.$header.width(),this.$el.addClass("sticky-search-header")),100>=i?this._updateVisibilityOfColumns(i,{name:{visibility:!1},modified:{visibility:!1},sender:{visibility:!1},status:{visibility:!1},totalFluidCols:0,totalVisibleCols:0,colMargin:24}):i>100&&300>=i?this._updateVisibilityOfColumns(i,{name:{visibility:!0,colNumber:0,start:1,end:1},modified:{visibility:!1},sender:{visibility:!1},status:{visibility:!1},totalFluidCols:1,totalVisibleCols:1,colMargin:24}):i>300&&500>=i?this._updateVisibilityOfColumns(i,{name:{visibility:!0,colNumber:0,start:1,end:3},modified:{visibility:!1},sender:{visibility:!1},status:{visibility:!0,colNumber:1,start:4,end:5},totalFluidCols:5,totalVisibleCols:2,colMargin:24}):i>500&&700>=i?this._updateVisibilityOfColumns(i,{name:{visibility:!0,colNumber:0,start:1,end:3},modified:{visibility:!1},sender:{visibility:!0,colNumber:1,start:4,end:5},status:{visibility:!0,colNumber:2,start:6,end:7},totalFluidCols:7,totalVisibleCols:3,colMargin:32}):this._updateVisibilityOfColumns(i,{name:{visibility:!0,colNumber:0,start:1,end:3},modified:{visibility:!0,colNumber:1,start:4,end:5},sender:{visibility:!0,colNumber:2,start:6,end:7},status:{visibility:!0,colNumber:3,start:8,end:9},totalFluidCols:9,totalVisibleCols:4,colMargin:32})}else this.$nameTitle.hasClass("currently_sorted")?(this.$name.show(),this.$name.css("left","0px"),this.$name.css("width",this.$header.width()),this.$sortMenu.css("left",this.$name.position().left),this.$nameSort.css("left",this.$nameTitle.outerWidth())):this.$name.hide(),this.$modifiedTitle.hasClass("currently_sorted")?(this.$modified.show(),this.$modified.css("left","0px"),this.$modified.css("width",this.$header.width()),this.$sortMenu.css("left",this.$modified.position().left),this.$modifiedSort.css("left",this.$modifiedTitle.outerWidth())):this.$modified.hide(),this.$senderTitle.hasClass("currently_sorted")?(this.$sender.show(),this.$sender.css("left","0px"),this.$sender.css("width",this.$header.width()),this.$sortMenu.css("left",this.$sender.position().left),this.$senderSort.css("left",this.$senderTitle.outerWidth())):this.$sender.hide(),this.$statusTitle.hasClass("currently_sorted")?(this.$status.show(),this.$status.css("left","0px"),this.$status.css("width",this.$header.width()),this.$sortMenu.css("left",this.$status.position().left),this.$statusSort.css("left",this.$statusTitle.outerWidth())):this.$status.hide()}})}),define("acplugins/signatures/js/views/parcels-collection-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/uss-search/js/ac-uss-search","acplugins/signatures/js/templates/parcels-collection-template.html","core/utils/view-util","core/models/workflow-status-strings","i18n!acplugins/signatures/js/nls/ui-strings","acplugins/signatures/js/views/parcels-list-view","acplugins/signatures/js/views/parcels-list-header-view"],function(e,i,t,s,n,o){i.ParcelsCollectionView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(s),this._addUiModelEventListeners(),this._addKeyEventListener(),this._addCollectionEventListeners()},render:function(){var i=this.$el,t=this.options,s=t.appApi.pluginsApi,n=t.pluginId;return e.View.prototype.render.call(this),0===i.children().length&&(i.html(this._template({pluginSelectorId:s.getPluginSelectorId(n)})),this._initWrappers()),this.options.collectionsUiModel.set("windowSize",this.$items.width()),this._renderChildViews(),this._onViewChange(this.options.collectionsUiModel),this},_initWrappers:function(){this.$header=this.$(".agreement-header"),this.$selectionActions=this.$(".selection-actions"),this.$items=this.$(".signature-collection-items"),this.options.isInSearchResultsView?(this.$items.addClass("uss-search-active"),this.$header.addClass("uss-search-active"),this.$search_content=$(".search-views-content"),this.$search_content.scroll(this._onScrollSearchResults),this._StickyHeaderTop=$(".search-results-header").outerHeight(!0)+this.$header.outerHeight(!0),this._contentBottom=this._StickyHeaderTop+this.$search_content.outerHeight(!0)):this.$items.on("scroll",this._onItemScroll)},_onItemScroll:function(){var i=this.$items,t=this.options.parcelCollection.length,s=this.options.parcelCollection.getNumberOfItems();e.Util.isMac()&&this._renderHeaderView(),2*i.height()+i.scrollTop()>i.prop("scrollHeight")&&s>t&&this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaFileAPI.getWorkflowData(o.SIGN,t).done(_.bind(function(e){e.WorkflowData.length&&this.options.parcelCollection.length===e.dataRange.from&&this.options.parcelCollection.add(e.WorkflowData,{silent:!0,merge:!0,sort:!1}),this.render()},this))},this))},_onScrollSearchResults:function(){if(this.$el.is(":visible")){var e=this.$items.offset().top,i=this.$items.offset().top+this.$items.outerHeight(!0);if(this._StickyHeaderTop>e&&this._StickyHeaderTop<i){if(this.$header.hasClass("sticky-search-header")||this.$header.addClass("sticky-search-header"),this.$search_content.hasClass("with-sticky-search-header")||this.$search_content.addClass("with-sticky-search-header"),this.options.selectionUiModel.getNumSelectedItems()?this.$header.addClass("active-context-board"):this.$header.removeClass("active-context-board"),i<this._contentBottom&&this.collection.length<this.options.searchModel.getSearchResultCount()){var s=this.options;_.extend(s,{startIndex:this.collection.length,search_scope:["sign"],noSearchReset:!0}),this.options.appApi.displayApi.showSpinner(!0),t.opFactory.create("EchoSignFilesSearchOp",s).run().always(_.bind(function(){this.options.appApi.displayApi.showSpinner(!1)},this))}}else this.$header.hasClass("sticky-search-header")&&this.$header.removeClass("sticky-search-header"),this.$search_content.hasClass("with-sticky-search-header")&&this.$search_content.removeClass("with-sticky-search-header")}},_renderChildViews:function(){this._renderItemsView(),this._renderHeaderView()},_renderItemsView:function(){this._renderChildView("_itemsView",i.ParcelsListView,this.$items)},_renderHeaderView:function(){this._renderChildView("_headerView",i.ParcelsListHeaderView,this.$header,{collectionItemsView:this._itemsView})},_renderSelectionActionsView:function(){this._renderChildView("_selectionActionsView",i.SelectionActionsView,this.$selectionActions)},_setFocusToChildView:function(e,i){var t=i?"[role=checkbox]:focusable":":tabbable:first",s=e.find(t);return s.length?(s.focus(),!0):!1},_onKeyDown:function(e){var i=!1;switch(e.which){case 38:n.descendantHasFocus(this.$items)&&(this.setFocusToHeaderView(!0)||this.setFocusToSelectionActionsView(),i=!0);break;case 40:(n.descendantHasFocus(this.$header)||n.descendantHasFocus(this.$selectionActions))&&(this.setFocusToCollectionItemsView(),i=!0)}return i&&this._consumeEvent(e),i},setFocusToHeaderView:function(e){var i=this._setFocusToChildView(this.$header,e);return i},setFocusToSelectionActionsView:function(e){var i=this._setFocusToChildView(this.$selectionActions,e);return i},setFocusToCollectionItemsView:function(){var e=this._setFocusToChildView(this.$items);return e},_correctFocusOnSelectionChange:function(i,t){var s=this.$header,n=s.find("[role=checkbox]"),o=this.$selectionActions,a=!1,r=!1;i&&(a=i.is(s),r=i.is(o)),a&&t.selectType===e.SelectionUiModel.SELECT_ALL?this.setFocusToSelectionActionsView(!0):r&&(n.is(":focusable")?this.setFocusToHeaderView(!0):this.setFocusToCollectionItemsView())},_hideOrShowHeaderCheckbox:function(){var i=this.$header.find("[role=checkbox]"),t=this.$selectionActions;t.hasClass("open")||e.Util.isCEF()?i.hide():i.show()},_addCollectionEventListeners:function(){var e,i,t=this.options,s=t.collectionsUiModel,n=t.collectionUiModel,o=this.collection;e=s.get("debounced_render_delay"),i=_.debounce(_.bind(function(){this.invalidateViewsRecursively(),this.render(),n.set("show_empty",0===o.length)},this),e),o.on("add change remove sort reset",function(){i()})},_onViewEvent:function(i,t){switch(i){case e.ViewEvents.SELECT_ITEM:this._onSelectItem(t);break;case e.ViewEvents.CLEAR_SELECTION:this._onClearSelection(t)}e.View.prototype._onViewEvent.call(this,i,t)},_onSelectItem:function(e){var i,t=n.descendantHasFocus(this.$header),s=n.descendantHasFocus(this.$selectionActions);t?i=this.$header:s&&(i=this.$selectionActions),_.delay(this._correctFocusOnSelectionChange,this.options.collectionsUiModel.get("scroll_render_delay"),i,e)},_onClearSelection:function(e){this._onSelectItem(e)},_addUiModelEventListeners:function(){var e=this.options;this.listenTo(e.collectionsUiModel,"change:view",this._onViewChange)},_setHeaderVisibility:function(){this.options.collection&&(0==this.options.collection.length?this.$header.hide():this.$header.show())},_onViewChange:function(e){var i=e.get("view");"list"==i?(this.$items.removeClass("shared-thumb-view"),this._setHeaderVisibility()):"thumbnail"==i&&(this.$items.addClass("shared-thumb-view"),this._setHeaderVisibility())}})}),define("acplugins/signatures/js/templates/no-parcels-collection-template.html",[],function(){return'<div id="parcels-no-parcels-prompt-sign" class="shared-no-parcels shown"><div class="shared-empty-state-icon signature-empty-state-icon"></div><div class="shared-on-sign-out-prompt theme-text"><%= NO_PARCELS_SIGN_PROMPT %></div><div class="shared-on-sign-out-subprompt theme-text"><%= NO_PARCELS_SIGN_SUBPROMPT %></div><div class="shared-on-sign-out-button control-button theme-button theme-button-label" role="button"aria-label="<%= NO_PARCELS_SIGN_PROMPT %><%= NO_PARCELS_SIGN_SUBPROMPT %><%= NO_PARCELS_SIGN_BTN %>"tabindex="0"><%= NO_PARCELS_SIGN_BTN %></div></div>'}),define("acplugins/signatures/js/templates/no-parcels-button-template",[],function(){return'<button id="parcels-no-parcels-send-btn" class="parcels-no-parcels-btn theme-hyperlink">       <%= sendBtn %></button> '}),define("acplugins/signatures/js/views/no-parcels-collection-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/no-parcels-collection-template.html","acplugins/signatures/js/templates/no-parcels-button-template","i18n!acplugins/signatures/js/nls/ui-strings","acplugins/signatures/js/utils/sc-constants","acplugins/signatures/js/utils/sign-workflow-utils","core/views/view"],function(e,i,t,s,n,o,a){return i.NoParcelsCollectionView=e.View.extend({events:{"click .shared-on-sign-out-button":"_onSendForSignClick"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t),this._addUiModelEventListeners()},render:function(){return e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({NO_PARCELS_SIGN_PROMPT:n.NO_PARCELS_SIGN_PROMPT,NO_PARCELS_SIGN_SUBPROMPT:n.NO_PARCELS_SIGN_SUBPROMPT,NO_PARCELS_SIGN_BTN:n.NO_PARCELS_SIGN_BTN})),this._initWrappers(),this.options.collectionUiModel.get("show_empty")?this.$noParcelsSendPrompt.addClass("shown"):this.$noParcelsSendPrompt.removeClass("shown"),this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.isSendForSignEnabled()||this.$sendForSignatureBtn.hide()},this))),this.options.appApi.rnaApi.done(_.bind(function(){this.options.appApi.rnaApiObj.esApi.getActiveAgreementFilter().then(_.bind(function(e){this.options.parcelCollection.leftRailFilter="",void 0!=e&&e.length>0&&(this.options.parcelCollection.leftRailFilter=e,"signatures"!=this.options.parcelCollection.leftRailFilter&&(this.options.appApi.acroLogApi.ACRO_DEBUG("[RS LISTING] no-parcels-collection-voew.js _showEmptyStatePage will be called"),this._showEmptyStatePage()))},this))},this)),this},_initWrappers:function(){this.$noParcelsSendPrompt=this.$("#parcels-no-parcels-prompt-sign"),this.$sendForSignatureBtn=this.$(".shared-on-sign-out-button")},_onSendForSignClick:function(){var e=this.options;e.appApi.rnaApi.done(function(e){e.esApi.invokeMethod({methodName:"LaunchRSWorkflow"})})},_addUiModelEventListeners:function(){this.listenTo(this.options.collectionUiModel,"change:show_empty",this._onShowEmptyChange)},_onShowEmptyChange:function(e,i){i?(this.render(),this.$noParcelsSendPrompt.addClass("shown")):this.$noParcelsSendPrompt.removeClass("shown")},_showEmptyStatePage:function(){var e=this.options.parcelCollection.leftRailFilter;$(".signature-workflow-name").text(a.getUIStringFromStatusID(e)),$(".shared-on-sign-out-prompt").text(a.getPromptMsgFromStatusID(e)),$(".shared-on-sign-out-subprompt").text(a.getSubPromptMsgFromStatusID(e)),$(".shared-empty-state-icon").addClass("shared-offline-icon").removeClass("shared-empty-state-icon").removeClass("signature-empty-state-icon"),$(".on-signed-out").removeClass("div-nativers-nativers-library-template"),$(".on-signed-out").removeClass("div-nativers-rs-invoker"),e===o.TEMPLATES?($(".on-signed-out").addClass("div-nativers-nativers-library-template"),$(".shared-on-sign-out-button").text(n.CREATE_ESIGN_TEMPLATE),$(".shared-on-sign-out-button").show()):e===o.ALL||e===o.IN_PROGRESS?($(".shared-on-sign-out-button").text(n.REQUEST_ESIGN),$(".on-signed-out").addClass("div-nativers-rs-invoker"),$(".shared-on-sign-out-button").show()):$(".shared-on-sign-out-button").hide();var i="[RS LISTING] Shown Empty state page when  filterID:"+e;this.options.appApi.acroLogApi.ACRO_DEBUG(i)}}),i.NoParcelsCollectionView}),define("acplugins/signatures/js/templates/redirect-to-web-template",[],function(){return'<div id="parcels-no-parcels-prompt-sign" class="shared-no-parcels shown"><div class="shared-empty-state-icon"></div><div class="shared-on-sign-out-prompt theme-text"><%= NO_PARCELS_SIGN_PROMPT %></div><div class="shared-on-sign-out-subprompt"><%= NO_PARCELS_SIGN_SUBPROMPT %></div><div class="shared-on-sign-out-button control-button theme-button theme-button-label" role="button"aria-label="<%= NO_PARCELS_SIGN_PROMPT %><%= NO_PARCELS_SIGN_SUBPROMPT %><%= NO_PARCELS_SIGN_BTN %>"tabindex="0"><%= NO_PARCELS_SIGN_BTN %></div></div>'}),define("acplugins/signatures/js/views/redirect-to-web-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/redirect-to-web-template","acplugins/signatures/js/templates/no-parcels-button-template","i18n!acplugins/signatures/js/nls/ui-strings","acplugins/signatures/js/utils/sc-constants","core/views/view"],function(e,i,t,s,n){return i.RedirectToWebCollectionView=e.View.extend({events:{"click .shared-on-sign-out-button":"_onOpenSignBtn"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t),this._addUiModelEventListeners()},render:function(){if(e.View.prototype.render.call(this),0===this.$el.children().length){if(e.Util.isReader())var i=n.REDIRECT_TO_WEB_BODY.replace("Acrobat","Reader");else var i=n.REDIRECT_TO_WEB_BODY;this.$el.html(this._template({NO_PARCELS_SIGN_PROMPT:n.REDIRECT_TO_WEB_TITLE,NO_PARCELS_SIGN_SUBPROMPT:i,NO_PARCELS_SIGN_BTN:n.OPEN_ADOBE_SIGN})),this._initWrappers(),this.options.collectionUiModel.get("show_empty")?this.$noParcelsSendPrompt.addClass("shown"):this.$noParcelsSendPrompt.removeClass("shown")}return this},_initWrappers:function(){this.$noParcelsSendPrompt=this.$("#parcels-no-parcels-prompt-sign")},_onOpenSignBtn:function(){this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"openAdobeSignWeb"})},this))},_addUiModelEventListeners:function(){this.listenTo(this.options.collectionUiModel,"change:show_empty",this._onShowEmptyChange)},_onShowEmptyChange:function(e,i){i?(this.render(),this.$noParcelsSendPrompt.addClass("shown")):this.$noParcelsSendPrompt.removeClass("shown")}}),i.RedirectToWebCollectionView}),define("acplugins/signatures/js/views/parcels-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/parcels-template.html","acplugins/signatures/js/views/parcels-collection-view","acplugins/signatures/js/views/no-parcels-collection-view","acplugins/signatures/js/views/redirect-to-web-view"],function(e,i,t){i.ParcelsView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t)},render:function(){return e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template()),this._initWrappers()),this._renderChildViews(),this},_initWrappers:function(){this.$parcelsContent=this.$(".parcels-content"),this.$parcelsNoContent=this.$(".parcels-no-content"),this.$parcelRedirectWeb=this.$(".parcel-redirect-web")},_renderChildViews:function(){var i=this._collectionUiModel;e.Util.isCEF()&&_.isUndefined(this.options.parcelCollection)||(i||(i=this._collectionUiModel=e.uiModelFactory.create("CollectionUiModel"),i.set("show_empty",0===this.options.parcelCollection.length)),this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"canShowSignNativeExperience"}).done(_.bind(function(e){0===e?this._renderRedirectToWebView(i):0!=this.options.parcelCollection.length||this.options.isInSearchResultsView?(this.$parcelsContent.show(),this.$parcelsNoContent.hide(),this._renderParcelsContentView(i)):setTimeout(_.bind(function(){0!=this.options.parcelCollection.length||this.options.isInSearchResultsView||this._renderParcelsNoContentView(i)},this),200)},this))},this)))},_renderParcelsNoContentView:function(e){this._renderChildView("_noParcelsContentView",i.NoParcelsCollectionView,this.$parcelsNoContent,{collection:this.options.parcelCollection,collectionUiModel:e})},_renderRedirectToWebView:function(e){this._renderChildView("_noParcelsContentView",i.RedirectToWebCollectionView,this.$parcelRedirectWeb,{collection:this.options.parcelCollection,collectionUiModel:e})},_renderParcelsContentView:function(e){this._renderChildView("_parcelsContentView",i.ParcelsCollectionView,this.$parcelsContent,{collection:this.options.parcelCollection,collectionUiModel:e})}})}),define("acplugins/signatures/js/views/sent-files-body-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/sent-files-body-template.html","acplugins/signatures/js/views/parcels-view"],function(e,i,t){i.SentFilesBodyView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(t)},render:function(){return e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template()),this._initWrappers()),this._renderChildViews(),this},_initWrappers:function(){this.$parcels=this.$(".parcels"),this.$searchResults=this.$(".parcels-search-results")},_renderChildViews:function(){var e=!0;e&&this._renderParcelsView()},_renderParcelsView:function(){this._renderChildView("_parcelsView",i.ParcelsView,this.$parcels)}})}),define("acplugins/signatures/js/templates/sent-files-footer-template.html",[],function(){return'<div class="adobe-send-btn desktop theme-hyperlink" role="link" id="footer-link" disabled tabindex="-1"><%=GO_TO_ADOBE_SEND_WEBSITE%></div>'}),define("acplugins/signatures/js/views/sent-files-footer-view",["core/ac-core","acplugins/signatures/js/ac-signature","i18n!acplugins/signatures/js/nls/ui-strings","acplugins/signatures/js/templates/sent-files-footer-template.html","core/utils/view-util"],function(e,i,t,s,n){i.SentFilesFooterView=e.View.extend({events:{"click .adobe-send-btn":"_onAdobeSendWebsiteClick"},initialize:function(){e.View.prototype.initialize.call(this),this._addFocusEventListener(),this._addKeyEventListener(),this._template=_.template(s)},render:function(){return e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({GO_TO_ADOBE_SEND_WEBSITE:t.GO_TO_ADOBE_S_T_WEBSITE})),this._initWrappers(),this._setTabbableItem()),this._updateSendButton(),this},_initWrappers:function(){this.$adobeSendBtn=this.$(".adobe-send-btn")},_updateSendButton:function(){this.$adobeSendBtn.addClass("desktop")},_onFocusIn:function(e){var i=$(e.target);return this.$(":focusable").not(i).attr("tabindex",-1),i.attr("tabindex",0),!0},_onFocusOut:function(){return!0},_setTabbableItem:function(){var e=this.$(".adobe-send-btn:focusable"),i=this.$(":tabbable");0===i.length&&e.attr("tabindex","0")},_onKeyDown:function(e){var i=this.$el,t=e.which,s=!1;if(!n.descendantHasFocus(i))return s;switch(t){case 13:s=!0,$(e.target).click();break;case 32:s=!0,$(e.target).click()}return s},_onAdobeSendWebsiteClick:function(){var e=this.options;e.appApi.rnaApi?this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.invokeMethod({methodName:"launchSFSManagePage"})},this)):e.appApi.routerApi.navigate("/send",{trigger:!0})}})}),define("acplugins/signatures/js/templates/files-rhp-template",[],function(){return'<div class="rhp-preview"></div><div class="rhp-properties"></div><div class="rhp-intro-message "></div><div class="rhp-workflow-deadline "></div><div class="rhp-participants-accodian "></div><div class="sign-activity-accodian "></div><div class="rhp-reminders-accodian"></div><div class="rhp-cancel-workflow-accodian "></div><div class="rhp-primary-actions "></div><div class="rhp-es-signin"></div><div class="get-a-link-view-rhp"></div><div class="send-a-copy-view-rhp"></div><div class="save-a-local-copy-view-rhp"></div>'}),define("acplugins/signatures/js/templates/get-a-link-template",[],function(){return'<div class="rhp-option-item"><div class="shared-rhp-action rhp-actions-item with-margins get-a-link-tab cb-active-text-theme" title="<%= GET_A_LINK %>" aria-label="<%= GET_A_LINK %>" tabindex="-1"><div class="shared-rhp-action-icon get-a-link-icon"></div><div class="shared-rhp-action-name" aria-label="<%= GET_A_LINK %>" ><%= GET_A_LINK %></div></div></div>'}),define("acplugins/signatures/js/views/get-a-link-view",["core/ac-core","app/ac-app","files/ac-files","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/get-a-link-template","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/css-util","core/utils/view-util","acplugins/signatures/js/utils/sc-constants","core/models/workflow-status-strings"],function(e,i,t,s,n,o,a,r,l,c){s.GetALinkViewRHP=e.View.extend({events:{"click .get-a-link-tab":"_onGetALinkClick"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(n),this._addModelEventListeners()},render:function(){this.options.parcelModel;e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({GET_A_LINK:o.GET_SHAREABLE_LINK})),this._initWrappers()),this._updateFields()},_addModelEventListeners:function(){},_updateFields:function(){this.options.cbViewModel.getSingleSelectedItemModel().get("signature_info").state!==c.ARCHIVED&&this.$getALinkTab.hide()},_removeModelEventListeners:function(){},_initWrappers:function(){this.$getALinkTab=this.$(".get-a-link-tab")
},_onGetALinkClick:function(){this.options.appApi.rnaApi.done(_.bind(function(e){var i=this.options.cbViewModel.getSingleSelectedItemModel().get("id"),t=this.options.cbViewModel.getSingleSelectedItemModel().getSingleFileName_noext();e.esApi.invokeMethod({methodName:"LaunchShareDialog",methodArgs:{Workflow:"Get_a_link",agreementId:i,agreementName:t}})},this))}})}),define("acplugins/signatures/js/templates/send-a-copy-template",[],function(){return'<div class="rhp-option-item"><div class="shared-rhp-action rhp-actions-item with-margins send-a-copy-tab cb-active-text-theme" title="<%= SEND_A_COPY %>" aria-label="<%= SEND_A_COPY %>" tabindex="-1"><div class="shared-rhp-action-icon send-a-copy-icon"></div><div class="shared-rhp-action-name" aria-label="<%= SEND_A_COPY %>" ><%= SEND_A_COPY %></div></div></div>'}),define("acplugins/signatures/js/views/send-a-copy-view",["core/ac-core","core/utils/util","app/ac-app","files/ac-files","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/send-a-copy-template","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/css-util","core/utils/view-util","acplugins/signatures/js/utils/sc-constants","core/models/workflow-status-strings"],function(e,i,t,s,n,o,a,r,l,c,d){n.SendACopyViewRHP=e.View.extend({events:{"click .send-a-copy-tab":"_onSendACopyClick"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(o),this._addModelEventListeners()},render:function(){this.options.parcelModel;e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({SEND_A_COPY:a.SEND_A_COPY})),this._initWrappers(),i.isReader()&&this.$(".send-a-copy-tab").hide()),this._updateFields()},_addModelEventListeners:function(){},_removeModelEventListeners:function(){},_initWrappers:function(){this.$sendACopyTab=this.$(".send-a-copy-tab")},_updateFields:function(){this.options.cbViewModel.getSingleSelectedItemModel().get("signature_info").state!==d.ARCHIVED&&this.$sendACopyTab.hide()},_onSendACopyClick:function(){this.options.appApi.rnaApi.done(_.bind(function(e){var i=this.options.cbViewModel.getSingleSelectedItemModel().get("id"),t=this.options.cbViewModel.getSingleSelectedItemModel().getSingleFileName_noext();e.esApi.invokeMethod({methodName:"LaunchShareDialog",methodArgs:{Workflow:"Send_a_copy",agreementId:i,agreementName:t}})},this))}})}),define("acplugins/signatures/js/templates/save-a-local-copy-template",[],function(){return'<div class="rhp-option-item"><div class="shared-rhp-action rhp-actions-item with-margins save-a-local-copy-tab cb-active-text-theme" title="<%= SAVE_A_LOCAL_COPY %>" aria-label="<%= SAVE_A_LOCAL_COPY %>" tabindex="-1"><div class="shared-rhp-action-icon save-a-local-copy-icon"></div><div class="shared-rhp-action-name" aria-label="<%= SAVE_A_LOCAL_COPY %>" ><%= SAVE_A_LOCAL_COPY %></div></div></div>'}),define("acplugins/signatures/js/views/save-a-local-copy-view",["core/ac-core","core/utils/util","app/ac-app","files/ac-files","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/save-a-local-copy-template","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/css-util","core/utils/view-util","acplugins/signatures/js/utils/sc-constants","core/models/workflow-status-strings"],function(e,i,t,s,n,o,a){n.SaveALocalCopyViewRHP=e.View.extend({events:{"click .save-a-local-copy-tab":"_onSaveALocalCopyClick","keypress #save-a-local-copy-tab":"_keypressOnSaveALocalCopy","mouseenter #save-a-local-copy-tab":"_onmouseenterSaveALocalCopyTab","mouseleave #save-a-local-copy-tab":"_onmouseleaveSaveALocalCopyTab"},initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(o),this._addModelEventListeners()},render:function(){this.options.parcelModel;e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({SAVE_A_LOCAL_COPY:a.SAVE_A_LOCAL_COPY})),this._initWrappers())},_addModelEventListeners:function(){},_removeModelEventListeners:function(){},_initWrappers:function(){this.$saveALocalCopyTab=this.$(".save-a-local-copy-tab")},_onSaveALocalCopyClick:function(){this.options.appApi.rnaApi.done(_.bind(function(e){var i=this.options.cbViewModel.getSingleSelectedItemModel().get("id"),t=this.options.cbViewModel.getSingleSelectedItemModel().getSingleFileName_noext();e.esApi.invokeMethod({methodName:"SaveALocalCopy",methodArgs:{agreementId:i,agreementName:t}})},this))},_keypressOnSaveALocalCopy:function(e){e&&"keypress"==e.type&&(13==e.keyCode||32==e.keyCode||0==e.keyCode)&&this._SaveALocalCopyClicked()}})}),define("acplugins/signatures/js/views/files-rhp-view",["core/ac-core","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/files-rhp-template","i18n!core/nls/ui-strings","core/models/workflow-status-strings","core/utils/sc-analytics","core/utils/view-util","core/views/rhp/shared-rhp-preview-view","core/views/rhp/shared-rhp-properties-view","core/views/rhp/shared-rhp-intro-message-view","core/views/rhp/shared-rhp-deadline-view","core/views/rhp/signature/participants-accodian-view","core/views/rhp/signature/activity-accodian-view","core/views/rhp/signature/cancel-workflow-accodian-view","core/views/rhp/signature/primary-actions-view","core/views/rhp/signature/reminders-accodian-view","core/views/rhp/signature/es-signin-view","core/views/view","core/models/context-board-model","acplugins/signatures/js/views/get-a-link-view","acplugins/signatures/js/views/send-a-copy-view","acplugins/signatures/js/views/save-a-local-copy-view"],function(e,i,t,s,n,o,a){return i.SignatureFilesRhpView=e.View.extend({events:{},initialize:function(){e.View.prototype.initialize.call(this),this.cbViewModel=e.modelFactory.create("ContextBoardModel"),_.extend(this.options,{cbViewModel:this.cbViewModel}),this._addKeyEventListener()},render:function(){e.View.prototype.render.call(this);var i=this.$el;0===i.children().length&&this.options.runningInRHP&&(this.options.rootView._pluginOptions&&this.options.rootView._pluginOptions.isCBView&&"Tracking"!=this.options.rootView._pluginOptions.requestAgent&&"recent"!=this.options.rootView._pluginOptions.requestAgent?this.options.appApi.siteCatalystApi.logEvent("Viewer","ContextBoard",o.VIRGO_SIGN):this.options.appApi.siteCatalystApi.logVirgoRHPOpenedEvent(o.VIRGO_SIGN_CB)),i.html(_.template(t)),this._initWrappers();var s=this.options.appApi.isAppUsingAV2UI();s&&$(".ui-theme.theme-container").addClass("fileinfo");var a=this.cbViewModel.getSingleSelectedItemModel();return!a||this.options.isInSearchResultsView&&a.workflowType!==n.SIGN?i.hide():(i.show(),this.options.appApi.sessionApi.isESSignedIn()||a.attributes.signature_info.state==n.DRAFT?this._renderChildViews():this._renderRhpESSignInView(),s&&$(".rhp-actions-item").addClass("fileinfo"),this._updateFields()),this},_initWrappers:function(){this.$preview=this.$(".rhp-preview"),this.$properties=this.$(".rhp-properties"),this.$introMessage=this.$(".rhp-intro-message"),this.$deadline=this.$(".rhp-workflow-deadline"),this.$reviewParticipants=this.$(".rhp-participants-accodian"),this.$activityAccodian=this.$(".sign-activity-accodian"),this.$remindersAccodian=this.$(".rhp-reminders-accodian"),this.$primaryActions=this.$(".rhp-primary-actions"),this.$cancelAccodian=this.$(".rhp-cancel-workflow-accodian"),this.$esSignIn=this.$(".rhp-es-signin"),this.$getALinkView=this.$(".get-a-link-view-rhp"),this.$sendacopyView=this.$(".send-a-copy-view-rhp"),this.$savealocalcopyView=this.$(".save-a-local-copy-view-rhp"),this.options.cbViewModel=this.cbViewModel,this.options.rootView._pluginOptions&&!this.options.rootView._pluginOptions.canShowSaveALocalCopy&&this.$savealocalcopyView.hide(),this.options.isInSearchResultsView&&this.$esSignIn.addClass("uss-search-active")},_renderChildViews:function(){this._renderChildView("_previewView",e.SharedRhpPreviewView,this.$preview),this._renderChildView("_propertiesView",e.SharedRhpPropertiesView,this.$properties),this._renderChildView("_introMessageView",e.SharedRhpIntroMsgView,this.$introMessage),this._renderChildView("_deadlineView",e.SharedRhpDeadlineView,this.$deadline),this._renderChildView("_reviewParticipantsView",e.SignatureRhpParticipantsView,this.$reviewParticipants),this._renderChildView("_activityAccodianView",e.SignatureRhpActivityAccodianView,this.$activityAccodian),this._renderChildView("_remindersAccodianView",e.SignatureRhpRemindersAccodianView,this.$remindersAccodian),this._renderChildView("_primaryActionsView",e.SignaturesRhpPrimaryActionsView,this.$primaryActions),this._renderChildView("_cancelAccodianView",e.SignatureRhpCancelWorkflowAccodianView,this.$cancelAccodian),this._renderChildView("_getalinkview",i.GetALinkViewRHP,this.$getALinkView),this._renderChildView("_sendacopyview",i.SendACopyViewRHP,this.$sendacopyView),this._renderChildView("_savealocalcopyview",i.SaveALocalCopyViewRHP,this.$savealocalcopyView)},_renderRhpESSignInView:function(){this._renderChildView("_esSignInView",e.SignaturesRhpESSignInView,this.$esSignIn)},_updateFields:function(){this.options.hidePreview?this.$preview.hide():this.$preview.show()},_addUiModelEventListeners:function(){{var e=this.options;e.rhpPreviewUiModel}this.listenTo(e.selectionUiModel,"change:selected_item_models",this._onSelectedItemModelsChange)},_setModel:function(e,i){var t=this.cbViewModel;t.clearSelection(),i?t.addItem(e):_.each(_.values(e),function(e){t.addItem(e)}),this.render()},_getSiteCatalystContext:function(){return s.RHP},_onKeyDown:function(e){var i=($(e.target),e.which),t=!1,s=e.shiftKey,n=e.ctrlKey;if(117!=i)return t;var o=$(".sent-files-rhp");if(0!=o.length)return t;if(o=$(".context-board-rhp:visible"),!this.$el.is(o))return t;var r,l=o.hasClass("hidden")?!1:!0,c=a.descendantHasFocus(this.$el),d=o.find(":focusable");(!c||n)&&(l&&(s||d&&d.length>0&&(r=d.first().attr("tabindex",0))),r&&r.length>0&&(t=!0,r.focus()));var p={};return p.isF6Consumed=t,p.shift=s,this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaServicesAPI.f6KeyHandled(p)},this)),t}}),i.SignatureFilesRhpView}),define("acplugins/signatures/js/views/on-signed-in-view",["core/ac-core","files/ac-files","acplugins/signatures/js/ac-signature","core/models/workflow-status-strings","acplugins/signatures/js/templates/on-signed-in-template.html","core/utils/util","core/utils/css-util","core/utils/sc-analytics","core/utils/view-util","acplugins/signatures/js/views/signatures-files-header-view","acplugins/signatures/js/views/sent-files-body-view","acplugins/signatures/js/views/sent-files-footer-view","acplugins/signatures/js/views/files-rhp-view"],function(e,i,t,s,n,o,a,r,l){return t.OnSignedInView=e.View.extend({initialize:function(){e.View.prototype.initialize.call(this),this._template=_.template(n),this._addUiModelEventListeners(),this._addKeyEventListener()},render:function(){var i=this.$el;return e.View.prototype.render.call(this),0===i.children().length&&(i.html(_.template(n)),this._initWrappers()),this._renderChildViews(),this},_initWrappers:function(){if(this.$header=this.$(".signatures-files-header"),this.$body=this.$(".signatures-files-body"),this.$footer=this.$(".sent-files-footer"),this.$plugin=$("#signatures-plugin"),this.options.isInSearchResultsView){this.$body.addClass("uss-search-active"),this.$searchContextBoard=$(".search-context-board");var e=this.options.pluginId+"-rhpId",i=_.template('<div class="sent-files-rhp ui-theme theme-container" id="'+e+'">');this.$searchContextBoard.append(i()),this.$rhp=this.$searchContextBoard.find("#"+e)}else this.$rhp=this.$(".sent-files-rhp")},_addUiModelEventListeners:function(){var e=this.options;this.listenTo(e.selectionUiModel,"change:selected_item_models",this._onSelectedItemModelsChange)},_renderChildViews:function(){this._renderSignaturesFilesHeaderView(),this._renderSentFilesBodyView(),this._renderSentFilesRhpView(),"desktop"===this.options.collectionsUiModel.get("mode")&&this.options.appApi.rnaApi.done(_.bind(function(e){e.esApi.isSendForSignEnabled()&&this._renderSentFilesFooterView()},this))},_renderSignaturesFilesHeaderView:function(){this._renderChildView("_signaturesFilesHeaderView",t.SignaturesFilesHeaderView,this.$header)},_renderSentFilesBodyView:function(){this._renderChildView("_sentFilesBodyView",t.SentFilesBodyView,this.$body)},_renderSentFilesFooterView:function(){this._renderChildView("_sentFilesFooterView",t.SentFilesFooterView,this.$footer)},_renderSentFilesRhpView:function(){if(this.rhpView=this._renderChildView("_sentFilesRhpView",t.SignatureFilesRhpView,this.$rhp),this.options.selectionUiModel.isItemSelected()){var e=this.options.selectionUiModel.getSingleSelectedItemModel().id,i=this.options.parcelCollection._byId[e];this.options.selectionUiModel.updateSelectedItemModel(i,!0)}},_onSelectedItemModelsChange:function(e){var i=this.options,t=this.$header,n=this.$body,o=this.$rhp,a=i.appApi;if(!(i.noSelectionActions||a.acrobatApi.isInAcrobat()||a.selectionApi.isRunningInFileSelection())){if(i.isInSearchResultsView){var l=e.getSingleSelectedItemModel();if(l&&l.workflowType!=s.SIGN)return o.hide(),void(t.hasClass("with-rhp")||(t.addClass("with-rhp"),n.addClass("with-rhp"),this.options.collectionsUiModel.set("rhpShown",!0),this._renderSignaturesFilesHeaderView(),this._renderSentFilesBodyView()))}e.isItemSelected()?(this.rhpView._setModel(e.getSelectedItemModels()),t.hasClass("with-rhp")||(t.addClass("with-rhp"),n.addClass("with-rhp"),o.removeClass("hidden").removeClass("invisible"),this.options.collectionsUiModel.set("rhpShown",!0),this.options.appApi.siteCatalystApi.logVirgoRHPOpenedEvent(r.VIRGO_SIGN_CB))):t.hasClass("with-rhp")&&(t.removeClass("with-rhp"),n.removeClass("with-rhp"),o.addClass("hidden"),this.options.collectionsUiModel.set("rhpShown",!1))}},_onKeyDown:function(e){var i=$(e.target),t=e.which,s=!1,n=e.shiftKey;if(!l.isElementDisplayed(this.$plugin))return!1;if(117!=t||!l.descendantHasFocus(this.$el))return s;var o,a=this.$rhp.hasClass("hidden")?!1:!0,r=i.closest(this.$rhp).length?!0:!1,c=this.$rhp.find(":focusable"),d=this.$body.find(".signature-list-item.selected>.signature-list-item-row"),p=this.$el.find(":tabbable"),h=e.altKey,u=e.ctrlKey;h||!a&&u?o=d.length>0?d:p.first().attr("tabindex",0):u?o=c.first().attr("tabindex",0):r?(n&&(o=d),c.attr("tabindex",-1)):a&&(n||c&&c.length>0&&(o=c.first().attr("tabindex",0))),o&&o.length>0&&(s=!0,o.focus());var g={};return g.isF6Consumed=s,g.shift=n,this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaServicesAPI.f6KeyHandled(g)},this)),s}}),t.OnSignedInView}),define("acplugins/signatures/js/templates/on-signed-out-template.html",[],function(){return'<div class="sign-workflow-name shared-workflow-heading shared-files-main-header-empty-state theme-page-header" title="<%= workflowName %>" ><%= workflowName %></div><div class="shared-offline-icon"></div><div class="shared-on-sign-out-prompt theme-text"><%= ON_SIGN_OUT_PROMPT %></div><div class="shared-on-sign-out-subprompt theme-text"><%= ON_SIGN_OUT_SUBPROMPT %></div><div class="shared-on-sign-out-button control-button theme-button theme-button-label" role="button"aria-label="<%= ON_SIGN_OUT_PROMPT %><%= ON_SIGN_OUT_SUBPROMPT %><%= SIGN_IN_BUTTON %>"tabindex="0"><%= SIGN_IN_BUTTON %></div>'}),define("acplugins/signatures/js/views/on-signed-out-view",["core/ac-core","core/models/workflow-status-strings","acplugins/signatures/js/ac-signature","acplugins/signatures/js/templates/on-signed-out-template.html","i18n!acplugins/signatures/js/nls/ui-strings","core/views/view"],function(e,i,t,s,n){return t.OnSignedOutView=e.View.extend({events:{"click .shared-on-sign-out-button":"_onSignInClick","click .div-nativers-nativers-library-template":"_onCreateTemplateClick","click .div-nativers-rs-invoker":"_onNativeRSInvokerClick"},initialize:function(){e.View.prototype.initialize.call(this),this._addKeyEventListener(),this._template=_.template(s)},render:function(){return e.View.prototype.render.call(this),0===this.$el.children().length&&(this.$el.html(this._template({workflowName:n.AGREEMENT_HEADER,ON_SIGN_OUT_PROMPT:n.ON_SIGN_OUT_PROMPT,ON_SIGN_OUT_SUBPROMPT:n.ON_SIGN_OUT_SUBPROMPT,SIGN_IN_BUTTON:n.SIGN_IN_BUTTON})),this._initWrappers()),this},_initWrappers:function(){this.$adobeSendIcon=this.$(".adobe-send-icon"),this.$onSignOutPrompt=this.$(".on-sign-out-prompt"),this.$signInBtn=this.$(".sign-in-btn")},_onKeyDown:function(e){return 32===e.which||13===e.which?($(e.target).click(),!0):!1},_onCreateTemplateClick:function(){var e=this.options;e.appApi.rnaApi.done(function(e){e.esApi.invokeMethod({methodName:"LaunchRSWorkflow"})})},_onNativeRSInvokerClick:function(){var e=this.options;e.appApi.rnaApi.done(function(e){e.esApi.invokeMethod({methodName:"LaunchRSWorkflow"})})},_onSignInClick:function(e){$(".on-signed-out").hasClass("div-nativers-nativers-library-template")?this._onCreateTemplateClick(e):$(".on-signed-out").hasClass("div-nativers-rs-invoker")?this._onNativeRSInvokerClick(e):(this._consumeEvent(e),this.$el.hide(),this.options.appApi.displayApi.showSpinner(!0),this.options.appApi.sessionApi.ensureSignedIn().then(_.bind(function(){this.options.appApi.displayApi.showSpinner(!1)},this),_.bind(function(){this.options.appApi.displayApi.showSpinner(!1),this.$el.show()},this)))}}),t.OnSignedOutView}),define("acplugins/signatures/js/views/signature-home-view-view",["core/ac-core","files/ac-files","plugins-common/ac-plugins","acplugins/signatures/js/ac-signature","acplugins/signatures/js/utils/sc-constants","acplugins/signatures/js/templates/tracked-send-template.html","acplugins/signatures/js/utils/sharing","acplugins/signatures/js/utils/ts-utils","core/models/workflow-status-strings","i18n!acplugins/signatures/js/nls/ui-strings","core/utils/sc-analytics","acplugins/signatures/js/models/ui/parcel-preview-ui-model","core/views/home-view-view","acplugins/signatures/js/ops/showing/parcel-preview-op","acplugins/signatures/js/views/on-signed-in-view","acplugins/signatures/js/views/on-signed-out-view","core/views/rhp-actions-toast-view"],function(e,i,t,s,n,o,a,r,l,c){return s.HomeViewView=e.PluginContentView.extend({initialize:function(){e.PluginContentView.prototype.initialize.call(this),e.Util.isCEF()&&(require(["files/views/files-offline-view"],function(){}),require(["files/views/files-no-access-view"],function(){})),s.plugin=this,this.options.parcelCollection=new e.ParcelCollection([],{wfType:l.SIGN})},_addUiModelEventListeners:function(){var e=this.options;e.collectionsUiModel.on("SortItems",this._sortItems)},_sortSearchResults:function(i,t){var s,n,o=this.options.parcelCollection,a=t===e.SortUiModel.ORDER_ASCENDING?1:-1;o.comparator=i===l.FILENAME?function(e,i){return s=e.getSingleFileName().toLowerCase(),n=i.getSingleFileName().toLowerCase(),s>n?1*a:n>s?-1*a:0}:i===l.INITIATOR?function(e,i){return s=e.getSenderName().toLowerCase(),n=i.getSenderName().toLowerCase(),s>n?1*a:n>s?-1*a:0}:i===l.STATUS?function(e,i){return s=e.get("signature_info").state,n=i.get("signature_info").state,s>n?1*a:n>s?-1*a:0}:function(e,t){return e.get(i)>t.get(i)?1*a:e.get(i)<t.get(i)?-1*a:0},o.sort(),this.options.collectionsUiModel.set("sort_key",i),this.options.collectionsUiModel.set("sort_order",t)},_sortItems:function(e){this.options.isInSearchResultsView?this._sortSearchResults(e.sort_key,e.sort_order):this._requestWorkflowData({sortField:e.sort_key,sortOrder:e.sort_order})},_requestWorkflowData:function(e){if(!this.options.isInSearchResultsView){var i="",t="";e&&e.sortField?i=e.sortField:this.options.collectionsUiModel.get("sort_key")&&(i=this.options.collectionsUiModel.get("sort_key")),e&&e.sortOrder?t=e.sortOrder:this.options.collectionsUiModel.get("sort_order")&&(t=this.options.collectionsUiModel.get("sort_order")),this.options.appApi.rnaApi.done(_.bind(function(e){e.fileApi({methodName:"requestWorkflowData",methodArgs:{WorkflowType:l.SIGN,SortField:i,SortOrder:t}}).done(_.bind(function(){},this))},this))}},render:function(){this.options.selectionUiModel.clearSelection();var i=this.$el;e.PluginContentView.prototype.render.call(this),this._pluginOptions&&this._pluginOptions.isCBView&&(0===i.children().length&&(i.html(_.template(o)),this._initWrappers()),this.options.appApi.rnaApi.done("Tracking"==this._pluginOptions.requestAgent||"recent"==this._pluginOptions.requestAgent?_.bind(function(e){var i={workflowId:this._pluginOptions.workflowID,workflowType:"Signature"};e.fileApi({methodName:"getTrackingWorkflowData",methodArgs:i}).done(_.bind(function(){},this))},this):_.bind(function(e){e.fileApi({methodName:"getSingleWorkflowData",methodArgs:this._pluginOptions.workflowID}).done(_.bind(function(){},this))},this))),this._processRouterArgs().then(_.bind(function(){0===i.children().length&&(i.html(_.template(o)),this._initWrappers()),!this.options.isInSearchResultsView&&!this._isSelected||i.closest(".hidden").length||this._renderChildViews()},this))},initPlugin:function(){var i=this.options,t=i.appApi.pluginsApi,n=e.modelFactory,o=e.uiModelFactory;return _.extend(i,{sessionModel:n.create("SessionModel"),collectionsUiModel:new s.CollectionsUiModel,dialogsUiModel:o.create("DialogsUiModel"),rhpPreviewUiModel:o.create("RhpPreviewUiModel"),itemUiModel:o.create("CollectionItemUiModel"),parcelPreviewUiModel:new s.ParcelPreviewUiModel}),t.isPluginOfThisType(i.pluginId,"search_views")?_.extend(i,{isInSearchResultsView:!0}):_.extend(i,{selectionUiModel:o.create("SelectionUiModel")}),e.Util.isCEF()&&this._changeModeToDesktop(),i.appApi.siteCatalystApi.register("sharing",a),i.collectionsUiModel.on("change:mode",this._onModeChange),i.isInSearchResultsView?(i.collectionsUiModel.set("checkbox",!1),i.collectionsUiModel.set("sort_key",l.CREATE_DATE),i.collectionsUiModel.set("sort_order",l.DESC)):this._onModeChange(),this._isSelected=!1,this._addUiModelEventListeners(),this._getResolvedPromise()},selectPlugin:function(i){return _.defer(_.bind(function(i){var t,o,a=this.options,r=(a.appApi.networkConnectivityApi,this.options.appApi.routerApi.parseQueryParams(window.location.href.slice(window.location.href.indexOf("?"))));if(this._pluginOptions=this._pluginOptions||{},i&&_.extend(this._pluginOptions,i),i&&a.isInSearchResultsView&&(a.searchModel=i.searchModel,a.searchUiModel=i.searchUiModel,a.selectionUiModel=i.selectionUiModel,a.selectionUiModel.set("multiple_selection",!1),a.collectionsUiModel.set("checkbox",!a.selectionUiModel.isSingleSelectionMode())),a.searchModel&&a.parcelCollection.reset(a.searchModel.get("parcelCollection").models),i&&(o=i.noHistoryEffect),o||(t=a.appApi.routerApi,t.navigate(s.PLUGIN_ID)),e.Util.isCEF()){if(this.options.appApi.siteCatalystApi.logScEvent([n.FILE_LIST,n.SENT_FILES,n.CLICKED]),this._isSelected&&_.isUndefined(this.options.parcelCollection))return this._renderForStartup(),this._getResolvedPromise();this.options.appApi.displayApi.applyUIThemeStyles(this.$el).then(_.bind(function(){this.render()},this))}return"desktop"===a.collectionsUiModel.get("mode")?(this._pluginOptions||(this._pluginOptions={}),r.isCBView&&(this._pluginOptions.isCBView="true"==r.isCBView?!0:!1),r.workflowID&&(this._pluginOptions.workflowID=r.workflowID),r.requestAgent&&(this._pluginOptions.requestAgent=r.requestAgent),this._pluginOptions.canShowSaveALocalCopy="true"==r.canShowSaveALocalCopy?!0:!1,r.notificationID&&(this._pluginOptions.notificationID=r.notificationID),this._addAppApiCallbacks(),this.options.appApi.rnaApi.done(_.bind(function(e){e.signServiceAuthAPI.isESSessionActive()},this)),a.appApi.networkConnectivityApi.isOnline()&&a.appApi.sessionApi.isSignedInReader()?(this.$onSignedOut&&this.$onSignedOut.hide(),this.$offlineView&&this.$offlineView.hide(),a.appApi.sessionApi.ensureSignedIn().then(_.bind(function(){return this._isSelected=!0,this._startPlugin()},this),_.bind(function(e){return a.appApi.displayApi.showSpinner(!1),e&&"NoAccessToPdfServices"===e.errorString?(this._isSelected=!0,this._renderForStartup(),this._startPlugin()):void(0===this.$el.children().length&&a.appApi.pluginsApi.handleServerOutageFailure())},this)),this._getResolvedPromise()):(this._isSelected=!0,this._renderForStartup(),this._getResolvedPromise())):(this._isSelected=!0,this._startPlugin())},this),i),this._getResolvedPromise()},deselectPlugin:function(){e.Util.isCEF()&&$(".page-main-container").removeClass("sent-files-container"),e.PluginContentView.prototype.deselectPlugin.call(this),this._isSelected=!1},releasePlugin:function(){delete this._startingPluginPromise,e.PluginContentView.prototype.releasePlugin.call(this)},getSelectionUiModel:function(){return this.options.selectionUiModel},clickedOutsideAiCview:function(){if(e.Util.isCEF()){this.options.selectionUiModel.clearSelection();var i=this.$(".sign-files-sort-menu");i.length>0&&"none"!==i.css("display")&&(i.hide(),this.$(".parcel-list-header-name-title").removeClass("selected"),this.$(".parcel-list-header-modified-title").removeClass("selected"),this.$(".parcel-list-header-sender-title").removeClass("selected"),this.$(".parcel-list-header-status-title").removeClass("selected"))}return this._getResolvedPromise()},getSiteCatalystName:function(){return n.SENT_FILES},getAppApiVersion:function(){return void 0==Ac.Plugins.groups.send?"dev":Ac.Plugins.groups.send.FRAMEWORK_VERSION},getSignaturesFilesList:function(e){this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),this.options.appApi.rnaApi.done(_.bind(function(i){i.rnaSignWorkflowServicesAPI.isSignSearchMicroserviceEnabled()?s.opFactory.create("GetSignFilesListUsingSearchOp",this.options).run(e):s.opFactory.create("GetSignaturesFilesListOp",this.options).run(e)},this))},getSignAgreementData:function(e){this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),this.options.appApi.rnaApi.done(_.bind(function(i){i.rnaSignWorkflowServicesAPI.isSignSearchMicroserviceEnabled()?s.opFactory.create("GetSignatureAgreementDataUsingSearchOp",this.options).run(e).then(_.bind(function(e){this.options.appApi.rnaApi.done(_.bind(function(i){i.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"updateDataModelForAgreement",methodArgs:e})},e))},this)):s.opFactory.create("GetSignatureAgreementDataOp",this.options).run(e)},this))},getSignAgreementDataBatch:function(e){this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("GetSignatureAgreementDataUsingSearchOp",this.options).run(e).then(_.bind(function(e){this.options.appApi.rnaApi.done(_.bind(function(i){i.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"updateDataModelBatch",methodArgs:e})},e))},this))},getSignAgreementDataForNotifications:function(e){var i=$.Deferred();return this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),this.options.appApi.rnaApi.done(_.bind(function(t){return t.rnaSignWorkflowServicesAPI.isSignSearchMicroserviceEnabled()?void s.opFactory.create("GetSignatureAgreementDataUsingSearchOp",this.options).run(e).then(_.bind(function(e){i.resolve(e)},this)):i.resolve($.Deferred().reject())},this)),i},getNextParticipantSetList:function(e){return this.options.agreementID=e,this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("GetNextParticipantOp",this.options).run()},getSignaturesAuditTrail:function(e){this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("GetSignaturesAuditTrailOp",this.options).run(e)},sendReminder:function(e){return this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("PostReminderAndGetResponseOp",this.options).run(e)},getSignaturesActivityList:function(e){return this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("GetSignaturesActivityListOp",this.options).run({agreementID:e})},showToastForAction:function(i){this.options.toastArgumentString=i;var t=this.$el;this.$toastPlaceholderDIV=t.find(".rhp-action-toast-placeholder"),0==this.$toastPlaceholderDIV.length&&(this.$toastPlaceholderDIV=$("<div class='rhp-action-toast-placeholder'></div>"),t.append(this.$toastPlaceholderDIV)),this._renderChildView("_rhpToast",e.RhpActionsToast,this.$toastPlaceholderDIV,{options:this.options})},sendCancelAgreement:function(e){this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("GetAgreementIDEtagOp",this.options).run({agreementID:e.agreementID}).then(_.bind(function(i){s.opFactory.create("CancelAgreementOp",this.options).run({agreementID:e.agreementID,shouldNotifySigners:e.notifySigners,notifyText:e.notifyText,eTag:i.eTag}).then(_.bind(function(){var i=e.cancelString;if(this.showToastForAction(i),this.options.isInSearchResultsView)this.options.searchUiModel.trigger("refresh_search_category","sign");else{var t={};t.id=e.agreementID,this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaSignWorkflowServicesAPI.invokeMethod({methodName:"updateDataModelAfterActionForAgreement",methodArgs:t})},this)),$(".sent-files-rhp,.context-board-view").removeClass("cursor-wait")}},this),_.bind(function(e){this.options.cancelResponseFetchHttpCode=e.httpRespCode,this.options.cancelResponseFetchRespBody=e.httpRespBody,$(".sent-files-rhp,.context-board-view").removeClass("cursor-wait")},this))},this),_.bind(function(e){this.options.getEtagResponseFetchHttpCode=e.httpRespCode,this.options.getEtagResponseFetchRespBody=e.httpRespBody,$(".sent-files-rhp,.context-board-view").removeClass("cursor-wait")},this))},openSignAgreement:function(e){return this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("OpenSignAgreementOp",this.options).run({model:e})},getSignThumbnail:function(e){return this.options.esInitialized||s.opFactory.create("InitializeEchoSignOp",this.options).run(),s.opFactory.create("GetSignAgreementThumbnailOp",this.options).run(e.workflowId,e.size,e.NeedIDInResponse,e.ItemID)},_initWrappers:function(){this.$onSignedIn=this.$(".on-signed-in"),this.$onSignedOut=this.$(".on-signed-out"),this.$offlineView=this.$(".files-offline-view"),this.$noAccessView=this.$(".files-no-access-view"),this.$contextBoard=this.$(".context-board-view")},_renderChildViews:function(){var e=this.options.collectionsUiModel.get("mode");if("desktop"===e){if(this._pluginOptions&&this._pluginOptions.isCBView)return this._renderContextBoardView(),this.$offlineView.hide(),this.$onSignedIn.hide(),this.$onSignedOut.hide(),this.$noAccessView.hide(),void this.$contextBoard.show();this.$contextBoard.hide(),this.options.appApi.networkConnectivityApi.isOnline()?this.options.appApi.sessionApi.isSignedInReader()?this.options.appApi.sessionApi.ensureSignedIn().then(_.bind(function(){this.$onSignedIn.show(),this.$onSignedOut.hide(),this.$offlineView.hide(),this.$noAccessView.hide(),this.$contextBoard.hide(),this._renderOnSignedOutView(),this._renderOnSignedInView()},this),_.bind(function(e){e&&"NoAccessToPdfServices"===e.errorString&&(this.$onSignedIn.show(),this.$onSignedOut.hide(),this.$offlineView.hide(),this.$noAccessView.hide(),this.$contextBoard.hide(),this._renderOnSignedInView())},this)):(this.$onSignedOut.show(),this.$onSignedOut.addClass("unselectable"),this.$onSignedIn.hide(),this.$offlineView.hide(),this.$noAccessView.hide(),this.$contextBoard.hide(),this._renderOnSignedOutView()):(this.$offlineView.show(),this.$onSignedIn.hide(),this.$onSignedOut.hide(),this.$noAccessView.hide(),this.$contextBoard.hide(),this._renderOfflineView())}else this.$onSignedIn.show(),this.$onSignedOut.hide(),this.$offlineView.hide(),this.$noAccessView.hide(),this.$contextBoard.hide(),this._renderOnSignedInView()},_renderOnSignedInView:function(){this._renderChildView("_onSignedInView",s.OnSignedInView,this.$onSignedIn)},_renderOnSignedOutView:function(){this._renderChildView("_onSignedOutView",s.OnSignedOutView,this.$onSignedOut)},_renderOfflineView:function(){var e={workflowName:c.AGREEMENT_HEADER};this._renderChildView("_filesOfflineView",i.FilesOfflineView,this.$offlineView,e)
},_renderNoAccessView:function(){this._renderChildView("_filesNoAccessView",i.FilesNoAccessView,this.$noAccessView)},_renderContextBoardView:function(){var e=!1,i=!1,t="list",n=!1;this._pluginOptions&&(t=this._pluginOptions.requestAgent,"Tracking"==t?(e=!1,i=!0):"recent"==t?(e=!1,i=!1):(e=!0,n=!0)),this.$cbView=this._renderChildView("_sentFilesRhpView",s.SignatureFilesRhpView,this.$contextBoard,{hidePreview:e,showRemoveFromTracking:i,agent:t,isDocView:n})},_whenSignedInFunction:function(){var e,i=this.options;e=i.appApi.baseFilesUrisApi.getSendApiUri(),e=r.extractRootUrl(e),this._requestWorkflowData(),i.collectionsUiModel.initializeFromCohorts(i.appApi.usersMeApi.getUserCohorts())},_startPlugin:function(){var e=this._startingPluginPromise,i=this.options.collectionsUiModel.get("mode");return this._pluginOptions&&this._pluginOptions.isCBView?void this._renderForStartup():(e?("desktop"===i&&this._requestWorkflowData(),this._renderForStartup()):(this._whenSignedInFunction(),e=this._startingPluginPromise=s.opFactory.create("StartingPluginOp",this.options).run().then(_.bind(function(){"desktop"===i&&this._addAppApiCallbacks(),this._renderForStartup()},this))),e)},_addAppApiCallbacks:function(){var e=(this.options,this.options.appApi),i=e.sessionApi,t=e.networkConnectivityApi;i.removeSignedInChangeCallback(this._onSignedInChange),i.removeESSignedInChangeCallback(this._refreshUI),t.removeNetworkConnectivtyChangeCallback(this._onConnectionChanged),i.addSignedInChangeCallback(this._onSignedInChange),i.addESSignedInChangeCallback(this._refreshUI),t.addNetworkConnectivtyChangeCallback(this._onConnectionChanged)},_onSignedInChange:function(e,i){i?this._isSelected&&(this.deselectPlugin(),this.selectPlugin(this._pluginOptions)):($(".page-main-container").removeClass("sent-files-container"),this.options.selectionUiModel.clearSelection(),this.releasePlugin(),this._renderForStartup())},_onConnectionChanged:function(e,i){i?(this.deselectPlugin(),this.selectPlugin(this._pluginOptions)):($(".page-main-container").removeClass("sent-files-container"),this._renderForStartup())},_renderForStartup:function(){var i=this.options.selectionUiModel;e.Util.isCEF()||i.clearSelection(),this.render(),this.options.appApi.displayApi.showSpinner(!1)},_processRouterArgs:function(){var e,i,t,n=s.selector.routerArgs,o=this.options,a=$.Deferred();return n?(e=n.parcelID,this._startingPluginPromise.then(_.bind(function(){var n;t=o.appApi.baseFilesUrisApi.getSendApiUri(),t=r.extractRootUrl(t),i=new s.ParcelModel({parcel_id:e},{rootUrl:t}),i.fetch().then(_.bind(function(e){n=_.extend({},o,{},{parcelModel:e})},this,i))},this))):a.resolve(),delete s.selector.routerArgs,a.promise()},_changeModeToDesktop:function(){var e=this.options,i=e.collectionsUiModel.get("mode");"web"===i&&e.collectionsUiModel.set("mode","desktop")},_onModeChange:function(){var e=this.options,i=e.collectionsUiModel,t=e.selectionUiModel,s=i.get("mode");"desktop"===s?(i.set("checkbox",!1),t.set("multiple_selection",!0)):"web"===s&&(i.set("checkbox",!0),t.set("multiple_selection",!0))},_onViewEvent:function(i,t){"ParcelPreview_Close"===i&&this._renderChildViews(),e.View.prototype._onViewEvent.call(this,i,t)},_setContextBoardModel:function(e){if(this.$cbView&&e.model){_.extend(this._pluginOptions,e.pluginOptions);var i=!1,t=!1,s=!0,n=!1;"Tracking"==this._pluginOptions.requestAgent?(n=this._pluginOptions.isUnaccepted,t=!0):"recent"==this._pluginOptions.requestAgent?t=!1:i=!0;var o={hidePreview:i,showRemoveFromTracking:t,expandParticipantsAccodian:s,isUnaccepted:n,notificationID:this._pluginOptions.notificationID};_.extend(this.$cbView.options,o),_.each(this.$cbView.getChildViews(),function(e){_.extend(e.options,o)}),this.options.selectionUiModel.clearSelection(),this.options.selectionUiModel.updateSelectedItemModel(e.model,!1),this.$cbView._setModel(e.model,!0)}},_refreshUI:function(){this.options.isInSearchResultsView||this.options.appApi.rnaApi.done(_.bind(function(e){e.rnaFileAPI.getWorkflowData(l.SIGN).done(_.bind(function(e){e&&(this._workflow_status_code!=e.status_code&&(this._workflow_status_code=e.status_code,200!=this._workflow_status_code&&this.options.appApi.pluginsApi.isPluginSelected(this.options.pluginId)&&!this.options.appApi.pluginsApi.isNativeViewSelected()&&this.options.appApi.networkConnectivityApi.isOnline()&&this.options.appApi.errorApi.enqueueAjaxError({status:e.status_code,responseText:e.status_message})),this.options.parcelCollection.reset(),this.options.parcelCollection.pushData(e),this.options.collectionsUiModel.set("sort_key",e.sortBy),this.options.collectionsUiModel.set("sort_order",e.sortOrder),this.render())},this))},this))}}),s.HomeViewView}),define("acplugins/signatures/js/signature",["acplugins/signatures/js/ac-signature","pdmplugins/esign/js/ac-esign-init","acplugins/signatures/js/ops/op-factory","acplugins/signatures/js/views/signature-home-view-view"],function(e){_.extend(e,{init:function(){e.opFactory=new e.OpFactory}})}),define("acplugins/signatures/js/plugin",["acplugins/signatures/js/ac-signature","acplugins/signatures/js/signature"],function(e){e.init()});