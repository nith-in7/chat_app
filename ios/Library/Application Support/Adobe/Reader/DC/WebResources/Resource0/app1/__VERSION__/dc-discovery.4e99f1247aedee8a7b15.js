"use strict";(self["webpackJsonp-dc-desktop-app"]=self["webpackJsonp-dc-desktop-app"]||[]).push([[862],{zSbg:(e,t,s)=>{s.d(t,{Z:()=>i});var a=s("plsW"),r=s("Lk87");const i=new class BaseURIModel{constructor(){this._baseFilesURIs={api:"https://files.acrobat.com/api/aax/",cloud_do_not_use:"https://cloud.acrobat.com/",commenting_uri:"https://comments.adobe.io/",download:"https://files-download2.acrocomcontent.com/api/ddx/",ims:"https://ims-na1.adobelogin.com/",prefs:"https://cloud.acrobat.com/api/aax/",rendition:"https://files.acrobat.com/api/rrx/",send_api:"https://send.acrobat.com/a/api/",ui_helpers:"https://cloud.acrobat.com/api/aax/",upload:"https://upload2.files.acrobat.com/api/uux/",users:"https://cloud.acrobat.com/api/aax/"},this._isBaseFilesURISet=!1,this._baseCreatePdfURIs={api:"https://createpdf.acrobat.com/createpdf/api/",users:"https://createpdf.acrobat.com/createpdf/api/",prefs:"https://createpdf.acrobat.com/createpdf/api/",ims:"https://ims-na1.adobelogin.com/",blueheron:"https://files.acrobat.com/",ipmcontext:"https://createpdf.acrobat.com/createpdf/api/users/me/ipm_context"},this._isBaseCreatePdfURISet=!1,this._durableLinkBaseURI="https://acrobat.adobe.com/id/",this._isDurableLinkBaseURISet=!1,this._invitationBaseURI="https://invitations.adobe.io/api/v4"}get isBaseFilesURISet(){return this._isBaseFilesURISet}get isBaseCreatePdfURISet(){return this._isBaseCreatePdfURISet}get isDurableLinkBaseURISet(){return this._isDurableLinkBaseURISet}async getBaseFilesURIs(){const e=new r.Z;try{if(!this.isBaseFilesURISet){const e=await a.providers["native-api"](),t=await e.ResponseCacheAPI(),s=await t.GetBaseURIs("Files");null!=s&&(this._baseFilesURIs.api=null!=s.api&&""!=s.api?s.api:this._baseFilesURIs.api,this._baseFilesURIs.cloud_do_not_use=null!=s.cloud_do_not_use&&""!=s.cloud_do_not_use?s.cloud_do_not_use:this._baseFilesURIs.cloud_do_not_use,this._baseFilesURIs.commenting_uri=null!=s.commenting_uri&&""!=s.commenting_uri?s.commenting_uri:this._baseFilesURIs.commenting_uri,this._baseFilesURIs.download=null!=s.download&&""!=s.download?s.download:this._baseFilesURIs.download,this._baseFilesURIs.ims=null!=s.ims&&""!=s.ims?s.ims:this._baseFilesURIs.ims,this._baseFilesURIs.prefs=null!=s.prefs&&""!=s.prefs?s.prefs:this._baseFilesURIs.prefs,this._baseFilesURIs.rendition=null!=s.rendition&&""!=s.rendition?s.rendition:this._baseFilesURIs.rendition,this._baseFilesURIs.send_api=null!=s.send_api&&""!=s.send_api?s.send_api:this._baseFilesURIs.send_api,this._baseFilesURIs.ui_helpers=null!=s.ui_helpers&&""!=s.ui_helpers?s.ui_helpers:this._baseFilesURIs.ui_helpers,this._baseFilesURIs.upload=null!=s.upload&&""!=s.upload?s.upload:this._baseFilesURIs.upload,this._baseFilesURIs.users=null!=s.users&&""!=s.users?s.users:this._baseFilesURIs.users),this._isBaseFilesURISet=!0}e.resolve(this._baseFilesURIs)}catch(t){e.resolve(this._baseFilesURIs)}return e.promise}async getBaseCreatePdfURIs(){const e=new r.Z;try{if(!this.isBaseCreatePdfURISet){const e=await a.providers["native-api"](),t=await e.ResponseCacheAPI(),s=await t.GetBaseURIs("CreatePDF");null!=s&&(this._baseCreatePdfURIs.api=null!=s.api&&""!=s.api?s.api:this._baseCreatePdfURIs.api,this._baseCreatePdfURIs.users=null!=s.users&&""!=s.users?s.users:this._baseCreatePdfURIs.users,this._baseCreatePdfURIs.ims=null!=s.ims&&""!=s.ims?s.ims:this._baseCreatePdfURIs.ims,this._baseCreatePdfURIs.prefs=null!=s.prefs&&""!=s.prefs?s.prefs:this._baseCreatePdfURIs.prefs,this._baseCreatePdfURIs.blueheron=null!=s.blueheron&&""!=s.blueheron?s.blueheron:this._baseCreatePdfURIs.blueheron,this._baseCreatePdfURIs.ipmcontext=null!=s.ipmcontext&&""!=s.ipmcontext?s.ipmcontext:this._baseCreatePdfURIs.ipmcontext),this._isBaseCreatePdfURISet=!0}e.resolve(this._baseCreatePdfURIs)}catch(t){e.resolve(this._baseCreatePdfURIs)}return e.promise}async getDurableLinkBaseURI(){const e=new r.Z;try{if(!this.isDurableLinkBaseURISet){const e=await a.providers["native-api"](),t=await e.UnifiedSharePopupAPI(),s=await t.GetDurableLinkBaseURIFromDiscoveryResponse();this._durableLinkBaseURI=null!=s&&""!=s?s:this._durableLinkBaseURI}}catch(e){}return e.resolve(this._durableLinkBaseURI),e.promise}async getInvitationBaseURI(){const e=new r.Z;try{const e=await a.providers["native-api"](),t=await e.UnifiedSharePopupAPI(),s=await t.GetInvitationBaseURIFromDiscoveryResponse();this._invitationBaseURI=null!=s&&""!=s?s:this._invitationBaseURI}catch(e){}return e.resolve(this._invitationBaseURI),e.promise}}},y7aJ:(e,t,s)=>{s.r(t),s.d(t,{default:()=>CollaborationProvider});var a,r,i=s("plsW");!function(e){e[e.BOOTSTRAP=0]="BOOTSTRAP",e[e.COLLABORATOR=1]="COLLABORATOR",e[e.INVITATION=2]="INVITATION",e[e.BEHANCE=3]="BEHANCE",e[e.PUBLIC_LINK=4]="PUBLIC_LINK",e[e.CONSENT=5]="CONSENT",e[e.PGC_SUGGESTIONS=6]="PGC_SUGGESTIONS",e[e.UNSHARE=7]="UNSHARE",e[e.MERGE_ANNOTS=8]="MERGE_ANNOTS",e[e.PGC_ACCEPT=9]="PGC_ACCEPT",e[e.LIMITS=10]="LIMITS",e[e.DELETE_COLLABORATOR=11]="DELETE_COLLABORATOR",e[e.PATCH_COLLABORATOR=12]="PATCH_COLLABORATOR",e[e.PENDING_ACCESS_REQ=13]="PENDING_ACCESS_REQ",e[e.MANAGE_ACCESS_REQ=14]="MANAGE_ACCESS_REQ"}(a||(a={}));!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_COMMAND=1]="INVALID_COMMAND",e[e.INVALID_PARAMS=2]="INVALID_PARAMS",e[e.NETWORK_CALL_FAILED=3]="NETWORK_CALL_FAILED",e[e.UNKNOWN_ERROR=4]="UNKNOWN_ERROR"}(r||(r={}));var o=s("Lk87");class BehanceNetworkCall{constructor(){}async GetBehanceHTTPHeaders(){const e=await i.providers["native-api"](),t=(await e.SessionAPI()).xApiClientId;return{Accept:"application/json","Content-Type":"application/json","x-api-app-info":t,"x-api-client-id":t}}async GetBehanceDetails(){const e=await i.providers["native-api"](),t=await e.ServicesAPI();return await t.FetchBehanceDetailsFromNative()}PopulateBehanceUserDetails(e,t){var s,a;e.data.users=[],(null===(a=null===(s=null==t?void 0:t.data)||void 0===s?void 0:s.users)||void 0===a?void 0:a.length)&&t.data.users.forEach((t=>{const s={adobeId:t.adobeId,firstName:t.firstName,lastName:t.lastName,username:t.username,displayName:t.displayName,hasDefaultImage:t.hasDefaultImage,image_50:t.images.size_50.url,image_100:t.images.size_100.url,image_115:t.images.size_115.url,image_138:t.images.size_138.url,image_230:t.images.size_230.url,image_276:t.images.size_276.url};e.data.users.push(s)}))}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=await this.GetBehanceDetails();if(!a)return s.ERR_CODE=r.UNKNOWN_ERROR,t.reject(s),t.promise;const n=a.behanceGraphQLEndpoint,l=await this.GetBehanceHTTPHeaders(),d=e.listOfGUID;let c=a.behanceGraphQLQueryInit;d.forEach((e=>{e&&e.length&&(c+='\\"',c+=e,c+='\\",')})),c+=a.behanceGraphQLQueryEnd;let u={};try{u=JSON.parse(c)}catch(e){return s.ERR_CODE=r.UNKNOWN_ERROR,t.reject(s),t.promise}const p=(await i.providers["network-api"]()).GetNetworkMutation(n,{},{method:"POST",headers:l},{wantsHeaders:!0}),R={onResponse:e=>{p.Unsubscribe(R),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{p.Unsubscribe(R),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return p.Subscribe(R),p.Mutate(u),t.promise}IsValidRequest(e){return e.command===a.BEHANCE&&0!==e.listOfGUID.length}}class BootstrapNetworkCall{constructor(){}async GetBootstrapHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}PopulateBoostrapSharedAssetInfo(e,t){var s,a;(null===(s=null==t?void 0:t.meta_list)||void 0===s?void 0:s.length)&&(t.meta_list[0].asset_urn&&(e.data.asset_id=t.meta_list[0].asset_urn),t.meta_list[0].commenting_urn&&(e.data.commenting_urn=t.meta_list[0].commenting_urn)),e.data.is_original_shared=!1,t.is_original_shared&&(e.data.is_original_shared=t.is_original_shared),t.parcel_data&&(e.data.email_message="",t.parcel_data.email_message&&(e.data.email_message=t.parcel_data.email_message),(null===(a=t.parcel_data.review)||void 0===a?void 0:a.url)&&(e.data.preview_url=t.parcel_data.review.url))}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a="https://send.acrobat.com/a/preview/"+e.assetId+"/bootstrap";let n={};e.shareInfo&&(n.shareinfo=!0);const l=await this.GetBootstrapHTTPHeaders(),d=(await i.providers["network-api"]()).GetNetworkQuery(a,n,{method:"GET",headers:l}),c={onResponse:e=>{d.Unsubscribe(c);const a=e;this.PopulateBoostrapSharedAssetInfo(s,a),t.resolve(s)},onStatusChange:e=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=e,t.reject(s)}};return d.Subscribe(c),d.Refresh(),t.promise}IsValidRequest(e){return e.command===a.BOOTSTRAP&&0!==e.assetId.length}}var n=s("zSbg");class CollaboratorNetworkCall{constructor(){}async GetCollaboratorHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.assetId,l=e.forceUpdate;let d=(await n.Z.getBaseFilesURIs()).send_api+"assets/"+a+"/collaborators";l&&(d+="?force=true");const c=await this.GetCollaboratorHTTPHeaders(),u=(await i.providers["network-api"]()).GetNetworkQuery(d,{},{method:"GET",headers:c},{wantsHeaders:!0}),p={onResponse:e=>{u.Unsubscribe(p),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:e=>{},onError:e=>{u.Unsubscribe(p),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return u.Subscribe(p),u.Refresh(),t.promise}IsValidRequest(e){return e.command===a.COLLABORATOR&&(0!==e.assetId.length&&"dummyId"!==e.assetId)}}class CreateLinkNetworkCall{constructor(){}async GetPublicLinkHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=(await n.Z.getBaseFilesURIs()).send_api+"invitation/publicLink",l=await this.GetPublicLinkHTTPHeaders(),d=e;let c={content_types:d.contentType,is_review:d.isReview,asset_name:d.assetName};0!==d.assetId.length&&(c.asset_id=d.assetId);const u=(await i.providers["network-api"]()).GetNetworkMutation(a,{},{method:"POST",headers:l},{retries:1,wantsHeaders:!0}),p={onResponse:e=>{u.Unsubscribe(p),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{u.Unsubscribe(p),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return u.Subscribe(p),u.Mutate(c),t.promise}IsValidRequest(e){return e.command===a.PUBLIC_LINK&&(0!==e.assetName.length&&0!==e.contentType.length)}}class InvitationNetworkCall{constructor(){}async GetInvitationHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();return{Accept:"application/vnd.adobe.skybox+json;version=2","Content-Type":"application/json","x-api-client-id":t.xApiClientId,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.parcelId,l=e.recipients,d=e.currentAccessControlLevel,c=e.canShareEnabled,u=(await n.Z.getBaseFilesURIs()).send_api+"parcels/"+a+"/invitation",p=await this.GetInvitationHTTPHeaders();let R={recipients:l};"legacy"!==d&&(R.canShare=c);const h=(await i.providers["network-api"]()).GetNetworkMutation(u,{},{method:"POST",headers:p},{wantsHeaders:!0}),_={onResponse:e=>{h.Unsubscribe(_),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{h.Unsubscribe(_),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return h.Subscribe(_),h.Mutate(R),t.promise}IsValidRequest(e){const t=e;return t.command===a.INVITATION&&0!==t.parcelId.length&&(0!==t.recipients.length&&!("view"===t.shareMode&&!0===t.canShareEnabled||"review"===t.shareMode&&("orgEverybody"===t.currentAccessControlLevel||"private"===t.currentAccessControlLevel)&&!0===t.canShareEnabled||"review"===t.shareMode&&"all"===t.currentAccessControlLevel&&!1===t.canShareEnabled))}}class PgcSuggestionsNetworkCall{constructor(){}async GetPgcSuggestionsHTTPHeaders(e){const t=await i.providers["native-api"](),s=await t.SessionAPI(),a=await s.GetAccessToken();s.xApiClientId;return{"Content-Type":"application/json","x-Api-Key":e?"AdobeReader9":"AdobeAcrobat9",authorization:`Bearer ${a}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e,n=await this.GetPgcSuggestionsHTTPHeaders(a.isReaderProduct);let l={};l.query={type:a.type,value:a.searchString},l.relationship=a.relationship,l.resourceType=a.resourceType;const d=(await i.providers["network-api"]()).GetNetworkMutation("https://pgc.adobe.io/api/suggestions",{},{method:"POST",headers:n},{wantsHeaders:!0}),c={onResponse:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return d.Subscribe(c),d.Mutate(l),t.promise}IsValidRequest(e){return e.command===a.PGC_SUGGESTIONS&&e.searchString.length>=0}}class ConsentNetworkCall{constructor(){}async GetConsentHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{Accept:"application/vnd.adobe.skybox+json;version=2","Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.invitationId,l=(await n.Z.getBaseFilesURIs()).send_api+"invitation/"+a+"/consent",d=await this.GetConsentHTTPHeaders(),c=(await i.providers["network-api"]()).GetNetworkMutation(l,{},{method:"DELETE",headers:d},{wantsHeaders:!0}),u={onResponse:e=>{c.Unsubscribe(u),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{c.Unsubscribe(u),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return c.Subscribe(u),c.Mutate({value:!1}),t.promise}IsValidRequest(e){return e.command===a.CONSENT&&0!==e.invitationId.length}}class UnshareNetworkCall{constructor(){}async GetUnshareHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{Accept:"application/vnd.adobe.skybox+json;version=2","Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.invitationId,l=e.deleteAnnots;let d=(await n.Z.getBaseFilesURIs()).send_api+"parcels/"+a+"/is_active";l&&(d+="?deleteAnnots=true");const c=await this.GetUnshareHTTPHeaders(),u=(await i.providers["network-api"]()).GetNetworkMutation(d,{},{method:"PUT",headers:c},{wantsHeaders:!0}),p={onResponse:e=>{u.Unsubscribe(p),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{u.Unsubscribe(p),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return u.Subscribe(p),u.Mutate({value:!1}),t.promise}IsValidRequest(e){return e.command===a.UNSHARE&&0!==e.invitationId.length}}class MergeAnnotsNetworkCall{constructor(){}async GetMergeAnnotsHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{Accept:"application/vnd.adobe.dc+json;version=1","Content-Type":"application/vnd.adobe.dc+json;version=1","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`,"x-api-key":"AdobeAcrobat5"}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.commentingUrn,l=(await n.Z.getBaseFilesURIs()).commenting_uri+"assets/"+a+"?operation=mergeannots",d=await this.GetMergeAnnotsHTTPHeaders(),c=(await i.providers["network-api"]()).GetNetworkMutation(l,{},{method:"POST",headers:d},{wantsHeaders:!0}),u={onResponse:e=>{c.Unsubscribe(u),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{c.Unsubscribe(u),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return c.Subscribe(u),c.MutateStr(""),t.promise}IsValidRequest(e){return e.command===a.MERGE_ANNOTS&&0!==e.commentingUrn.length}}class PgcAcceptNetworkCall{constructor(){}async GetPgcAcceptHTTPHeaders(e){const t=await i.providers["native-api"](),s=await t.SessionAPI(),a=await s.GetAccessToken();s.xApiClientId;return{"Content-Type":"application/json","x-Api-Key":e?"AdobeReader9":"AdobeAcrobat9",authorization:`Bearer ${a}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e,n=await this.GetPgcAcceptHTTPHeaders(a.isReaderProduct);let l={};l.tokens=a.tokens;const d=(await i.providers["network-api"]()).GetNetworkMutation("https://pgc.adobe.io/api/accept",{},{method:"POST",headers:n},{wantsHeaders:!0}),c={onResponse:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return d.Subscribe(c),d.Mutate(l),t.promise}IsValidRequest(e){return e.command===a.PGC_ACCEPT&&e.tokens.length>0}}class LimtsNetworkCall{constructor(){}async GetLimitsHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();return{Accept:"application/vnd.adobe.dex+json;version=1","Content-Type":"application/json","x-api-client-id":t.xApiClientId,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=(await n.Z.getBaseCreatePdfURIs()).users+"users/me?fields=identity,subscriptions,limits/acrobat,limits/common,limits/conversions,limits/esign,limits/fillsign,limits/send,prefs/comments,prefs/common,prefs/conversions,prefs/files,prefs/fillsign,prefs/send",l=await this.GetLimitsHTTPHeaders(),d=(await i.providers["network-api"]()).GetNetworkQuery(a,{},{method:"GET",headers:l},{wantsHeaders:!0}),c={onResponse:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return d.Subscribe(c),d.Refresh(),t.promise}IsValidRequest(e){return e.command===a.LIMITS}}class DeleteCollaboratorNetworkCall{constructor(){this.mAllowedCollaborators=new Set,this.mAllowedCollaborators.add("all"),this.mAllowedCollaborators.add("orgEverybody")}async GetDeletionHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.assetId,l=e.recipients.filter((e=>this.mAllowedCollaborators.has(e)));let d=[];l.forEach((e=>d.push({id:e})));const c=(await n.Z.getBaseFilesURIs()).send_api+"assets/"+a+"/collaborators",u=await this.GetDeletionHTTPHeaders(),p={collaborators:d},R=(await i.providers["network-api"]()).GetNetworkMutation(c,{},{method:"DELETE",headers:u},{wantsHeaders:!0}),h={onResponse:e=>{R.Unsubscribe(h),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{R.Unsubscribe(h),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return R.Subscribe(h),R.Mutate(p),t.promise}IsValidRequest(e){if(e.command===a.DELETE_COLLABORATOR&&0!==e.assetId.length&&0!==e.recipients.length){return 0!==e.recipients.filter((e=>this.mAllowedCollaborators.has(e))).length}return!1}}class PatchCollaboratorNetworkCall{async GetPatchHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),a=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":a,"x-api-client-id":a,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=e.assetId,l=e.addCollaboratorList,d=e.removeCollaboratorList,c=e.updateCollaboratorList,u=(await n.Z.getBaseFilesURIs()).send_api+"v1/assets/"+a+"/collaborators",p=await this.GetPatchHTTPHeaders(),R={};l.length>0&&(R.add=l),d.length>0&&(R.remove=d),c.length>0&&(R.update=c);const h=(await i.providers["network-api"]()).GetNetworkMutation(u,{},{method:"PATCH",headers:p},{retries:0,wantsHeaders:!0}),_={onResponse:e=>{h.Unsubscribe(_),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{h.Unsubscribe(_),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return h.Subscribe(_),h.Mutate(R),t.promise}IsValidRequest(e){let t=e.nextAccessLevel;if(e.command===a.PATCH_COLLABORATOR&&0!==e.assetId.length){let s=!0;return e.addCollaboratorList.forEach((t=>{("private"===t.id||"orgEverybody"===t.id&&!0===t.canShare||"all"===t.id&&!1===t.canShare&&!1===e.isSharedForView)&&(s=!1)})),e.removeCollaboratorList.forEach((e=>{"private"===e.id&&(s=!1)})),e.updateCollaboratorList.forEach((a=>{("all"===t&&!1===a.canShare&&!1===e.isSharedForView||"orgEverybody"===t&&!0===a.canShare)&&(s=!1)})),s}return!1}}class PendingAccessReqNetworkCall{constructor(){}async PendingAccessReqHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();t.xApiClientId;return{"Content-Type":"application/json","X-Api-Key":"AdobeAcrobat9",authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=await n.Z.getInvitationBaseURI(),l=await this.PendingAccessReqHTTPHeaders(),d=a+"/accessrequests/"+e.assetId+"?orderBy=-requesttime",c=(await i.providers["network-api"]()).GetNetworkQuery(d,{},{method:"GET",headers:l},{retries:1,wantsHeaders:!0}),u={onResponse:e=>{c.Unsubscribe(u),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{c.Unsubscribe(u),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return c.Subscribe(u),c.Refresh(),t.promise}IsValidRequest(e){return e.command===a.PENDING_ACCESS_REQ&&0!==e.assetId.length}}class ManageAccessReqNetworkCall{constructor(){}async ManageAccessReqHTTPHeaders(){const e=await i.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();t.xApiClientId;return{"Content-Type":"application/json","X-Api-Key":"AdobeAcrobat9",authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=r.INVALID_PARAMS,t.reject(s),t.promise;const a=await n.Z.getInvitationBaseURI(),l=await this.ManageAccessReqHTTPHeaders(),d=e;let c={resourceUrn:d.assetId,requesterId:d.requesterId,action:d.action,role:d.role,canShare:d.canShare,canComment:d.canComment,notification:d.notification.toJSONFormat()};const u=a+"/accessrequests/ops",p=(await i.providers["network-api"]()).GetNetworkMutation(u,{},{method:"POST",headers:l},{retries:0,wantsHeaders:!0}),R={onResponse:e=>{p.Unsubscribe(R),s.ERR_CODE=r.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{p.Unsubscribe(R),s.ERR_CODE=r.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return p.Subscribe(R),p.Mutate(c),t.promise}IsValidRequest(e){return e.command===a.MANAGE_ACCESS_REQ&&(0!==e.assetId.length&&0!==e.requesterId.length&&0!==e.action.length&&("grant"==e.action||"reject"==e.action)&&0!==e.role.length&&!0!==e.canShare&&void 0!==e.canComment&&void 0!==e.notification)}}class CollaborationProvider{constructor(){this.mCommandToExecutor=new Map,this.initializeCommands()}initializeCommands(){this.mCommandToExecutor.set(a.BOOTSTRAP,new BootstrapNetworkCall),this.mCommandToExecutor.set(a.COLLABORATOR,new CollaboratorNetworkCall),this.mCommandToExecutor.set(a.BEHANCE,new BehanceNetworkCall),this.mCommandToExecutor.set(a.INVITATION,new InvitationNetworkCall),this.mCommandToExecutor.set(a.PUBLIC_LINK,new CreateLinkNetworkCall),this.mCommandToExecutor.set(a.CONSENT,new ConsentNetworkCall),this.mCommandToExecutor.set(a.PGC_SUGGESTIONS,new PgcSuggestionsNetworkCall),this.mCommandToExecutor.set(a.UNSHARE,new UnshareNetworkCall),this.mCommandToExecutor.set(a.MERGE_ANNOTS,new MergeAnnotsNetworkCall),this.mCommandToExecutor.set(a.PGC_ACCEPT,new PgcAcceptNetworkCall),this.mCommandToExecutor.set(a.LIMITS,new LimtsNetworkCall),this.mCommandToExecutor.set(a.DELETE_COLLABORATOR,new DeleteCollaboratorNetworkCall),this.mCommandToExecutor.set(a.PATCH_COLLABORATOR,new PatchCollaboratorNetworkCall),this.mCommandToExecutor.set(a.PENDING_ACCESS_REQ,new PendingAccessReqNetworkCall),this.mCommandToExecutor.set(a.MANAGE_ACCESS_REQ,new ManageAccessReqNetworkCall)}ready(){return Promise.resolve(this)}IsValidCommand(e){return this.mCommandToExecutor.has(e.command)}async ExecuteCollabCommand(e){const t=new o.Z;let s={ERR_CODE:r.NO_ERROR,data:{},error:{}};if(!this.IsValidCommand(e))return s.ERR_CODE=r.INVALID_COMMAND,t.reject(s),t.promise;const a=await i.providers["native-api"](),n=await a.ServicesTestAPI(),l=e.networkCallName(),d="ShareSheet_"+l;""!==l&&await n.logPerformance(d,"start");const c=this.mCommandToExecutor.get(e.command);if(c)try{if(s=await c.MakeNetworkCall(e),void 0!==(null==s?void 0:s.headers)){(await a.UnifiedSharePopupAPI()).LogDCApiMigrationStatus(null==s?void 0:s.headers)}t.resolve(s)}catch(e){if(void 0!==(null==e?void 0:e.headers)){(await a.UnifiedSharePopupAPI()).LogDCApiMigrationStatus(null==e?void 0:e.headers)}t.reject(e)}return""!==l&&await n.logPerformance(d,"end"),t.promise}}CollaborationProvider.getInstance=i.providerUtil.getSingletonFunction(CollaborationProvider)},wmCg:(e,t,s)=>{s.r(t),s.d(t,{default:()=>DCDiscoveryProvider});var a=s("plsW");class DCDiscoveryProvider{constructor(){this.mDiscoveryExpiry=0}ready(){return Promise.resolve(this)}async GetSessionAPI(){const e=await a.providers["native-api"]();return await e.SessionAPI()}HasDiscoveryExpired(){const e=(new Date).getTime()/1e3;return this.mDiscoveryExpiry>0&&e>this.mDiscoveryExpiry}async GetDCDiscoveryReponse(){if(this.mDiscoveryResponse&&!this.HasDiscoveryExpired())return this.mDiscoveryResponse;const e=await a.providers["native-api"](),t=await e.ResponseCacheAPI();return this.mDiscoveryResponse=await t.GetDCDiscoveryResponse(),this.mDiscoveryExpiry=this.mDiscoveryResponse.expiry,this.mDiscoveryResponse}async GetHTTPHeaders(e,t){const s=await this.GetSessionAPI(),a=await s.GetAccessToken(),r=s.xApiClientId;let i={accept:e,authorization:`Bearer ${a}`,"x-api-app-info":r,"x-api-client-id":r};return t&&(i=Object.assign(Object.assign({},i),{"Content-Type":t})),i}async GetUSSHTTPHeaders(){const e=await this.GetSessionAPI();return{accept:"*/*",authorization:`Bearer ${await e.GetAccessToken()}`,"x-api-key":"AdobeAcrobat9","x-product":"acrobat.adobe.com","x-product-location":"uss search input","Content-Type":"application/vnd.adobe.search-request+json"}}async GetNameValidatorHTTPHeaders(){const e=await this.GetSessionAPI();return{accept:"application/vnd.adobe.skybox+json;version=1",authorization:`Bearer ${await e.GetAccessToken()}`,"Content-Type":"application/vnd.adobe.skybox+json;version=1;charset=utf-8"}}ParseDiscoveryUriToFullUri(e,t,s){if(!this.mDiscoveryResponse)return"";const a=/\{\+([^\s}]+)\}/;let r=e.match(a);for(;r&&r.length>0;){const s=r[1];let i=t[s];i||(i=this.mDiscoveryResponse.templates[s]),i&&(i=i.toString(),i.length>0&&(e=e.replace(r[0],i))),r=e.match(a)}const i=/\{([^\s+}]+)\}/;let o=e.match(i);for(;o&&o.length>=2;){let t=o[1][0],a=o[1];t.match(/[\w\d]/)?t="":a=a.substr(1);const r=a.split(",").reduce(((e,t)=>t in s?(e.length>0&&(e+="&"),e+=`${t}=${s[t]}`):e),"");r.length>0&&(e=e.replace(o[0],t+r)),o=e.match(i)}return e}}DCDiscoveryProvider.getInstance=a.providerUtil.getSingletonFunction(DCDiscoveryProvider)}}]);
//# sourceMappingURL=private/dc-discovery.4e99f1247aedee8a7b15.map